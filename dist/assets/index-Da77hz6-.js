import{a as Bc,i as ca,_ as Nc}from"./main-DlAblTGF.js";import{d as br,g as Oc}from"./vendor-BFu1EOKW.js";var ps;(function(r){r[r.SysFatal=1]="SysFatal",r[r.SysTransient=2]="SysTransient",r[r.DestinationInvalid=3]="DestinationInvalid",r[r.CanisterReject=4]="CanisterReject",r[r.CanisterError=5]="CanisterError"})(ps||(ps={}));const Ln="abcdefghijklmnopqrstuvwxyz234567",mr=Object.create(null);for(let r=0;r<Ln.length;r++)mr[Ln[r]]=r;mr[0]=mr.o;mr[1]=mr.i;function Uc(r){let e=0,t=0,n="";function i(o){return e<0?t|=o>>-e:t=o<<e&248,e>3?(e-=8,1):(e<4&&(n+=Ln[t>>3],e+=5),0)}for(let o=0;o<r.length;)o+=i(r[o]);return n+(e<0?Ln[t>>3]:"")}function Rc(r){let e=0,t=0;const n=new Uint8Array(r.length*4/3|0);let i=0;function o(f){let u=mr[f.toLowerCase()];if(u===void 0)throw new Error(`Invalid character: ${JSON.stringify(f)}`);u<<=3,t|=u>>>e,e+=5,e>=8&&(n[i++]=t,e-=8,e>0?t=u<<5-e&255:t=0)}for(const f of r)o(f);return n.slice(0,i)}const Pc=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Lc(r){const e=new Uint8Array(r);let t=-1;for(let n=0;n<e.length;n++){const o=(e[n]^t)&255;t=Pc[o]^t>>>8}return(t^-1)>>>0}function Fc(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function ua(r,...e){if(!Fc(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function ys(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Mc(r,e){ua(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const or=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ii=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),yt=(r,e)=>r<<32-e|r>>>e;function Dc(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function fa(r){return typeof r=="string"&&(r=Dc(r)),ua(r),r}class kc{clone(){return this._cloneInto()}}function zi(r){const e=n=>r().update(fa(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function la(r=32){if(or&&typeof or.getRandomValues=="function")return or.getRandomValues(new Uint8Array(r));if(or&&typeof or.randomBytes=="function")return or.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function Cc(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const i=BigInt(32),o=BigInt(4294967295),f=Number(t>>i&o),u=Number(t&o),d=n?4:0,g=n?0:4;r.setUint32(e+d,f,n),r.setUint32(e+g,u,n)}const $c=(r,e,t)=>r&e^~r&t,qc=(r,e,t)=>r&e^r&t^e&t;class da extends kc{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ii(this.buffer)}update(e){ys(this);const{view:t,buffer:n,blockLen:i}=this;e=fa(e);const o=e.length;for(let f=0;f<o;){const u=Math.min(i-this.pos,o-f);if(u===i){const d=ii(e);for(;i<=o-f;f+=i)this.process(d,f);continue}n.set(e.subarray(f,f+u),this.pos),this.pos+=u,f+=u,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ys(this),Mc(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:o}=this;let{pos:f}=this;t[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>i-f&&(this.process(n,0),f=0);for(let v=f;v<i;v++)t[v]=0;Cc(n,i-8,BigInt(this.length*8),o),this.process(n,0);const u=ii(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=d/4,m=this.get();if(g>m.length)throw new Error("_sha2: outputLen bigger than state");for(let v=0;v<g;v++)u.setUint32(4*v,m[v],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:o,destroyed:f,pos:u}=this;return e.length=i,e.pos=u,e.finished=o,e.destroyed=f,i%t&&e.buffer.set(n),e}}const Gc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ot=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ut=new Uint32Array(64);class ha extends da{constructor(){super(64,32,8,!1),this.A=Ot[0]|0,this.B=Ot[1]|0,this.C=Ot[2]|0,this.D=Ot[3]|0,this.E=Ot[4]|0,this.F=Ot[5]|0,this.G=Ot[6]|0,this.H=Ot[7]|0}get(){const{A:e,B:t,C:n,D:i,E:o,F:f,G:u,H:d}=this;return[e,t,n,i,o,f,u,d]}set(e,t,n,i,o,f,u,d){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=f|0,this.G=u|0,this.H=d|0}process(e,t){for(let v=0;v<16;v++,t+=4)Ut[v]=e.getUint32(t,!1);for(let v=16;v<64;v++){const B=Ut[v-15],S=Ut[v-2],h=yt(B,7)^yt(B,18)^B>>>3,L=yt(S,17)^yt(S,19)^S>>>10;Ut[v]=L+Ut[v-7]+h+Ut[v-16]|0}let{A:n,B:i,C:o,D:f,E:u,F:d,G:g,H:m}=this;for(let v=0;v<64;v++){const B=yt(u,6)^yt(u,11)^yt(u,25),S=m+B+$c(u,d,g)+Gc[v]+Ut[v]|0,L=(yt(n,2)^yt(n,13)^yt(n,22))+qc(n,i,o)|0;m=g,g=d,d=u,u=f+S|0,f=o,o=i,i=n,n=S+L|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,f=f+this.D|0,u=u+this.E|0,d=d+this.F|0,g=g+this.G|0,m=m+this.H|0,this.set(n,i,o,f,u,d,g,m)}roundClean(){Ut.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Hc extends ha{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Yi=zi(()=>new ha),Vc=zi(()=>new Hc);function Kc(r){return Vc.create().update(new Uint8Array(r)).digest()}const Yr="__principal__",jc=2,ws=4,zc="aaaaa-aa",Yc=r=>{var e;return new Uint8Array(((e=r.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(t=>parseInt(t,16)))},Wc=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"");let ve=class un{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([ws]))}static managementCanister(){return this.fromHex(zc)}static selfAuthenticating(e){const t=Kc(e);return new this(new Uint8Array([...t,jc]))}static from(e){if(typeof e=="string")return un.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new un(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new un(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this(Yc(e))}static fromText(e){let t=e;if(e.includes(Yr)){const f=JSON.parse(e);Yr in f&&(t=f[Yr])}const n=t.toLowerCase().replace(/-/g,"");let i=Rc(n);i=i.slice(4,i.length);const o=new this(i);if(o.toText()!==t)throw new Error(`Principal "${o.toText()}" does not have a valid checksum (original value "${t}" may not be a valid Principal ID).`);return o}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===ws}toUint8Array(){return this._arr}toHex(){return Wc(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,Lc(this._arr));const n=new Uint8Array(e),i=Uint8Array.from(this._arr),o=new Uint8Array([...n,...i]),u=Uc(o).match(/.{1,5}/g);if(!u)throw new Error;return u.join("-")}toString(){return this.toText()}toJSON(){return{[Yr]:this.toText()}}compareTo(e){for(let t=0;t<Math.min(this._arr.length,e._arr.length);t++){if(this._arr[t]<e._arr[t])return"lt";if(this._arr[t]>e._arr[t])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const t=this.compareTo(e);return t=="lt"||t=="eq"}gtEq(e){const t=this.compareTo(e);return t=="gt"||t=="eq"}};class dt extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,dt.prototype)}}function xe(...r){const e=new Uint8Array(r.reduce((n,i)=>n+i.byteLength,0));let t=0;for(const n of r)e.set(new Uint8Array(n),t),t+=n.byteLength;return e}class Er{constructor(e,t=e?.byteLength||0){this._buffer=Ai(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,t)}get buffer(){return Ai(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const t=this._view.subarray(0,e);return this._view=this._view.subarray(e),t.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const t=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+t.byteLength>=this._buffer.byteLength?this.alloc(t.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+t.byteLength),this._view.set(t,n)}get end(){return this._view.byteLength===0}alloc(e){const t=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(t,0,this._view.byteLength+e);n.set(this._view),this._buffer=t,this._view=n}}function si(r){return new DataView(r.buffer,r.byteOffset,r.byteLength).buffer}function Ai(r){return r instanceof Uint8Array?si(r):r instanceof ArrayBuffer?r:Array.isArray(r)?si(new Uint8Array(r)):"buffer"in r?Ai(r.buffer):si(new Uint8Array(r))}function Zc(r){const t=new TextEncoder().encode(r);let n=0;for(const i of t)n=(n*223+i)%2**32;return n}function xt(r){if(/^_\d+_$/.test(r)||/^_0x[0-9a-fA-F]+_$/.test(r)){const e=+r.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return Zc(r)}function pa(){throw new Error("unexpected end of buffer")}function rr(r,e){return r.byteLength<e&&pa(),r.read(e)}function nr(r){const e=r.readUint8();return e===void 0&&pa(),e}function Ue(r){if(typeof r=="number"&&(r=BigInt(r)),r<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(r===BigInt(0)?0:Math.ceil(Math.log2(Number(r))))+1,t=new Er(new ArrayBuffer(e),0);for(;;){const n=Number(r&BigInt(127));if(r/=BigInt(128),r===BigInt(0)){t.write(new Uint8Array([n]));break}else t.write(new Uint8Array([n|128]))}return t.buffer}function $e(r){let e=BigInt(1),t=BigInt(0),n;do n=nr(r),t+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return t}function De(r){typeof r=="number"&&(r=BigInt(r));const e=r<BigInt(0);e&&(r=-r-BigInt(1));const t=(r===BigInt(0)?0:Math.ceil(Math.log2(Number(r))))+1,n=new Er(new ArrayBuffer(t),0);for(;;){const o=i(r);if(r/=BigInt(128),e&&r===BigInt(0)&&o&64||!e&&r===BigInt(0)&&!(o&64)){n.write(new Uint8Array([o]));break}else n.write(new Uint8Array([o|128]))}function i(o){const f=o%BigInt(128);return Number(e?BigInt(128)-f-BigInt(1):f)}return n.buffer}function Ft(r){const e=new Uint8Array(r.buffer);let t=0;for(;t<e.byteLength;t++)if(e[t]<128){if(!(e[t]&64))return $e(r);break}const n=new Uint8Array(rr(r,t+1));let i=BigInt(0);for(let o=n.byteLength-1;o>=0;o--)i=i*BigInt(128)+BigInt(128-(n[o]&127)-1);return-i-BigInt(1)}function Xc(r,e){if(BigInt(r)<BigInt(0))throw new Error("Cannot write negative values.");return ya(r,e)}function ya(r,e){r=BigInt(r);const t=new Er(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),o=BigInt(0),f=Number(r%i);for(t.write(new Uint8Array([f]));++n<e;)r<0&&o===BigInt(0)&&f!==0&&(o=BigInt(1)),f=Number((r/i-o)%BigInt(256)),t.write(new Uint8Array([f])),i*=BigInt(256);return t.buffer}function wa(r,e){let t=BigInt(nr(r)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const o=BigInt(nr(r));t=t+n*o}return t}function Jc(r,e){let t=wa(r,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return t>=n&&(t-=n*BigInt(2)),t}function Ti(r){const e=BigInt(r);if(r<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const fn="DIDL",gs=400;function Dr(r,e,t){return r.map((n,i)=>t(n,e[i]))}class Qc{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,t){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(t)}merge(e,t){const n=this._idx.get(e.name),i=this._idx.get(t);if(n===void 0)throw new Error("Missing type index for "+e);if(i===void 0)throw new Error("Missing type index for "+t);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(t)}encode(){const e=Ue(this._typs.length),t=xe(...this._typs);return xe(e,t)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return De(this._idx.get(e)||0)}}class eu{visitType(e,t){throw new Error("Not implemented")}visitPrimitive(e,t){return this.visitType(e,t)}visitEmpty(e,t){return this.visitPrimitive(e,t)}visitBool(e,t){return this.visitPrimitive(e,t)}visitNull(e,t){return this.visitPrimitive(e,t)}visitReserved(e,t){return this.visitPrimitive(e,t)}visitText(e,t){return this.visitPrimitive(e,t)}visitNumber(e,t){return this.visitPrimitive(e,t)}visitInt(e,t){return this.visitNumber(e,t)}visitNat(e,t){return this.visitNumber(e,t)}visitFloat(e,t){return this.visitPrimitive(e,t)}visitFixedInt(e,t){return this.visitNumber(e,t)}visitFixedNat(e,t){return this.visitNumber(e,t)}visitPrincipal(e,t){return this.visitPrimitive(e,t)}visitConstruct(e,t){return this.visitType(e,t)}visitVec(e,t,n){return this.visitConstruct(e,n)}visitOpt(e,t,n){return this.visitConstruct(e,n)}visitRecord(e,t,n){return this.visitConstruct(e,n)}visitTuple(e,t,n){const i=t.map((o,f)=>[`_${f}_`,o]);return this.visitRecord(e,i,n)}visitVariant(e,t,n){return this.visitConstruct(e,n)}visitRec(e,t,n){return this.visitConstruct(t,n)}visitFunc(e,t){return this.visitConstruct(e,t)}visitService(e,t){return this.visitConstruct(e,t)}}class zn{display(){return this.name}valueToString(e){return Pe(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class it extends zn{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class Yt extends zn{checkType(e){if(e instanceof Wt){const t=e.getType();if(typeof t>"u")throw new Error("type mismatch with uninitialized type");return t}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class ga extends it{accept(e,t){return e.visitEmpty(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return De(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class ba extends zn{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,t){throw e.visitType(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,t){let n=t.decodeValue(e,t);Object(n)!==n&&(n=Object(n));let i;return t instanceof Wt?i=()=>t.getType():i=()=>t,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class ma extends it{accept(e,t){return e.visitBool(this,t)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return De(-2)}decodeValue(e,t){switch(this.checkType(t),nr(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class _a extends it{accept(e,t){return e.visitNull(this,t)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return De(-1)}decodeValue(e,t){return this.checkType(t),null}get name(){return"null"}}class Fn extends it{accept(e,t){return e.visitReserved(this,t)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return De(-16)}decodeValue(e,t){return t.name!==this.name&&t.decodeValue(e,t),null}get name(){return"reserved"}}class xa extends it{accept(e,t){return e.visitText(this,t)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){const t=new TextEncoder().encode(e),n=Ue(t.byteLength);return xe(n,t)}encodeType(){return De(-15)}decodeValue(e,t){this.checkType(t);const n=$e(e),i=rr(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class Ea extends it{accept(e,t){return e.visitInt(this,t)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){return De(e)}encodeType(){return De(-4)}decodeValue(e,t){return this.checkType(t),Ft(e)}get name(){return"int"}valueToString(e){return e.toString()}}class va extends it{accept(e,t){return e.visitNat(this,t)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){return Ue(e)}encodeType(){return De(-3)}decodeValue(e,t){return this.checkType(t),$e(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class Wi extends it{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,t){return e.visitFloat(this,t)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){const t=new ArrayBuffer(this._bits/8),n=new DataView(t);return this._bits===32?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),t}encodeType(){const e=this._bits===32?-13:-14;return De(e)}decodeValue(e,t){this.checkType(t);const n=rr(e,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class ir extends it{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedInt(this,t)}covariant(e){const t=Ti(this._bits-1)*BigInt(-1),n=Ti(this._bits-1)-BigInt(1);let i=!1;if(typeof e=="bigint")i=e>=t&&e<=n;else if(Number.isInteger(e)){const o=BigInt(e);i=o>=t&&o<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){return ya(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return De(-9-e)}decodeValue(e,t){this.checkType(t);const n=Jc(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class Kt extends it{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedNat(this,t)}covariant(e){const t=Ti(this._bits);let n=!1;if(typeof e=="bigint"&&e>=BigInt(0)?n=e<t:Number.isInteger(e)&&e>=0?n=BigInt(e)<t:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){return Xc(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return De(-5-e)}decodeValue(e,t){this.checkType(t);const n=wa(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class Yn extends Yt{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof Kt&&e._bits===8&&(this._blobOptimization=!0)}accept(e,t){return e.visitVec(this,this._type,t)}covariant(e){const t=this._type instanceof Kt?this._type._bits:this._type instanceof ir?this._type._bits:0;if(ArrayBuffer.isView(e)&&t==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((n,i)=>{try{return this._type.covariant(n)}catch(o){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${o.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){const t=Ue(e.length);if(this._blobOptimization)return xe(t,new Uint8Array(e));if(ArrayBuffer.isView(e))return xe(t,new Uint8Array(e.buffer));const n=new Er(new ArrayBuffer(t.byteLength+e.length),0);n.write(t);for(const i of e){const o=this._type.encodeValue(i);n.write(new Uint8Array(o))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=De(-19),n=this._type.encodeType(e);e.add(this,xe(t,n))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof Yn))throw new Error("Not a vector type");const i=Number($e(e));if(this._type instanceof Kt){if(this._type._bits==8)return new Uint8Array(e.read(i));if(this._type._bits==16)return new Uint16Array(e.read(i*2));if(this._type._bits==32)return new Uint32Array(e.read(i*4));if(this._type._bits==64)return new BigUint64Array(e.read(i*8))}if(this._type instanceof ir){if(this._type._bits==8)return new Int8Array(e.read(i));if(this._type._bits==16)return new Int16Array(e.read(i*2));if(this._type._bits==32)return new Int32Array(e.read(i*4));if(this._type._bits==64)return new BigInt64Array(e.read(i*8))}const o=[];for(let f=0;f<i;f++)o.push(this._type.decodeValue(e,n._type));return o}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class _r extends Yt{constructor(e){super(),this._type=e}accept(e,t){return e.visitOpt(this,this._type,t)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(t){throw new Error(`Invalid ${this.display()} argument: ${Pe(e)} 

-> ${t.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):xe(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=De(-18),n=this._type.encodeType(e);e.add(this,xe(t,n))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof _r))throw new Error("Not an option type");switch(nr(e)){case 0:return[];case 1:return[this._type.decodeValue(e,n._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class Gr extends Yt{constructor(e={}){super(),this._fields=Object.entries(e).sort((t,n)=>xt(t[0])-xt(n[0]))}accept(e,t){return e.visitRecord(this,this._fields,t)}tryAsTuple(){const e=[];for(let t=0;t<this._fields.length;t++){const[n,i]=this._fields[t];if(n!==`_${t}_`)return null;e.push(i)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([t,n])=>{if(!e.hasOwnProperty(t))throw new Error(`Record is missing key "${t}".`);try{return n.covariant(e[t])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${t} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){const t=this._fields.map(([i])=>e[i]),n=Dr(this._fields,t,([,i],o)=>i.encodeValue(o));return xe(...n)}_buildTypeTableImpl(e){this._fields.forEach(([o,f])=>f.buildTypeTable(e));const t=De(-20),n=Ue(this._fields.length),i=this._fields.map(([o,f])=>xe(Ue(xt(o)),f.encodeType(e)));e.add(this,xe(t,n,xe(...i)))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof Gr))throw new Error("Not a record type");const i={};let o=0,f=0;for(;f<n._fields.length;){const[u,d]=n._fields[f];if(o>=this._fields.length){d.decodeValue(e,d),f++;continue}const[g,m]=this._fields[o],v=xt(this._fields[o][0]),B=xt(u);if(v===B)i[g]=m.decodeValue(e,d),o++,f++;else if(B>v)if(m instanceof _r||m instanceof Fn)i[g]=[],o++;else throw new Error("Cannot find required field "+g);else d.decodeValue(e,d),f++}for(const[u,d]of this._fields.slice(o))if(d instanceof _r||d instanceof Fn)i[u]=[];else throw new Error("Cannot find required field "+u);return i}get name(){return`record {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([t,n])=>t+":"+n.display()).join("; ")}}`}valueToString(e){const t=this._fields.map(([i])=>e[i]);return`record {${Dr(this._fields,t,([i,o],f)=>i+"="+o.valueToString(f)).join("; ")}}`}}class Wn extends Gr{constructor(e){const t={};e.forEach((n,i)=>t["_"+i+"_"]=n),super(t),this._components=e}accept(e,t){return e.visitTuple(this,this._components,t)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((t,n)=>{try{return t.covariant(e[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){const t=Dr(this._components,e,(n,i)=>n.encodeValue(i));return xe(...t)}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof Wn))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[o,f]of n._components.entries())o>=this._components.length?f.decodeValue(e,f):i.push(this._components[o].decodeValue(e,f));return i}display(){return`record {${this._components.map(t=>t.display()).join("; ")}}`}valueToString(e){return`record {${Dr(this._components,e,(n,i)=>n.valueToString(i)).join("; ")}}`}}class Zn extends Yt{constructor(e={}){super(),this._fields=Object.entries(e).sort((t,n)=>xt(t[0])-xt(n[0]))}accept(e,t){return e.visitVariant(this,this._fields,t)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([t,n])=>{try{return!e.hasOwnProperty(t)||n.covariant(e[t])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${t} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){for(let t=0;t<this._fields.length;t++){const[n,i]=this._fields[t];if(e.hasOwnProperty(n)){const o=Ue(t),f=i.encodeValue(e[n]);return xe(o,f)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,o])=>{o.buildTypeTable(e)});const t=De(-21),n=Ue(this._fields.length),i=this._fields.map(([o,f])=>xe(Ue(xt(o)),f.encodeType(e)));e.add(this,xe(t,n,...i))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof Zn))throw new Error("Not a variant type");const i=Number($e(e));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[o,f]=n._fields[i];for(const[u,d]of this._fields)if(xt(o)===xt(u)){const g=d.decodeValue(e,f);return{[u]:g}}throw new Error("Cannot find field hash "+o)}get name(){return`variant {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([t,n])=>t+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(e){for(const[t,n]of this._fields)if(e.hasOwnProperty(t)){const i=n.valueToString(e[t]);return i==="null"?`variant {${t}}`:`variant {${t}=${i}}`}throw new Error("Variant has no data: "+e)}}class Wt extends Yt{constructor(){super(...arguments),this._id=Wt._counter++,this._type=void 0}accept(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,t)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,t)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}Wt._counter=0;function Zi(r){if(nr(r)!==1)throw new Error("Cannot decode principal");const t=Number($e(r));return ve.fromUint8Array(new Uint8Array(rr(r,t)))}class Ia extends it{accept(e,t){return e.visitPrincipal(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=Ue(t.byteLength);return xe(new Uint8Array([1]),n,t)}encodeType(){return De(-24)}decodeValue(e,t){return this.checkType(t),Zi(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class Xi extends Yt{constructor(e,t,n=[]){super(),this.argTypes=e,this.retTypes=t,this.annotations=n}static argsToString(e,t){if(e.length!==t.length)throw new Error("arity mismatch");return"("+e.map((n,i)=>n.valueToString(t[i])).join(", ")+")"}accept(e,t){return e.visitFunc(this,t)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue([e,t]){const n=e.toUint8Array(),i=Ue(n.byteLength),o=xe(new Uint8Array([1]),i,n),f=new TextEncoder().encode(t),u=Ue(f.byteLength);return xe(new Uint8Array([1]),o,u,f)}_buildTypeTableImpl(e){this.argTypes.forEach(g=>g.buildTypeTable(e)),this.retTypes.forEach(g=>g.buildTypeTable(e));const t=De(-22),n=Ue(this.argTypes.length),i=xe(...this.argTypes.map(g=>g.encodeType(e))),o=Ue(this.retTypes.length),f=xe(...this.retTypes.map(g=>g.encodeType(e))),u=Ue(this.annotations.length),d=xe(...this.annotations.map(g=>this.encodeAnnotation(g)));e.add(this,xe(t,n,i,o,f,u,d))}decodeValue(e){if(nr(e)!==1)throw new Error("Cannot decode function reference");const n=Zi(e),i=Number($e(e)),o=rr(e,i),u=new TextDecoder("utf8",{fatal:!0}).decode(o);return[n,u]}get name(){const e=this.argTypes.map(i=>i.name).join(", "),t=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${e}) -> (${t})${n}`}valueToString([e,t]){return`func "${e.toText()}".${t}`}display(){const e=this.argTypes.map(i=>i.display()).join(", "),t=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${e}) → (${t})${n}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class Sa extends Yt{constructor(e){super(),this._fields=Object.entries(e).sort((t,n)=>t[0]<n[0]?-1:t[0]>n[0]?1:0)}accept(e,t){return e.visitService(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pe(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=Ue(t.length);return xe(new Uint8Array([1]),n,t)}_buildTypeTableImpl(e){this._fields.forEach(([o,f])=>f.buildTypeTable(e));const t=De(-23),n=Ue(this._fields.length),i=this._fields.map(([o,f])=>{const u=new TextEncoder().encode(o),d=Ue(u.length);return xe(d,u,f.encodeType(e))});e.add(this,xe(t,n,...i))}decodeValue(e){return Zi(e)}get name(){return`service {${this._fields.map(([t,n])=>t+":"+n.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function Pe(r){const e=JSON.stringify(r,(t,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return e&&e.length>gs?e.substring(0,gs-3)+"...":e}function tu(r,e){if(e.length<r.length)throw Error("Wrong number of message arguments");const t=new Qc;r.forEach(d=>d.buildTypeTable(t));const n=new TextEncoder().encode(fn),i=t.encode(),o=Ue(e.length),f=xe(...r.map(d=>d.encodeType(t))),u=xe(...Dr(r,e,(d,g)=>{try{d.covariant(g)}catch(m){throw new Error(m.message+`

`)}return d.encodeValue(g)}));return xe(n,i,o,f,u)}function ru(r,e){const t=new Er(e);if(e.byteLength<fn.length)throw new Error("Message length smaller than magic number");const n=rr(t,fn.length),i=new TextDecoder().decode(n);if(i!==fn)throw new Error("Wrong magic number: "+JSON.stringify(i));function o(S){const h=[],L=Number($e(S));for(let $=0;$<L;$++){const k=Number(Ft(S));switch(k){case-18:case-19:{const J=Number(Ft(S));h.push([k,J]);break}case-20:case-21:{const J=[];let P=Number($e(S)),H;for(;P--;){const q=Number($e(S));if(q>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof H=="number"&&H>=q)throw new Error("field id collision or not sorted");H=q;const j=Number(Ft(S));J.push([q,j])}h.push([k,J]);break}case-22:{const J=[];let P=Number($e(S));for(;P--;)J.push(Number(Ft(S)));const H=[];let q=Number($e(S));for(;q--;)H.push(Number(Ft(S)));const j=[];let W=Number($e(S));for(;W--;)switch(Number($e(S))){case 1:{j.push("query");break}case 2:{j.push("oneway");break}case 3:{j.push("composite_query");break}default:throw new Error("unknown annotation")}h.push([k,[J,H,j]]);break}case-23:{let J=Number($e(S));const P=[];for(;J--;){const H=Number($e(S)),q=new TextDecoder().decode(rr(S,H)),j=Ft(S);P.push([q,j])}h.push([k,P]);break}default:throw new Error("Illegal op_code: "+k)}}const U=[],C=Number($e(S));for(let $=0;$<C;$++)U.push(Number(Ft(S)));return[h,U]}const[f,u]=o(t);if(u.length<r.length)throw new Error("Wrong number of return values");const d=f.map(S=>Wa());function g(S){if(S<-24)throw new Error("future value not supported");if(S<0)switch(S){case-1:return Na;case-2:return Ba;case-3:return Ra;case-4:return Ua;case-5:return Ca;case-6:return $a;case-7:return qa;case-8:return Ga;case-9:return Fa;case-10:return Ma;case-11:return Da;case-12:return ka;case-13:return Pa;case-14:return La;case-15:return Oa;case-16:return Ta;case-17:return Aa;case-24:return Ha;default:throw new Error("Illegal op_code: "+S)}if(S>=f.length)throw new Error("type index out of range");return d[S]}function m(S){switch(S[0]){case-19:{const h=g(S[1]);return Ka(h)}case-18:{const h=g(S[1]);return ja(h)}case-20:{const h={};for(const[C,$]of S[1]){const k=`_${C}_`;h[k]=g($)}const L=za(h),U=L.tryAsTuple();return Array.isArray(U)?Va(...U):L}case-21:{const h={};for(const[L,U]of S[1]){const C=`_${L}_`;h[C]=g(U)}return Ya(h)}case-22:{const[h,L,U]=S[1];return Za(h.map(C=>g(C)),L.map(C=>g(C)),U)}case-23:{const h={},L=S[1];for(const[U,C]of L){let $=g(C);if($ instanceof Wt&&($=$.getType()),!($ instanceof Xi))throw new Error("Illegal service definition: services can only contain functions");h[U]=$}return Xa(h)}default:throw new Error("Illegal op_code: "+S[0])}}f.forEach((S,h)=>{if(S[0]===-22){const L=m(S);d[h].fill(L)}}),f.forEach((S,h)=>{if(S[0]!==-22){const L=m(S);d[h].fill(L)}});const v=u.map(S=>g(S)),B=r.map((S,h)=>S.decodeValue(t,v[h]));for(let S=r.length;S<v.length;S++)v[S].decodeValue(t,v[S]);if(t.byteLength>0)throw new Error("decode: Left-over bytes");return B}const Aa=new ga,Ta=new Fn,nu=new ba,Ba=new ma,Na=new _a,Oa=new xa,Ua=new Ea,Ra=new va,Pa=new Wi(32),La=new Wi(64),Fa=new ir(8),Ma=new ir(16),Da=new ir(32),ka=new ir(64),Ca=new Kt(8),$a=new Kt(16),qa=new Kt(32),Ga=new Kt(64),Ha=new Ia;function Va(...r){return new Wn(r)}function Ka(r){return new Yn(r)}function ja(r){return new _r(r)}function za(r){return new Gr(r)}function Ya(r){return new Zn(r)}function Wa(){return new Wt}function Za(r,e,t=[]){return new Xi(r,e,t)}function Xa(r){return new Sa(r)}const Ll=Object.freeze(Object.defineProperty({__proto__:null,Bool:Ba,BoolClass:ma,ConstructType:Yt,Empty:Aa,EmptyClass:ga,FixedIntClass:ir,FixedNatClass:Kt,Float32:Pa,Float64:La,FloatClass:Wi,Func:Za,FuncClass:Xi,Int:Ua,Int16:Ma,Int32:Da,Int64:ka,Int8:Fa,IntClass:Ea,Nat:Ra,Nat16:$a,Nat32:qa,Nat64:Ga,Nat8:Ca,NatClass:va,Null:Na,NullClass:_a,Opt:ja,OptClass:_r,PrimitiveType:it,Principal:Ha,PrincipalClass:Ia,Rec:Wa,RecClass:Wt,Record:za,RecordClass:Gr,Reserved:Ta,ReservedClass:Fn,Service:Xa,ServiceClass:Sa,Text:Oa,TextClass:xa,Tuple:Va,TupleClass:Wn,Type:zn,Unknown:nu,UnknownClass:ba,Variant:Ya,VariantClass:Zn,Vec:Ka,VecClass:Yn,Visitor:eu,decode:ru,encode:tu},Symbol.toStringTag,{value:"Module"}));var Ja={},Hr={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){var e=Bc,t=ca,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=u,r.SlowBuffer=$,r.INSPECT_MAX_BYTES=50;var i=2147483647;r.kMaxLength=i,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var c=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(c,s),c.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function f(c){if(c>i)throw new RangeError('The value "'+c+'" is invalid for option "size"');var s=new Uint8Array(c);return Object.setPrototypeOf(s,u.prototype),s}function u(c,s,a){if(typeof c=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(c)}return d(c,s,a)}u.poolSize=8192;function d(c,s,a){if(typeof c=="string")return B(c,s);if(ArrayBuffer.isView(c))return h(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(N(c,ArrayBuffer)||c&&N(c.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(N(c,SharedArrayBuffer)||c&&N(c.buffer,SharedArrayBuffer)))return L(c,s,a);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var l=c.valueOf&&c.valueOf();if(l!=null&&l!==c)return u.from(l,s,a);var w=U(c);if(w)return w;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return u.from(c[Symbol.toPrimitive]("string"),s,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}u.from=function(c,s,a){return d(c,s,a)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function g(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function m(c,s,a){return g(c),c<=0?f(c):s!==void 0?typeof a=="string"?f(c).fill(s,a):f(c).fill(s):f(c)}u.alloc=function(c,s,a){return m(c,s,a)};function v(c){return g(c),f(c<0?0:C(c)|0)}u.allocUnsafe=function(c){return v(c)},u.allocUnsafeSlow=function(c){return v(c)};function B(c,s){if((typeof s!="string"||s==="")&&(s="utf8"),!u.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var a=k(c,s)|0,l=f(a),w=l.write(c,s);return w!==a&&(l=l.slice(0,w)),l}function S(c){for(var s=c.length<0?0:C(c.length)|0,a=f(s),l=0;l<s;l+=1)a[l]=c[l]&255;return a}function h(c){if(N(c,Uint8Array)){var s=new Uint8Array(c);return L(s.buffer,s.byteOffset,s.byteLength)}return S(c)}function L(c,s,a){if(s<0||c.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<s+(a||0))throw new RangeError('"length" is outside of buffer bounds');var l;return s===void 0&&a===void 0?l=new Uint8Array(c):a===void 0?l=new Uint8Array(c,s):l=new Uint8Array(c,s,a),Object.setPrototypeOf(l,u.prototype),l}function U(c){if(u.isBuffer(c)){var s=C(c.length)|0,a=f(s);return a.length===0||c.copy(a,0,0,s),a}if(c.length!==void 0)return typeof c.length!="number"||A(c.length)?f(0):S(c);if(c.type==="Buffer"&&Array.isArray(c.data))return S(c.data)}function C(c){if(c>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return c|0}function $(c){return+c!=c&&(c=0),u.alloc(+c)}u.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==u.prototype},u.compare=function(s,a){if(N(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),N(a,Uint8Array)&&(a=u.from(a,a.offset,a.byteLength)),!u.isBuffer(s)||!u.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===a)return 0;for(var l=s.length,w=a.length,x=0,F=Math.min(l,w);x<F;++x)if(s[x]!==a[x]){l=s[x],w=a[x];break}return l<w?-1:w<l?1:0},u.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(s,a){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return u.alloc(0);var l;if(a===void 0)for(a=0,l=0;l<s.length;++l)a+=s[l].length;var w=u.allocUnsafe(a),x=0;for(l=0;l<s.length;++l){var F=s[l];if(N(F,Uint8Array))x+F.length>w.length?u.from(F).copy(w,x):Uint8Array.prototype.set.call(w,F,x);else if(u.isBuffer(F))F.copy(w,x);else throw new TypeError('"list" argument must be an Array of Buffers');x+=F.length}return w};function k(c,s){if(u.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||N(c,ArrayBuffer))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);var a=c.length,l=arguments.length>2&&arguments[2]===!0;if(!l&&a===0)return 0;for(var w=!1;;)switch(s){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return z(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a*2;case"hex":return a>>>1;case"base64":return b(c).length;default:if(w)return l?-1:z(c).length;s=(""+s).toLowerCase(),w=!0}}u.byteLength=k;function J(c,s,a){var l=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((a===void 0||a>this.length)&&(a=this.length),a<=0)||(a>>>=0,s>>>=0,a<=s))return"";for(c||(c="utf8");;)switch(c){case"hex":return Z(this,s,a);case"utf8":case"utf-8":return T(this,s,a);case"ascii":return R(this,s,a);case"latin1":case"binary":return G(this,s,a);case"base64":return E(this,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,s,a);default:if(l)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),l=!0}}u.prototype._isBuffer=!0;function P(c,s,a){var l=c[s];c[s]=c[a],c[a]=l}u.prototype.swap16=function(){var s=this.length;if(s%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<s;a+=2)P(this,a,a+1);return this},u.prototype.swap32=function(){var s=this.length;if(s%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<s;a+=4)P(this,a,a+3),P(this,a+1,a+2);return this},u.prototype.swap64=function(){var s=this.length;if(s%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<s;a+=8)P(this,a,a+7),P(this,a+1,a+6),P(this,a+2,a+5),P(this,a+3,a+4);return this},u.prototype.toString=function(){var s=this.length;return s===0?"":arguments.length===0?T(this,0,s):J.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(s){if(!u.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s?!0:u.compare(this,s)===0},u.prototype.inspect=function(){var s="",a=r.INSPECT_MAX_BYTES;return s=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(s+=" ... "),"<Buffer "+s+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(s,a,l,w,x){if(N(s,Uint8Array)&&(s=u.from(s,s.offset,s.byteLength)),!u.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(a===void 0&&(a=0),l===void 0&&(l=s?s.length:0),w===void 0&&(w=0),x===void 0&&(x=this.length),a<0||l>s.length||w<0||x>this.length)throw new RangeError("out of range index");if(w>=x&&a>=l)return 0;if(w>=x)return-1;if(a>=l)return 1;if(a>>>=0,l>>>=0,w>>>=0,x>>>=0,this===s)return 0;for(var F=x-w,Y=l-a,se=Math.min(F,Y),le=this.slice(w,x),de=s.slice(a,l),Q=0;Q<se;++Q)if(le[Q]!==de[Q]){F=le[Q],Y=de[Q];break}return F<Y?-1:Y<F?1:0};function H(c,s,a,l,w){if(c.length===0)return-1;if(typeof a=="string"?(l=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,A(a)&&(a=w?0:c.length-1),a<0&&(a=c.length+a),a>=c.length){if(w)return-1;a=c.length-1}else if(a<0)if(w)a=0;else return-1;if(typeof s=="string"&&(s=u.from(s,l)),u.isBuffer(s))return s.length===0?-1:q(c,s,a,l,w);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?w?Uint8Array.prototype.indexOf.call(c,s,a):Uint8Array.prototype.lastIndexOf.call(c,s,a):q(c,[s],a,l,w);throw new TypeError("val must be string, number or Buffer")}function q(c,s,a,l,w){var x=1,F=c.length,Y=s.length;if(l!==void 0&&(l=String(l).toLowerCase(),l==="ucs2"||l==="ucs-2"||l==="utf16le"||l==="utf-16le")){if(c.length<2||s.length<2)return-1;x=2,F/=2,Y/=2,a/=2}function se(Ne,st){return x===1?Ne[st]:Ne.readUInt16BE(st*x)}var le;if(w){var de=-1;for(le=a;le<F;le++)if(se(c,le)===se(s,de===-1?0:le-de)){if(de===-1&&(de=le),le-de+1===Y)return de*x}else de!==-1&&(le-=le-de),de=-1}else for(a+Y>F&&(a=F-Y),le=a;le>=0;le--){for(var Q=!0,ye=0;ye<Y;ye++)if(se(c,le+ye)!==se(s,ye)){Q=!1;break}if(Q)return le}return-1}u.prototype.includes=function(s,a,l){return this.indexOf(s,a,l)!==-1},u.prototype.indexOf=function(s,a,l){return H(this,s,a,l,!0)},u.prototype.lastIndexOf=function(s,a,l){return H(this,s,a,l,!1)};function j(c,s,a,l){a=Number(a)||0;var w=c.length-a;l?(l=Number(l),l>w&&(l=w)):l=w;var x=s.length;l>x/2&&(l=x/2);for(var F=0;F<l;++F){var Y=parseInt(s.substr(F*2,2),16);if(A(Y))return F;c[a+F]=Y}return F}function W(c,s,a,l){return _(z(s,c.length-a),c,a,l)}function V(c,s,a,l){return _(ee(s),c,a,l)}function ce(c,s,a,l){return _(b(s),c,a,l)}function re(c,s,a,l){return _(y(s,c.length-a),c,a,l)}u.prototype.write=function(s,a,l,w){if(a===void 0)w="utf8",l=this.length,a=0;else if(l===void 0&&typeof a=="string")w=a,l=this.length,a=0;else if(isFinite(a))a=a>>>0,isFinite(l)?(l=l>>>0,w===void 0&&(w="utf8")):(w=l,l=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var x=this.length-a;if((l===void 0||l>x)&&(l=x),s.length>0&&(l<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");for(var F=!1;;)switch(w){case"hex":return j(this,s,a,l);case"utf8":case"utf-8":return W(this,s,a,l);case"ascii":case"latin1":case"binary":return V(this,s,a,l);case"base64":return ce(this,s,a,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,s,a,l);default:if(F)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),F=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function E(c,s,a){return s===0&&a===c.length?e.fromByteArray(c):e.fromByteArray(c.slice(s,a))}function T(c,s,a){a=Math.min(c.length,a);for(var l=[],w=s;w<a;){var x=c[w],F=null,Y=x>239?4:x>223?3:x>191?2:1;if(w+Y<=a){var se,le,de,Q;switch(Y){case 1:x<128&&(F=x);break;case 2:se=c[w+1],(se&192)===128&&(Q=(x&31)<<6|se&63,Q>127&&(F=Q));break;case 3:se=c[w+1],le=c[w+2],(se&192)===128&&(le&192)===128&&(Q=(x&15)<<12|(se&63)<<6|le&63,Q>2047&&(Q<55296||Q>57343)&&(F=Q));break;case 4:se=c[w+1],le=c[w+2],de=c[w+3],(se&192)===128&&(le&192)===128&&(de&192)===128&&(Q=(x&15)<<18|(se&63)<<12|(le&63)<<6|de&63,Q>65535&&Q<1114112&&(F=Q))}}F===null?(F=65533,Y=1):F>65535&&(F-=65536,l.push(F>>>10&1023|55296),F=56320|F&1023),l.push(F),w+=Y}return M(l)}var D=4096;function M(c){var s=c.length;if(s<=D)return String.fromCharCode.apply(String,c);for(var a="",l=0;l<s;)a+=String.fromCharCode.apply(String,c.slice(l,l+=D));return a}function R(c,s,a){var l="";a=Math.min(c.length,a);for(var w=s;w<a;++w)l+=String.fromCharCode(c[w]&127);return l}function G(c,s,a){var l="";a=Math.min(c.length,a);for(var w=s;w<a;++w)l+=String.fromCharCode(c[w]);return l}function Z(c,s,a){var l=c.length;(!s||s<0)&&(s=0),(!a||a<0||a>l)&&(a=l);for(var w="",x=s;x<a;++x)w+=O[c[x]];return w}function ue(c,s,a){for(var l=c.slice(s,a),w="",x=0;x<l.length-1;x+=2)w+=String.fromCharCode(l[x]+l[x+1]*256);return w}u.prototype.slice=function(s,a){var l=this.length;s=~~s,a=a===void 0?l:~~a,s<0?(s+=l,s<0&&(s=0)):s>l&&(s=l),a<0?(a+=l,a<0&&(a=0)):a>l&&(a=l),a<s&&(a=s);var w=this.subarray(s,a);return Object.setPrototypeOf(w,u.prototype),w};function ne(c,s,a){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+s>a)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(s,a,l){s=s>>>0,a=a>>>0,l||ne(s,a,this.length);for(var w=this[s],x=1,F=0;++F<a&&(x*=256);)w+=this[s+F]*x;return w},u.prototype.readUintBE=u.prototype.readUIntBE=function(s,a,l){s=s>>>0,a=a>>>0,l||ne(s,a,this.length);for(var w=this[s+--a],x=1;a>0&&(x*=256);)w+=this[s+--a]*x;return w},u.prototype.readUint8=u.prototype.readUInt8=function(s,a){return s=s>>>0,a||ne(s,1,this.length),this[s]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(s,a){return s=s>>>0,a||ne(s,2,this.length),this[s]|this[s+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(s,a){return s=s>>>0,a||ne(s,2,this.length),this[s]<<8|this[s+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(s,a){return s=s>>>0,a||ne(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+this[s+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(s,a){return s=s>>>0,a||ne(s,4,this.length),this[s]*16777216+(this[s+1]<<16|this[s+2]<<8|this[s+3])},u.prototype.readIntLE=function(s,a,l){s=s>>>0,a=a>>>0,l||ne(s,a,this.length);for(var w=this[s],x=1,F=0;++F<a&&(x*=256);)w+=this[s+F]*x;return x*=128,w>=x&&(w-=Math.pow(2,8*a)),w},u.prototype.readIntBE=function(s,a,l){s=s>>>0,a=a>>>0,l||ne(s,a,this.length);for(var w=a,x=1,F=this[s+--w];w>0&&(x*=256);)F+=this[s+--w]*x;return x*=128,F>=x&&(F-=Math.pow(2,8*a)),F},u.prototype.readInt8=function(s,a){return s=s>>>0,a||ne(s,1,this.length),this[s]&128?(255-this[s]+1)*-1:this[s]},u.prototype.readInt16LE=function(s,a){s=s>>>0,a||ne(s,2,this.length);var l=this[s]|this[s+1]<<8;return l&32768?l|4294901760:l},u.prototype.readInt16BE=function(s,a){s=s>>>0,a||ne(s,2,this.length);var l=this[s+1]|this[s]<<8;return l&32768?l|4294901760:l},u.prototype.readInt32LE=function(s,a){return s=s>>>0,a||ne(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},u.prototype.readInt32BE=function(s,a){return s=s>>>0,a||ne(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},u.prototype.readFloatLE=function(s,a){return s=s>>>0,a||ne(s,4,this.length),t.read(this,s,!0,23,4)},u.prototype.readFloatBE=function(s,a){return s=s>>>0,a||ne(s,4,this.length),t.read(this,s,!1,23,4)},u.prototype.readDoubleLE=function(s,a){return s=s>>>0,a||ne(s,8,this.length),t.read(this,s,!0,52,8)},u.prototype.readDoubleBE=function(s,a){return s=s>>>0,a||ne(s,8,this.length),t.read(this,s,!1,52,8)};function oe(c,s,a,l,w,x){if(!u.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>w||s<x)throw new RangeError('"value" argument is out of bounds');if(a+l>c.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(s,a,l,w){if(s=+s,a=a>>>0,l=l>>>0,!w){var x=Math.pow(2,8*l)-1;oe(this,s,a,l,x,0)}var F=1,Y=0;for(this[a]=s&255;++Y<l&&(F*=256);)this[a+Y]=s/F&255;return a+l},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(s,a,l,w){if(s=+s,a=a>>>0,l=l>>>0,!w){var x=Math.pow(2,8*l)-1;oe(this,s,a,l,x,0)}var F=l-1,Y=1;for(this[a+F]=s&255;--F>=0&&(Y*=256);)this[a+F]=s/Y&255;return a+l},u.prototype.writeUint8=u.prototype.writeUInt8=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,1,255,0),this[a]=s&255,a+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,2,65535,0),this[a]=s&255,this[a+1]=s>>>8,a+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,2,65535,0),this[a]=s>>>8,this[a+1]=s&255,a+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,4,4294967295,0),this[a+3]=s>>>24,this[a+2]=s>>>16,this[a+1]=s>>>8,this[a]=s&255,a+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,4,4294967295,0),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=s&255,a+4},u.prototype.writeIntLE=function(s,a,l,w){if(s=+s,a=a>>>0,!w){var x=Math.pow(2,8*l-1);oe(this,s,a,l,x-1,-x)}var F=0,Y=1,se=0;for(this[a]=s&255;++F<l&&(Y*=256);)s<0&&se===0&&this[a+F-1]!==0&&(se=1),this[a+F]=(s/Y>>0)-se&255;return a+l},u.prototype.writeIntBE=function(s,a,l,w){if(s=+s,a=a>>>0,!w){var x=Math.pow(2,8*l-1);oe(this,s,a,l,x-1,-x)}var F=l-1,Y=1,se=0;for(this[a+F]=s&255;--F>=0&&(Y*=256);)s<0&&se===0&&this[a+F+1]!==0&&(se=1),this[a+F]=(s/Y>>0)-se&255;return a+l},u.prototype.writeInt8=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,1,127,-128),s<0&&(s=255+s+1),this[a]=s&255,a+1},u.prototype.writeInt16LE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,2,32767,-32768),this[a]=s&255,this[a+1]=s>>>8,a+2},u.prototype.writeInt16BE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,2,32767,-32768),this[a]=s>>>8,this[a+1]=s&255,a+2},u.prototype.writeInt32LE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,4,2147483647,-2147483648),this[a]=s&255,this[a+1]=s>>>8,this[a+2]=s>>>16,this[a+3]=s>>>24,a+4},u.prototype.writeInt32BE=function(s,a,l){return s=+s,a=a>>>0,l||oe(this,s,a,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=s&255,a+4};function K(c,s,a,l,w,x){if(a+l>c.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function p(c,s,a,l,w){return s=+s,a=a>>>0,w||K(c,s,a,4),t.write(c,s,a,l,23,4),a+4}u.prototype.writeFloatLE=function(s,a,l){return p(this,s,a,!0,l)},u.prototype.writeFloatBE=function(s,a,l){return p(this,s,a,!1,l)};function X(c,s,a,l,w){return s=+s,a=a>>>0,w||K(c,s,a,8),t.write(c,s,a,l,52,8),a+8}u.prototype.writeDoubleLE=function(s,a,l){return X(this,s,a,!0,l)},u.prototype.writeDoubleBE=function(s,a,l){return X(this,s,a,!1,l)},u.prototype.copy=function(s,a,l,w){if(!u.isBuffer(s))throw new TypeError("argument should be a Buffer");if(l||(l=0),!w&&w!==0&&(w=this.length),a>=s.length&&(a=s.length),a||(a=0),w>0&&w<l&&(w=l),w===l||s.length===0||this.length===0)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(l<0||l>=this.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),s.length-a<w-l&&(w=s.length-a+l);var x=w-l;return this===s&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(a,l,w):Uint8Array.prototype.set.call(s,this.subarray(l,w),a),x},u.prototype.fill=function(s,a,l,w){if(typeof s=="string"){if(typeof a=="string"?(w=a,a=0,l=this.length):typeof l=="string"&&(w=l,l=this.length),w!==void 0&&typeof w!="string")throw new TypeError("encoding must be a string");if(typeof w=="string"&&!u.isEncoding(w))throw new TypeError("Unknown encoding: "+w);if(s.length===1){var x=s.charCodeAt(0);(w==="utf8"&&x<128||w==="latin1")&&(s=x)}}else typeof s=="number"?s=s&255:typeof s=="boolean"&&(s=Number(s));if(a<0||this.length<a||this.length<l)throw new RangeError("Out of range index");if(l<=a)return this;a=a>>>0,l=l===void 0?this.length:l>>>0,s||(s=0);var F;if(typeof s=="number")for(F=a;F<l;++F)this[F]=s;else{var Y=u.isBuffer(s)?s:u.from(s,w),se=Y.length;if(se===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(F=0;F<l-a;++F)this[F+a]=Y[F%se]}return this};var te=/[^+/0-9A-Za-z-_]/g;function ie(c){if(c=c.split("=")[0],c=c.trim().replace(te,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function z(c,s){s=s||1/0;for(var a,l=c.length,w=null,x=[],F=0;F<l;++F){if(a=c.charCodeAt(F),a>55295&&a<57344){if(!w){if(a>56319){(s-=3)>-1&&x.push(239,191,189);continue}else if(F+1===l){(s-=3)>-1&&x.push(239,191,189);continue}w=a;continue}if(a<56320){(s-=3)>-1&&x.push(239,191,189),w=a;continue}a=(w-55296<<10|a-56320)+65536}else w&&(s-=3)>-1&&x.push(239,191,189);if(w=null,a<128){if((s-=1)<0)break;x.push(a)}else if(a<2048){if((s-=2)<0)break;x.push(a>>6|192,a&63|128)}else if(a<65536){if((s-=3)<0)break;x.push(a>>12|224,a>>6&63|128,a&63|128)}else if(a<1114112){if((s-=4)<0)break;x.push(a>>18|240,a>>12&63|128,a>>6&63|128,a&63|128)}else throw new Error("Invalid code point")}return x}function ee(c){for(var s=[],a=0;a<c.length;++a)s.push(c.charCodeAt(a)&255);return s}function y(c,s){for(var a,l,w,x=[],F=0;F<c.length&&!((s-=2)<0);++F)a=c.charCodeAt(F),l=a>>8,w=a%256,x.push(w),x.push(l);return x}function b(c){return e.toByteArray(ie(c))}function _(c,s,a,l){for(var w=0;w<l&&!(w+a>=s.length||w>=c.length);++w)s[w+a]=c[w];return w}function N(c,s){return c instanceof s||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===s.name}function A(c){return c!==c}var O=function(){for(var c="0123456789abcdef",s=new Array(256),a=0;a<16;++a)for(var l=a*16,w=0;w<16;++w)s[l+w]=c[a]+c[w];return s}()})(Hr);var Qa={exports:{}};(function(r){(function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,f="[BigNumber Error] ",u=f+"Number primitive has more than 15 significant digits: ",d=1e14,g=14,m=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],B=1e7,S=1e9;function h(H){var q,j,W,V=p.prototype={constructor:p,toString:null,valueOf:null},ce=new p(1),re=20,E=4,T=-7,D=21,M=-1e7,R=1e7,G=!1,Z=1,ue=0,ne={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},oe="0123456789abcdefghijklmnopqrstuvwxyz",K=!0;function p(y,b){var _,N,A,O,c,s,a,l,w=this;if(!(w instanceof p))return new p(y,b);if(b==null){if(y&&y._isBigNumber===!0){w.s=y.s,!y.c||y.e>R?w.c=w.e=null:y.e<M?w.c=[w.e=0]:(w.e=y.e,w.c=y.c.slice());return}if((s=typeof y=="number")&&y*0==0){if(w.s=1/y<0?(y=-y,-1):1,y===~~y){for(O=0,c=y;c>=10;c/=10,O++);O>R?w.c=w.e=null:(w.e=O,w.c=[y]);return}l=String(y)}else{if(!n.test(l=String(y)))return W(w,l,s);w.s=l.charCodeAt(0)==45?(l=l.slice(1),-1):1}(O=l.indexOf("."))>-1&&(l=l.replace(".","")),(c=l.search(/e/i))>0?(O<0&&(O=c),O+=+l.slice(c+1),l=l.substring(0,c)):O<0&&(O=l.length)}else{if($(b,2,oe.length,"Base"),b==10&&K)return w=new p(y),z(w,re+w.e+1,E);if(l=String(y),s=typeof y=="number"){if(y*0!=0)return W(w,l,s,b);if(w.s=1/y<0?(l=l.slice(1),-1):1,p.DEBUG&&l.replace(/^0\.0*|\./,"").length>15)throw Error(u+y)}else w.s=l.charCodeAt(0)===45?(l=l.slice(1),-1):1;for(_=oe.slice(0,b),O=c=0,a=l.length;c<a;c++)if(_.indexOf(N=l.charAt(c))<0){if(N=="."){if(c>O){O=a;continue}}else if(!A&&(l==l.toUpperCase()&&(l=l.toLowerCase())||l==l.toLowerCase()&&(l=l.toUpperCase()))){A=!0,c=-1,O=0;continue}return W(w,String(y),s,b)}s=!1,l=j(l,b,10,w.s),(O=l.indexOf("."))>-1?l=l.replace(".",""):O=l.length}for(c=0;l.charCodeAt(c)===48;c++);for(a=l.length;l.charCodeAt(--a)===48;);if(l=l.slice(c,++a)){if(a-=c,s&&p.DEBUG&&a>15&&(y>m||y!==o(y)))throw Error(u+w.s*y);if((O=O-c-1)>R)w.c=w.e=null;else if(O<M)w.c=[w.e=0];else{if(w.e=O,w.c=[],c=(O+1)%g,O<0&&(c+=g),c<a){for(c&&w.c.push(+l.slice(0,c)),a-=g;c<a;)w.c.push(+l.slice(c,c+=g));c=g-(l=l.slice(c)).length}else c-=a;for(;c--;l+="0");w.c.push(+l)}}else w.c=[w.e=0]}p.clone=h,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(y){var b,_;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(b="DECIMAL_PLACES")&&(_=y[b],$(_,0,S,b),re=_),y.hasOwnProperty(b="ROUNDING_MODE")&&(_=y[b],$(_,0,8,b),E=_),y.hasOwnProperty(b="EXPONENTIAL_AT")&&(_=y[b],_&&_.pop?($(_[0],-S,0,b),$(_[1],0,S,b),T=_[0],D=_[1]):($(_,-S,S,b),T=-(D=_<0?-_:_))),y.hasOwnProperty(b="RANGE"))if(_=y[b],_&&_.pop)$(_[0],-S,-1,b),$(_[1],1,S,b),M=_[0],R=_[1];else if($(_,-S,S,b),_)M=-(R=_<0?-_:_);else throw Error(f+b+" cannot be zero: "+_);if(y.hasOwnProperty(b="CRYPTO"))if(_=y[b],_===!!_)if(_)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))G=_;else throw G=!_,Error(f+"crypto unavailable");else G=_;else throw Error(f+b+" not true or false: "+_);if(y.hasOwnProperty(b="MODULO_MODE")&&(_=y[b],$(_,0,9,b),Z=_),y.hasOwnProperty(b="POW_PRECISION")&&(_=y[b],$(_,0,S,b),ue=_),y.hasOwnProperty(b="FORMAT"))if(_=y[b],typeof _=="object")ne=_;else throw Error(f+b+" not an object: "+_);if(y.hasOwnProperty(b="ALPHABET"))if(_=y[b],typeof _=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(_))K=_.slice(0,10)=="0123456789",oe=_;else throw Error(f+b+" invalid: "+_)}else throw Error(f+"Object expected: "+y);return{DECIMAL_PLACES:re,ROUNDING_MODE:E,EXPONENTIAL_AT:[T,D],RANGE:[M,R],CRYPTO:G,MODULO_MODE:Z,POW_PRECISION:ue,FORMAT:ne,ALPHABET:oe}},p.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var b,_,N=y.c,A=y.e,O=y.s;e:if({}.toString.call(N)=="[object Array]"){if((O===1||O===-1)&&A>=-S&&A<=S&&A===o(A)){if(N[0]===0){if(A===0&&N.length===1)return!0;break e}if(b=(A+1)%g,b<1&&(b+=g),String(N[0]).length==b){for(b=0;b<N.length;b++)if(_=N[b],_<0||_>=d||_!==o(_))break e;if(_!==0)return!0}}}else if(N===null&&A===null&&(O===null||O===1||O===-1))return!0;throw Error(f+"Invalid BigNumber: "+y)},p.maximum=p.max=function(){return te(arguments,-1)},p.minimum=p.min=function(){return te(arguments,1)},p.random=function(){var y=9007199254740992,b=Math.random()*y&2097151?function(){return o(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(_){var N,A,O,c,s,a=0,l=[],w=new p(ce);if(_==null?_=re:$(_,0,S),c=i(_/g),G)if(crypto.getRandomValues){for(N=crypto.getRandomValues(new Uint32Array(c*=2));a<c;)s=N[a]*131072+(N[a+1]>>>11),s>=9e15?(A=crypto.getRandomValues(new Uint32Array(2)),N[a]=A[0],N[a+1]=A[1]):(l.push(s%1e14),a+=2);a=c/2}else if(crypto.randomBytes){for(N=crypto.randomBytes(c*=7);a<c;)s=(N[a]&31)*281474976710656+N[a+1]*1099511627776+N[a+2]*4294967296+N[a+3]*16777216+(N[a+4]<<16)+(N[a+5]<<8)+N[a+6],s>=9e15?crypto.randomBytes(7).copy(N,a):(l.push(s%1e14),a+=7);a=c/7}else throw G=!1,Error(f+"crypto unavailable");if(!G)for(;a<c;)s=b(),s<9e15&&(l[a++]=s%1e14);for(c=l[--a],_%=g,c&&_&&(s=v[g-_],l[a]=o(c/s)*s);l[a]===0;l.pop(),a--);if(a<0)l=[O=0];else{for(O=-1;l[0]===0;l.splice(0,1),O-=g);for(a=1,s=l[0];s>=10;s/=10,a++);a<g&&(O-=g-a)}return w.e=O,w.c=l,w}}(),p.sum=function(){for(var y=1,b=arguments,_=new p(b[0]);y<b.length;)_=_.plus(b[y++]);return _},j=function(){var y="0123456789";function b(_,N,A,O){for(var c,s=[0],a,l=0,w=_.length;l<w;){for(a=s.length;a--;s[a]*=N);for(s[0]+=O.indexOf(_.charAt(l++)),c=0;c<s.length;c++)s[c]>A-1&&(s[c+1]==null&&(s[c+1]=0),s[c+1]+=s[c]/A|0,s[c]%=A)}return s.reverse()}return function(_,N,A,O,c){var s,a,l,w,x,F,Y,se,le=_.indexOf("."),de=re,Q=E;for(le>=0&&(w=ue,ue=0,_=_.replace(".",""),se=new p(N),F=se.pow(_.length-le),ue=w,se.c=b(P(U(F.c),F.e,"0"),10,A,y),se.e=se.c.length),Y=b(_,N,A,c?(s=oe,y):(s=y,oe)),l=w=Y.length;Y[--w]==0;Y.pop());if(!Y[0])return s.charAt(0);if(le<0?--l:(F.c=Y,F.e=l,F.s=O,F=q(F,se,de,Q,A),Y=F.c,x=F.r,l=F.e),a=l+de+1,le=Y[a],w=A/2,x=x||a<0||Y[a+1]!=null,x=Q<4?(le!=null||x)&&(Q==0||Q==(F.s<0?3:2)):le>w||le==w&&(Q==4||x||Q==6&&Y[a-1]&1||Q==(F.s<0?8:7)),a<1||!Y[0])_=x?P(s.charAt(1),-de,s.charAt(0)):s.charAt(0);else{if(Y.length=a,x)for(--A;++Y[--a]>A;)Y[a]=0,a||(++l,Y=[1].concat(Y));for(w=Y.length;!Y[--w];);for(le=0,_="";le<=w;_+=s.charAt(Y[le++]));_=P(_,l,s.charAt(0))}return _}}(),q=function(){function y(N,A,O){var c,s,a,l,w=0,x=N.length,F=A%B,Y=A/B|0;for(N=N.slice();x--;)a=N[x]%B,l=N[x]/B|0,c=Y*a+l*F,s=F*a+c%B*B+w,w=(s/O|0)+(c/B|0)+Y*l,N[x]=s%O;return w&&(N=[w].concat(N)),N}function b(N,A,O,c){var s,a;if(O!=c)a=O>c?1:-1;else for(s=a=0;s<O;s++)if(N[s]!=A[s]){a=N[s]>A[s]?1:-1;break}return a}function _(N,A,O,c){for(var s=0;O--;)N[O]-=s,s=N[O]<A[O]?1:0,N[O]=s*c+N[O]-A[O];for(;!N[0]&&N.length>1;N.splice(0,1));}return function(N,A,O,c,s){var a,l,w,x,F,Y,se,le,de,Q,ye,Ne,st,Zt,Ir,be,Xt,Je=N.s==A.s?1:-1,He=N.c,Ae=A.c;if(!He||!He[0]||!Ae||!Ae[0])return new p(!N.s||!A.s||(He?Ae&&He[0]==Ae[0]:!Ae)?NaN:He&&He[0]==0||!Ae?Je*0:Je/0);for(le=new p(Je),de=le.c=[],l=N.e-A.e,Je=O+l+1,s||(s=d,l=L(N.e/g)-L(A.e/g),Je=Je/g|0),w=0;Ae[w]==(He[w]||0);w++);if(Ae[w]>(He[w]||0)&&l--,Je<0)de.push(1),x=!0;else{for(Zt=He.length,be=Ae.length,w=0,Je+=2,F=o(s/(Ae[0]+1)),F>1&&(Ae=y(Ae,F,s),He=y(He,F,s),be=Ae.length,Zt=He.length),st=be,Q=He.slice(0,be),ye=Q.length;ye<be;Q[ye++]=0);Xt=Ae.slice(),Xt=[0].concat(Xt),Ir=Ae[0],Ae[1]>=s/2&&Ir++;do{if(F=0,a=b(Ae,Q,be,ye),a<0){if(Ne=Q[0],be!=ye&&(Ne=Ne*s+(Q[1]||0)),F=o(Ne/Ir),F>1)for(F>=s&&(F=s-1),Y=y(Ae,F,s),se=Y.length,ye=Q.length;b(Y,Q,se,ye)==1;)F--,_(Y,be<se?Xt:Ae,se,s),se=Y.length,a=1;else F==0&&(a=F=1),Y=Ae.slice(),se=Y.length;if(se<ye&&(Y=[0].concat(Y)),_(Q,Y,ye,s),ye=Q.length,a==-1)for(;b(Ae,Q,be,ye)<1;)F++,_(Q,be<ye?Xt:Ae,ye,s),ye=Q.length}else a===0&&(F++,Q=[0]);de[w++]=F,Q[0]?Q[ye++]=He[st]||0:(Q=[He[st]],ye=1)}while((st++<Zt||Q[0]!=null)&&Je--);x=Q[0]!=null,de[0]||de.splice(0,1)}if(s==d){for(w=1,Je=de[0];Je>=10;Je/=10,w++);z(le,O+(le.e=w+l*g-1)+1,c,x)}else le.e=l,le.r=+x;return le}}();function X(y,b,_,N){var A,O,c,s,a;if(_==null?_=E:$(_,0,8),!y.c)return y.toString();if(A=y.c[0],c=y.e,b==null)a=U(y.c),a=N==1||N==2&&(c<=T||c>=D)?J(a,c):P(a,c,"0");else if(y=z(new p(y),b,_),O=y.e,a=U(y.c),s=a.length,N==1||N==2&&(b<=O||O<=T)){for(;s<b;a+="0",s++);a=J(a,O)}else if(b-=c,a=P(a,O,"0"),O+1>s){if(--b>0)for(a+=".";b--;a+="0");}else if(b+=O-s,b>0)for(O+1==s&&(a+=".");b--;a+="0");return y.s<0&&A?"-"+a:a}function te(y,b){for(var _,N,A=1,O=new p(y[0]);A<y.length;A++)N=new p(y[A]),(!N.s||(_=C(O,N))===b||_===0&&O.s===b)&&(O=N);return O}function ie(y,b,_){for(var N=1,A=b.length;!b[--A];b.pop());for(A=b[0];A>=10;A/=10,N++);return(_=N+_*g-1)>R?y.c=y.e=null:_<M?y.c=[y.e=0]:(y.e=_,y.c=b),y}W=function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,_=/^\.([^.]+)$/,N=/^-?(Infinity|NaN)$/,A=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(O,c,s,a){var l,w=s?c:c.replace(A,"");if(N.test(w))O.s=isNaN(w)?null:w<0?-1:1;else{if(!s&&(w=w.replace(y,function(x,F,Y){return l=(Y=Y.toLowerCase())=="x"?16:Y=="b"?2:8,!a||a==l?F:x}),a&&(l=a,w=w.replace(b,"$1").replace(_,"0.$1")),c!=w))return new p(w,l);if(p.DEBUG)throw Error(f+"Not a"+(a?" base "+a:"")+" number: "+c);O.s=null}O.c=O.e=null}}();function z(y,b,_,N){var A,O,c,s,a,l,w,x=y.c,F=v;if(x){e:{for(A=1,s=x[0];s>=10;s/=10,A++);if(O=b-A,O<0)O+=g,c=b,a=x[l=0],w=o(a/F[A-c-1]%10);else if(l=i((O+1)/g),l>=x.length)if(N){for(;x.length<=l;x.push(0));a=w=0,A=1,O%=g,c=O-g+1}else break e;else{for(a=s=x[l],A=1;s>=10;s/=10,A++);O%=g,c=O-g+A,w=c<0?0:o(a/F[A-c-1]%10)}if(N=N||b<0||x[l+1]!=null||(c<0?a:a%F[A-c-1]),N=_<4?(w||N)&&(_==0||_==(y.s<0?3:2)):w>5||w==5&&(_==4||N||_==6&&(O>0?c>0?a/F[A-c]:0:x[l-1])%10&1||_==(y.s<0?8:7)),b<1||!x[0])return x.length=0,N?(b-=y.e+1,x[0]=F[(g-b%g)%g],y.e=-b||0):x[0]=y.e=0,y;if(O==0?(x.length=l,s=1,l--):(x.length=l+1,s=F[g-O],x[l]=c>0?o(a/F[A-c]%F[c])*s:0),N)for(;;)if(l==0){for(O=1,c=x[0];c>=10;c/=10,O++);for(c=x[0]+=s,s=1;c>=10;c/=10,s++);O!=s&&(y.e++,x[0]==d&&(x[0]=1));break}else{if(x[l]+=s,x[l]!=d)break;x[l--]=0,s=1}for(O=x.length;x[--O]===0;x.pop());}y.e>R?y.c=y.e=null:y.e<M&&(y.c=[y.e=0])}return y}function ee(y){var b,_=y.e;return _===null?y.toString():(b=U(y.c),b=_<=T||_>=D?J(b,_):P(b,_,"0"),y.s<0?"-"+b:b)}return V.absoluteValue=V.abs=function(){var y=new p(this);return y.s<0&&(y.s=1),y},V.comparedTo=function(y,b){return C(this,new p(y,b))},V.decimalPlaces=V.dp=function(y,b){var _,N,A,O=this;if(y!=null)return $(y,0,S),b==null?b=E:$(b,0,8),z(new p(O),y+O.e+1,b);if(!(_=O.c))return null;if(N=((A=_.length-1)-L(this.e/g))*g,A=_[A])for(;A%10==0;A/=10,N--);return N<0&&(N=0),N},V.dividedBy=V.div=function(y,b){return q(this,new p(y,b),re,E)},V.dividedToIntegerBy=V.idiv=function(y,b){return q(this,new p(y,b),0,1)},V.exponentiatedBy=V.pow=function(y,b){var _,N,A,O,c,s,a,l,w,x=this;if(y=new p(y),y.c&&!y.isInteger())throw Error(f+"Exponent not an integer: "+ee(y));if(b!=null&&(b=new p(b)),s=y.e>14,!x.c||!x.c[0]||x.c[0]==1&&!x.e&&x.c.length==1||!y.c||!y.c[0])return w=new p(Math.pow(+ee(x),s?y.s*(2-k(y)):+ee(y))),b?w.mod(b):w;if(a=y.s<0,b){if(b.c?!b.c[0]:!b.s)return new p(NaN);N=!a&&x.isInteger()&&b.isInteger(),N&&(x=x.mod(b))}else{if(y.e>9&&(x.e>0||x.e<-1||(x.e==0?x.c[0]>1||s&&x.c[1]>=24e7:x.c[0]<8e13||s&&x.c[0]<=9999975e7)))return O=x.s<0&&k(y)?-0:0,x.e>-1&&(O=1/O),new p(a?1/O:O);ue&&(O=i(ue/g+2))}for(s?(_=new p(.5),a&&(y.s=1),l=k(y)):(A=Math.abs(+ee(y)),l=A%2),w=new p(ce);;){if(l){if(w=w.times(x),!w.c)break;O?w.c.length>O&&(w.c.length=O):N&&(w=w.mod(b))}if(A){if(A=o(A/2),A===0)break;l=A%2}else if(y=y.times(_),z(y,y.e+1,1),y.e>14)l=k(y);else{if(A=+ee(y),A===0)break;l=A%2}x=x.times(x),O?x.c&&x.c.length>O&&(x.c.length=O):N&&(x=x.mod(b))}return N?w:(a&&(w=ce.div(w)),b?w.mod(b):O?z(w,ue,E,c):w)},V.integerValue=function(y){var b=new p(this);return y==null?y=E:$(y,0,8),z(b,b.e+1,y)},V.isEqualTo=V.eq=function(y,b){return C(this,new p(y,b))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(y,b){return C(this,new p(y,b))>0},V.isGreaterThanOrEqualTo=V.gte=function(y,b){return(b=C(this,new p(y,b)))===1||b===0},V.isInteger=function(){return!!this.c&&L(this.e/g)>this.c.length-2},V.isLessThan=V.lt=function(y,b){return C(this,new p(y,b))<0},V.isLessThanOrEqualTo=V.lte=function(y,b){return(b=C(this,new p(y,b)))===-1||b===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(y,b){var _,N,A,O,c=this,s=c.s;if(y=new p(y,b),b=y.s,!s||!b)return new p(NaN);if(s!=b)return y.s=-b,c.plus(y);var a=c.e/g,l=y.e/g,w=c.c,x=y.c;if(!a||!l){if(!w||!x)return w?(y.s=-b,y):new p(x?c:NaN);if(!w[0]||!x[0])return x[0]?(y.s=-b,y):new p(w[0]?c:E==3?-0:0)}if(a=L(a),l=L(l),w=w.slice(),s=a-l){for((O=s<0)?(s=-s,A=w):(l=a,A=x),A.reverse(),b=s;b--;A.push(0));A.reverse()}else for(N=(O=(s=w.length)<(b=x.length))?s:b,s=b=0;b<N;b++)if(w[b]!=x[b]){O=w[b]<x[b];break}if(O&&(A=w,w=x,x=A,y.s=-y.s),b=(N=x.length)-(_=w.length),b>0)for(;b--;w[_++]=0);for(b=d-1;N>s;){if(w[--N]<x[N]){for(_=N;_&&!w[--_];w[_]=b);--w[_],w[N]+=d}w[N]-=x[N]}for(;w[0]==0;w.splice(0,1),--l);return w[0]?ie(y,w,l):(y.s=E==3?-1:1,y.c=[y.e=0],y)},V.modulo=V.mod=function(y,b){var _,N,A=this;return y=new p(y,b),!A.c||!y.s||y.c&&!y.c[0]?new p(NaN):!y.c||A.c&&!A.c[0]?new p(A):(Z==9?(N=y.s,y.s=1,_=q(A,y,0,3),y.s=N,_.s*=N):_=q(A,y,0,Z),y=A.minus(_.times(y)),!y.c[0]&&Z==1&&(y.s=A.s),y)},V.multipliedBy=V.times=function(y,b){var _,N,A,O,c,s,a,l,w,x,F,Y,se,le,de,Q=this,ye=Q.c,Ne=(y=new p(y,b)).c;if(!ye||!Ne||!ye[0]||!Ne[0])return!Q.s||!y.s||ye&&!ye[0]&&!Ne||Ne&&!Ne[0]&&!ye?y.c=y.e=y.s=null:(y.s*=Q.s,!ye||!Ne?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(N=L(Q.e/g)+L(y.e/g),y.s*=Q.s,a=ye.length,x=Ne.length,a<x&&(se=ye,ye=Ne,Ne=se,A=a,a=x,x=A),A=a+x,se=[];A--;se.push(0));for(le=d,de=B,A=x;--A>=0;){for(_=0,F=Ne[A]%de,Y=Ne[A]/de|0,c=a,O=A+c;O>A;)l=ye[--c]%de,w=ye[c]/de|0,s=Y*l+w*F,l=F*l+s%de*de+se[O]+_,_=(l/le|0)+(s/de|0)+Y*w,se[O--]=l%le;se[O]=_}return _?++N:se.splice(0,1),ie(y,se,N)},V.negated=function(){var y=new p(this);return y.s=-y.s||null,y},V.plus=function(y,b){var _,N=this,A=N.s;if(y=new p(y,b),b=y.s,!A||!b)return new p(NaN);if(A!=b)return y.s=-b,N.minus(y);var O=N.e/g,c=y.e/g,s=N.c,a=y.c;if(!O||!c){if(!s||!a)return new p(A/0);if(!s[0]||!a[0])return a[0]?y:new p(s[0]?N:A*0)}if(O=L(O),c=L(c),s=s.slice(),A=O-c){for(A>0?(c=O,_=a):(A=-A,_=s),_.reverse();A--;_.push(0));_.reverse()}for(A=s.length,b=a.length,A-b<0&&(_=a,a=s,s=_,b=A),A=0;b;)A=(s[--b]=s[b]+a[b]+A)/d|0,s[b]=d===s[b]?0:s[b]%d;return A&&(s=[A].concat(s),++c),ie(y,s,c)},V.precision=V.sd=function(y,b){var _,N,A,O=this;if(y!=null&&y!==!!y)return $(y,1,S),b==null?b=E:$(b,0,8),z(new p(O),y,b);if(!(_=O.c))return null;if(A=_.length-1,N=A*g+1,A=_[A]){for(;A%10==0;A/=10,N--);for(A=_[0];A>=10;A/=10,N++);}return y&&O.e+1>N&&(N=O.e+1),N},V.shiftedBy=function(y){return $(y,-m,m),this.times("1e"+y)},V.squareRoot=V.sqrt=function(){var y,b,_,N,A,O=this,c=O.c,s=O.s,a=O.e,l=re+4,w=new p("0.5");if(s!==1||!c||!c[0])return new p(!s||s<0&&(!c||c[0])?NaN:c?O:1/0);if(s=Math.sqrt(+ee(O)),s==0||s==1/0?(b=U(c),(b.length+a)%2==0&&(b+="0"),s=Math.sqrt(+b),a=L((a+1)/2)-(a<0||a%2),s==1/0?b="5e"+a:(b=s.toExponential(),b=b.slice(0,b.indexOf("e")+1)+a),_=new p(b)):_=new p(s+""),_.c[0]){for(a=_.e,s=a+l,s<3&&(s=0);;)if(A=_,_=w.times(A.plus(q(O,A,l,1))),U(A.c).slice(0,s)===(b=U(_.c)).slice(0,s))if(_.e<a&&--s,b=b.slice(s-3,s+1),b=="9999"||!N&&b=="4999"){if(!N&&(z(A,A.e+re+2,0),A.times(A).eq(O))){_=A;break}l+=4,s+=4,N=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(z(_,_.e+re+2,1),y=!_.times(_).eq(O));break}}return z(_,_.e+re+1,E,y)},V.toExponential=function(y,b){return y!=null&&($(y,0,S),y++),X(this,y,b,1)},V.toFixed=function(y,b){return y!=null&&($(y,0,S),y=y+this.e+1),X(this,y,b)},V.toFormat=function(y,b,_){var N,A=this;if(_==null)y!=null&&b&&typeof b=="object"?(_=b,b=null):y&&typeof y=="object"?(_=y,y=b=null):_=ne;else if(typeof _!="object")throw Error(f+"Argument not an object: "+_);if(N=A.toFixed(y,b),A.c){var O,c=N.split("."),s=+_.groupSize,a=+_.secondaryGroupSize,l=_.groupSeparator||"",w=c[0],x=c[1],F=A.s<0,Y=F?w.slice(1):w,se=Y.length;if(a&&(O=s,s=a,a=O,se-=O),s>0&&se>0){for(O=se%s||s,w=Y.substr(0,O);O<se;O+=s)w+=l+Y.substr(O,s);a>0&&(w+=l+Y.slice(O)),F&&(w="-"+w)}N=x?w+(_.decimalSeparator||"")+((a=+_.fractionGroupSize)?x.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):x):w}return(_.prefix||"")+N+(_.suffix||"")},V.toFraction=function(y){var b,_,N,A,O,c,s,a,l,w,x,F,Y=this,se=Y.c;if(y!=null&&(s=new p(y),!s.isInteger()&&(s.c||s.s!==1)||s.lt(ce)))throw Error(f+"Argument "+(s.isInteger()?"out of range: ":"not an integer: ")+ee(s));if(!se)return new p(Y);for(b=new p(ce),l=_=new p(ce),N=a=new p(ce),F=U(se),O=b.e=F.length-Y.e-1,b.c[0]=v[(c=O%g)<0?g+c:c],y=!y||s.comparedTo(b)>0?O>0?b:l:s,c=R,R=1/0,s=new p(F),a.c[0]=0;w=q(s,b,0,1),A=_.plus(w.times(N)),A.comparedTo(y)!=1;)_=N,N=A,l=a.plus(w.times(A=l)),a=A,b=s.minus(w.times(A=b)),s=A;return A=q(y.minus(_),N,0,1),a=a.plus(A.times(l)),_=_.plus(A.times(N)),a.s=l.s=Y.s,O=O*2,x=q(l,N,O,E).minus(Y).abs().comparedTo(q(a,_,O,E).minus(Y).abs())<1?[l,N]:[a,_],R=c,x},V.toNumber=function(){return+ee(this)},V.toPrecision=function(y,b){return y!=null&&$(y,1,S),X(this,y,b,2)},V.toString=function(y){var b,_=this,N=_.s,A=_.e;return A===null?N?(b="Infinity",N<0&&(b="-"+b)):b="NaN":(y==null?b=A<=T||A>=D?J(U(_.c),A):P(U(_.c),A,"0"):y===10&&K?(_=z(new p(_),re+A+1,E),b=P(U(_.c),_.e,"0")):($(y,2,oe.length,"Base"),b=j(P(U(_.c),A,"0"),10,y,N,!0)),N<0&&_.c[0]&&(b="-"+b)),b},V.valueOf=V.toJSON=function(){return ee(this)},V._isBigNumber=!0,H!=null&&p.set(H),p}function L(H){var q=H|0;return H>0||H===q?q:q-1}function U(H){for(var q,j,W=1,V=H.length,ce=H[0]+"";W<V;){for(q=H[W++]+"",j=g-q.length;j--;q="0"+q);ce+=q}for(V=ce.length;ce.charCodeAt(--V)===48;);return ce.slice(0,V+1||1)}function C(H,q){var j,W,V=H.c,ce=q.c,re=H.s,E=q.s,T=H.e,D=q.e;if(!re||!E)return null;if(j=V&&!V[0],W=ce&&!ce[0],j||W)return j?W?0:-E:re;if(re!=E)return re;if(j=re<0,W=T==D,!V||!ce)return W?0:!V^j?1:-1;if(!W)return T>D^j?1:-1;for(E=(T=V.length)<(D=ce.length)?T:D,re=0;re<E;re++)if(V[re]!=ce[re])return V[re]>ce[re]^j?1:-1;return T==D?0:T>D^j?1:-1}function $(H,q,j,W){if(H<q||H>j||H!==o(H))throw Error(f+(W||"Argument")+(typeof H=="number"?H<q||H>j?" out of range: ":" not an integer: ":" not a primitive number: ")+String(H))}function k(H){var q=H.c.length-1;return L(H.e/g)==q&&H.c[q]%2!=0}function J(H,q){return(H.length>1?H.charAt(0)+"."+H.slice(1):H)+(q<0?"e":"e+")+q}function P(H,q,j){var W,V;if(q<0){for(V=j+".";++q;V+=j);H=V+H}else if(W=H.length,++q>W){for(V=j,q-=W;--q;V+=j);H+=V}else q<W&&(H=H.slice(0,q)+"."+H.slice(q));return H}t=h(),t.default=t.BigNumber=t,r.exports?r.exports=t:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=t)})(br)})(Qa);var Xn=Qa.exports,iu=function(e,t,n){var i=new e.Uint8Array(n),o=t.pushInt,f=t.pushInt32,u=t.pushInt32Neg,d=t.pushInt64,g=t.pushInt64Neg,m=t.pushFloat,v=t.pushFloatSingle,B=t.pushFloatDouble,S=t.pushTrue,h=t.pushFalse,L=t.pushUndefined,U=t.pushNull,C=t.pushInfinity,$=t.pushInfinityNeg,k=t.pushNaN,J=t.pushNaNNeg,P=t.pushArrayStart,H=t.pushArrayStartFixed,q=t.pushArrayStartFixed32,j=t.pushArrayStartFixed64,W=t.pushObjectStart,V=t.pushObjectStartFixed,ce=t.pushObjectStartFixed32,re=t.pushObjectStartFixed64,E=t.pushByteString,T=t.pushByteStringStart,D=t.pushUtf8String,M=t.pushUtf8StringStart,R=t.pushSimpleUnassigned,G=t.pushTagStart,Z=t.pushTagStart4,ue=t.pushTagStart8,ne=t.pushTagUnassigned,oe=t.pushBreak,K=e.Math.pow,p=0,X=0,te=0;function ie(I){for(I=I|0,p=0,X=I;(p|0)<(X|0)&&(te=Tc[i[p]&255](i[p]|0)|0,!((te|0)>0)););return te|0}function z(I){return I=I|0,((p|0)+(I|0)|0)<(X|0)?0:1}function ee(I){return I=I|0,i[I|0]<<8|i[I+1|0]|0}function y(I){return I=I|0,i[I|0]<<24|i[I+1|0]<<16|i[I+2|0]<<8|i[I+3|0]|0}function b(I){return I=I|0,o(I|0),p=p+1|0,0}function _(I){return I=I|0,z(1)|0?1:(o(i[p+1|0]|0),p=p+2|0,0)}function N(I){return I=I|0,z(2)|0?1:(o(ee(p+1|0)|0),p=p+3|0,0)}function A(I){return I=I|0,z(4)|0?1:(f(ee(p+1|0)|0,ee(p+3|0)|0),p=p+5|0,0)}function O(I){return I=I|0,z(8)|0?1:(d(ee(p+1|0)|0,ee(p+3|0)|0,ee(p+5|0)|0,ee(p+7|0)|0),p=p+9|0,0)}function c(I){return I=I|0,o(-1-(I-32|0)|0),p=p+1|0,0}function s(I){return I=I|0,z(1)|0?1:(o(-1-(i[p+1|0]|0)|0),p=p+2|0,0)}function a(I){I=I|0;var me=0;return z(2)|0?1:(me=ee(p+1|0)|0,o(-1-(me|0)|0),p=p+3|0,0)}function l(I){return I=I|0,z(4)|0?1:(u(ee(p+1|0)|0,ee(p+3|0)|0),p=p+5|0,0)}function w(I){return I=I|0,z(8)|0?1:(g(ee(p+1|0)|0,ee(p+3|0)|0,ee(p+5|0)|0,ee(p+7|0)|0),p=p+9|0,0)}function x(I){I=I|0;var me=0,_e=0,we=0;return we=I-64|0,z(we|0)|0?1:(me=p+1|0,_e=(p+1|0)+(we|0)|0,E(me|0,_e|0),p=_e|0,0)}function F(I){I=I|0;var me=0,_e=0,we=0;return z(1)|0||(we=i[p+1|0]|0,me=p+2|0,_e=(p+2|0)+(we|0)|0,z(we+1|0)|0)?1:(E(me|0,_e|0),p=_e|0,0)}function Y(I){I=I|0;var me=0,_e=0,we=0;return z(2)|0||(we=ee(p+1|0)|0,me=p+3|0,_e=(p+3|0)+(we|0)|0,z(we+2|0)|0)?1:(E(me|0,_e|0),p=_e|0,0)}function se(I){I=I|0;var me=0,_e=0,we=0;return z(4)|0||(we=y(p+1|0)|0,me=p+5|0,_e=(p+5|0)+(we|0)|0,z(we+4|0)|0)?1:(E(me|0,_e|0),p=_e|0,0)}function le(I){return I=I|0,1}function de(I){return I=I|0,T(),p=p+1|0,0}function Q(I){I=I|0;var me=0,_e=0,we=0;return we=I-96|0,z(we|0)|0?1:(me=p+1|0,_e=(p+1|0)+(we|0)|0,D(me|0,_e|0),p=_e|0,0)}function ye(I){I=I|0;var me=0,_e=0,we=0;return z(1)|0||(we=i[p+1|0]|0,me=p+2|0,_e=(p+2|0)+(we|0)|0,z(we+1|0)|0)?1:(D(me|0,_e|0),p=_e|0,0)}function Ne(I){I=I|0;var me=0,_e=0,we=0;return z(2)|0||(we=ee(p+1|0)|0,me=p+3|0,_e=(p+3|0)+(we|0)|0,z(we+2|0)|0)?1:(D(me|0,_e|0),p=_e|0,0)}function st(I){I=I|0;var me=0,_e=0,we=0;return z(4)|0||(we=y(p+1|0)|0,me=p+5|0,_e=(p+5|0)+(we|0)|0,z(we+4|0)|0)?1:(D(me|0,_e|0),p=_e|0,0)}function Zt(I){return I=I|0,1}function Ir(I){return I=I|0,M(),p=p+1|0,0}function be(I){return I=I|0,H(I-128|0),p=p+1|0,0}function Xt(I){return I=I|0,z(1)|0?1:(H(i[p+1|0]|0),p=p+2|0,0)}function Je(I){return I=I|0,z(2)|0?1:(H(ee(p+1|0)|0),p=p+3|0,0)}function He(I){return I=I|0,z(4)|0?1:(q(ee(p+1|0)|0,ee(p+3|0)|0),p=p+5|0,0)}function Ae(I){return I=I|0,z(8)|0?1:(j(ee(p+1|0)|0,ee(p+3|0)|0,ee(p+5|0)|0,ee(p+7|0)|0),p=p+9|0,0)}function cc(I){return I=I|0,P(),p=p+1|0,0}function Te(I){I=I|0;var me=0;return me=I-160|0,z(me|0)|0?1:(V(me|0),p=p+1|0,0)}function uc(I){return I=I|0,z(1)|0?1:(V(i[p+1|0]|0),p=p+2|0,0)}function fc(I){return I=I|0,z(2)|0?1:(V(ee(p+1|0)|0),p=p+3|0,0)}function lc(I){return I=I|0,z(4)|0?1:(ce(ee(p+1|0)|0,ee(p+3|0)|0),p=p+5|0,0)}function dc(I){return I=I|0,z(8)|0?1:(re(ee(p+1|0)|0,ee(p+3|0)|0,ee(p+5|0)|0,ee(p+7|0)|0),p=p+9|0,0)}function hc(I){return I=I|0,W(),p=p+1|0,0}function ar(I){return I=I|0,G(I-192|0|0),p=p+1|0,0}function Il(I){return I=I|0,G(I|0),p=p+1|0,0}function Sl(I){return I=I|0,G(I|0),p=p+1|0,0}function Al(I){return I=I|0,G(I|0),p=p+1|0,0}function Tl(I){return I=I|0,G(I|0),p=p+1|0,0}function Ce(I){return I=I|0,G(I-192|0|0),p=p+1|0,0}function Bl(I){return I=I|0,G(I|0),p=p+1|0,0}function Nl(I){return I=I|0,G(I|0),p=p+1|0,0}function Ol(I){return I=I|0,G(I|0),p=p+1|0,0}function pc(I){return I=I|0,z(1)|0?1:(G(i[p+1|0]|0),p=p+2|0,0)}function yc(I){return I=I|0,z(2)|0?1:(G(ee(p+1|0)|0),p=p+3|0,0)}function wc(I){return I=I|0,z(4)|0?1:(Z(ee(p+1|0)|0,ee(p+3|0)|0),p=p+5|0,0)}function gc(I){return I=I|0,z(8)|0?1:(ue(ee(p+1|0)|0,ee(p+3|0)|0,ee(p+5|0)|0,ee(p+7|0)|0),p=p+9|0,0)}function Le(I){return I=I|0,R((I|0)-224|0),p=p+1|0,0}function bc(I){return I=I|0,h(),p=p+1|0,0}function mc(I){return I=I|0,S(),p=p+1|0,0}function _c(I){return I=I|0,U(),p=p+1|0,0}function xc(I){return I=I|0,L(),p=p+1|0,0}function Ec(I){return I=I|0,z(1)|0?1:(R(i[p+1|0]|0),p=p+2|0,0)}function vc(I){I=I|0;var me=0,_e=0,we=1,zr=0,Sr=0,Ul=0;return z(2)|0?1:(me=i[p+1|0]|0,_e=i[p+2|0]|0,(me|0)&128&&(we=-1),zr=+(((me|0)&124)>>2),Sr=+(((me|0)&3)<<8|_e),+zr==0?m(+(+we*5960464477539063e-23*+Sr)):+zr==31?+we==1?+Sr>0?k():C():+Sr>0?J():$():m(+(+we*K(2,+(+zr-25))*+(1024+Sr))),p=p+3|0,0)}function Ic(I){return I=I|0,z(4)|0?1:(v(i[p+1|0]|0,i[p+2|0]|0,i[p+3|0]|0,i[p+4|0]|0),p=p+5|0,0)}function Sc(I){return I=I|0,z(8)|0?1:(B(i[p+1|0]|0,i[p+2|0]|0,i[p+3|0]|0,i[p+4|0]|0,i[p+5|0]|0,i[p+6|0]|0,i[p+7|0]|0,i[p+8|0]|0),p=p+9|0,0)}function Ie(I){return I=I|0,1}function Ac(I){return I=I|0,oe(),p=p+1|0,0}var Tc=[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,_,N,A,O,Ie,Ie,Ie,Ie,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,s,a,l,w,Ie,Ie,Ie,Ie,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,F,Y,se,le,Ie,Ie,Ie,de,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,ye,Ne,st,Zt,Ie,Ie,Ie,Ir,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,Xt,Je,He,Ae,Ie,Ie,Ie,cc,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,Te,uc,fc,lc,dc,Ie,Ie,Ie,hc,ar,ar,ar,ar,ar,ar,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,pc,yc,wc,gc,Ie,Ie,Ie,Ie,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,Le,bc,mc,_c,xc,Ec,vc,Ic,Sc,Ie,Ie,Ie,Ac];return{parse:ie}},Jn={},ze={};const Ji=Xn.BigNumber;ze.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};ze.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};ze.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};ze.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};ze.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};ze.SHIFT32=Math.pow(2,32);ze.SHIFT16=Math.pow(2,16);ze.MAX_SAFE_HIGH=2097151;ze.NEG_ONE=new Ji(-1);ze.TEN=new Ji(10);ze.TWO=new Ji(2);ze.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(r){const{Buffer:e}=Hr,t=Xn.BigNumber,n=ze,i=n.SHIFT32,o=n.SHIFT16,f=2097151;r.parseHalf=function(g){var m,v,B;return B=g[0]&128?-1:1,m=(g[0]&124)>>2,v=(g[0]&3)<<8|g[1],m?m===31?B*(v?NaN:1/0):B*Math.pow(2,m-25)*(1024+v):B*5960464477539063e-23*v};function u(d){return d<16?"0"+d.toString(16):d.toString(16)}r.arrayBufferToBignumber=function(d){const g=d.byteLength;let m="";for(let v=0;v<g;v++)m+=u(d[v]);return new t(m,16)},r.buildMap=d=>{const g=new Map,m=Object.keys(d),v=m.length;for(let B=0;B<v;B++)g.set(m[B],d[m[B]]);return g},r.buildInt32=(d,g)=>d*o+g,r.buildInt64=(d,g,m,v)=>{const B=r.buildInt32(d,g),S=r.buildInt32(m,v);return B>f?new t(B).times(i).plus(S):B*i+S},r.writeHalf=function(g,m){const v=e.allocUnsafe(4);v.writeFloatBE(m,0);const B=v.readUInt32BE(0);if(B&8191)return!1;var S=B>>16&32768;const h=B>>23&255,L=B&8388607;if(h>=113&&h<=142)S+=(h-112<<10)+(L>>13);else if(h>=103&&h<113){if(L&(1<<126-h)-1)return!1;S+=L+8388608>>126-h}else return!1;return g.writeUInt16BE(S,0),!0},r.keySorter=function(d,g){var m=d[0].byteLength,v=g[0].byteLength;return m>v?1:v>m?-1:d[0].compare(g[0])},r.isNegativeZero=d=>d===0&&1/d<0,r.nextPowerOf2=d=>{let g=0;if(d&&!(d&d-1))return d;for(;d!==0;)d>>=1,g+=1;return 1<<g}})(Jn);const Qi=ze,su=Qi.MT,Wr=Qi.SIMPLE,ai=Qi.SYMS;let au=class Bi{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,su.SIMPLE_FLOAT)}static isSimple(e){return e instanceof Bi}static decode(e,t){switch(t==null&&(t=!0),e){case Wr.FALSE:return!1;case Wr.TRUE:return!0;case Wr.NULL:return t?null:ai.NULL;case Wr.UNDEFINED:return t?void 0:ai.UNDEFINED;case-1:if(!t)throw new Error("Invalid BREAK");return ai.BREAK;default:return new Bi(e)}}};var eo=au;let ou=class Ni{constructor(e,t,n){if(this.tag=e,this.value=t,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var t,n;if(n=e?.[this.tag],typeof n!="function"&&(n=Ni["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(Ni,this.value)}catch(i){return t=i,this.err=t,this}}};var to=ou;const ro=self.location?self.location.protocol+"//"+self.location.host:"",Oi=self.URL;let cu=class{constructor(e="",t=ro){this.super=new Oi(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function uu(r){if(typeof r=="string")return new Oi(r).toString();if(!(r instanceof Oi)){const e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",n=r.port?":"+r.port:"",i=r.protocol?r.protocol+"//":"",o=r.host||"",f=r.hostname||"",u=r.search||(r.query?"?"+r.query:""),d=r.hash||"",g=r.pathname||"",m=r.path||g+u;return`${i}${e||t}${o||f+n}${m}${d}`}}var no={URLWithLegacySupport:cu,URLSearchParams:self.URLSearchParams,defaultBase:ro,format:uu};const{URLWithLegacySupport:bs,format:fu}=no;var lu=(r,e={},t={},n)=>{let i=e.protocol?e.protocol.replace(":",""):"http";i=(t[i]||n||i)+":";let o;try{o=new bs(r)}catch{o={}}const f=Object.assign({},e,{protocol:i||o.protocol,host:e.host||o.host});return new bs(r,fu(f)).toString()};const{URLWithLegacySupport:du,format:hu,URLSearchParams:pu,defaultBase:yu}=no,wu=lu;var io={URL:du,URLSearchParams:pu,format:hu,relative:wu,defaultBase:yu};const{Buffer:cr}=Hr,ms=ca,gu=Xn.BigNumber,bu=iu,Ye=Jn,Ee=ze,mu=eo,_u=to,{URL:xu}=io;let Ui=class Ri{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=Ye.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=cr.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(t*1e3),2:t=>Ye.arrayBufferToBignumber(t),3:t=>Ee.NEG_ONE.minus(Ye.arrayBufferToBignumber(t)),4:t=>Ee.TEN.pow(t[0]).times(t[1]),5:t=>Ee.TWO.pow(t[0]).times(t[1]),32:t=>new xu(t),35:t=>new RegExp(t)},e.tags),this.parser=bu(br,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case Ee.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case Ee.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case Ee.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case Ee.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case Ee.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case Ee.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break}this._currentParent&&this._currentParent.type===Ee.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,t){const n=this._currentParent;switch(n.values++,n.type){case Ee.PARENT.ARRAY:case Ee.PARENT.BYTE_STRING:case Ee.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case Ee.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,typeof n.tmpKey!="string"&&(n.type=Ee.PARENT.MAP,n.ref=Ye.buildMap(n.ref)));break;case Ee.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case Ee.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,n){this._parents[this._depth]={type:t,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Ee.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){const n=this._knownTags[e];return n?n(t):new _u(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return cr.concat(e)}createByteStringFromHeap(e,t){return e===t?cr.alloc(0):cr.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return Ye.buildInt32(e,t)}createInt64(e,t,n,i){return Ye.buildInt64(e,t,n,i)}createFloat(e){return e}createFloatSingle(e,t,n,i){return ms.read([e,t,n,i],0,!1,23,4)}createFloatDouble(e,t,n,i,o,f,u,d){return ms.read([e,t,n,i,o,f,u,d],0,!1,52,8)}createInt32Neg(e,t){return-1-Ye.buildInt32(e,t)}createInt64Neg(e,t,n,i){const o=Ye.buildInt32(e,t),f=Ye.buildInt32(n,i);return o>Ee.MAX_SAFE_HIGH?Ee.NEG_ONE.minus(new gu(o).times(Ee.SHIFT32).plus(f)):-1-(o*Ee.SHIFT32+f)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new mu(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,n,i){this._push(this.createInt64(e,t,n,i))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,n,i){this._push(this.createFloatSingle(e,t,n,i))}pushFloatDouble(e,t,n,i,o,f,u,d){this._push(this.createFloatDouble(e,t,n,i,o,f,u,d))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,n,i){this._push(this.createInt64Neg(e,t,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Ee.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){const n=Ye.buildInt32(e,t);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,t,n,i){const o=Ye.buildInt64(e,t,n,i);this._createArrayStartFixed(o)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){const n=Ye.buildInt32(e,t);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,t,n,i){const o=Ye.buildInt64(e,t,n,i);this._createObjectStartFixed(o)}pushByteStringStart(){this._parents[this._depth]={type:Ee.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:Ee.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:Ee.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(Ye.buildInt32(e,t))}pushTagStart8(e,t,n,i){this.pushTagStart(Ye.buildInt64(e,t,n,i))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},Ee.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),Ee.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);const t=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,t){return typeof e=="string"&&(e=cr.from(e,t||"hex")),new Ri({size:e.length}).decodeFirst(e)}static decodeAll(e,t){return typeof e=="string"&&(e=cr.from(e,t||"hex")),new Ri({size:e.length}).decodeAll(e)}};Ui.decodeFirst=Ui.decode;var so=Ui;const{Buffer:oi}=Hr,Eu=so,vu=Jn;class es extends Eu{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,n,i){return super.createInt64(e,t,n,i).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,n,i){return super.createInt64Neg(e,t,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const t=super.createFloat(e);return vu.isNegativeZero(e)?"-0_1":`${t}_1`}createFloatSingle(e,t,n,i){return`${super.createFloatSingle(e,t,n,i)}_2`}createFloatDouble(e,t,n,i,o,f,u,d){return`${super.createFloatDouble(e,t,n,i,o,f,u,d)}_3`}createByteString(e,t){const n=e.join(", ");return t===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,t){return`h'${oi.from(super.createByteStringFromHeap(e,t)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){const n=super.createArray(e,t);return t===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,t){const n=super.createMap(e),i=Array.from(n.keys()).reduce(_s(n),"");return t===-1?`{_ ${i}}`:`{${i}}`}createObject(e,t){const n=super.createObject(e),i=Object.keys(n).reduce(_s(n),"");return t===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(e,t){const n=e.join(", ");return t===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,t){return`"${oi.from(super.createUtf8StringFromHeap(e,t)).toString("utf8")}"`}static diagnose(e,t){return typeof e=="string"&&(e=oi.from(e,t||"hex")),new es().decodeFirst(e)}}var Iu=es;function _s(r){return(e,t)=>e?`${e}, ${t}: ${r[t]}`:`${t}: ${r[t]}`}const{Buffer:mt}=Hr,{URL:Su}=io,Pi=Xn.BigNumber,ci=Jn,ke=ze,at=ke.MT,Zr=ke.NUMBYTES,xs=ke.SHIFT32,Es=ke.SYMS,ur=ke.TAG,Au=ke.MT.SIMPLE_FLOAT<<5|ke.NUMBYTES.TWO,Tu=ke.MT.SIMPLE_FLOAT<<5|ke.NUMBYTES.FOUR,Bu=ke.MT.SIMPLE_FLOAT<<5|ke.NUMBYTES.EIGHT,Nu=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.TRUE,Ou=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.FALSE,Uu=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.UNDEFINED,vs=ke.MT.SIMPLE_FLOAT<<5|ke.SIMPLE.NULL,Ru=new Pi("0x20000000000000"),Pu=mt.from("f97e00","hex"),Lu=mt.from("f9fc00","hex"),Fu=mt.from("f97c00","hex");function Mu(r){return{}.toString.call(r).slice(8,-1)}class Mn{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[Su,this._pushUrl],[Pi,this._pushBigNumber]];const t=e.genTypes||[],n=t.length;for(let i=0;i<n;i++)this.addSemanticType(t[i][0],t[i][1]);this._reset()}addSemanticType(e,t){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===e){const f=this.semanticTypes[i][1];return this.semanticTypes[i][1]=t,f}return this.semanticTypes.push([e,t]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,t,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(Pu)}_pushInfinity(e){const t=e<0?Lu:Fu;return this.push(t)}_pushFloat(e){const t=mt.allocUnsafe(2);if(ci.writeHalf(t,e)&&ci.parseHalf(t)===e)return this._pushUInt8(Au)&&this.push(t);const n=mt.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(Tu)&&this.push(n):this._pushUInt8(Bu)&&this._pushDoubleBE(e)}_pushInt(e,t,n){const i=t<<5;return e<24?this._pushUInt8(i|e):e<=255?this._pushUInt8(i|Zr.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(i|Zr.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(i|Zr.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|Zr.EIGHT)&&this._pushUInt32BE(Math.floor(e/xs))&&this._pushUInt32BE(e%xs):t===at.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,at.NEG_INT,e):this._pushInt(e,at.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const t=mt.byteLength(e,"utf8");return this._pushInt(t,at.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?Nu:Ou)}_pushUndefined(e){return this._pushUInt8(Uu)}_pushArray(e,t){const n=t.length;if(!e._pushInt(n,at.ARRAY))return!1;for(let i=0;i<n;i++)if(!e.pushAny(t[i]))return!1;return!0}_pushTag(e){return this._pushInt(e,at.TAG)}_pushDate(e,t){return e._pushTag(ur.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,at.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(ur.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,at.ARRAY))return!1;for(const n of t)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,t){return e._pushTag(ur.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=ur.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=ur.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=mt.from(n,"hex");return this._pushTag(t)&&this._pushBuffer(this,i)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-1/0:1/0);if(t.isInteger())return e._pushBigint(t);if(!(e._pushTag(ur.DECIMAL_FRAC)&&e._pushInt(2,at.ARRAY)))return!1;const n=t.decimalPlaces(),i=t.multipliedBy(new Pi(10).pow(n));return e._pushIntNum(-n)?i.abs().isLessThan(Ru)?e._pushIntNum(i.toNumber()):e._pushBigint(i):!1}_pushMap(e,t){return e._pushInt(t.size,at.MAP)?this._pushRawMap(t.size,Array.from(t)):!1}_pushObject(e){if(!e)return this._pushUInt8(vs);for(var t=this.semanticTypes.length,n=0;n<t;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);var o=Object.keys(e),f=o.length;return this._pushInt(f,at.MAP)?this._pushRawMap(f,o.map(u=>[u,e[u]])):!1}_pushRawMap(e,t){t=t.map(function(i){return i[0]=Mn.encode(i[0]),i}).sort(ci.keySorter);for(var n=0;n<e;n++)if(!this.push(t[n][0])||!this.pushAny(t[n][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var t=Mu(e);switch(t){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,mt.isBuffer(e)?e:mt.from(e));case"Null":return this._pushUInt8(vs);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case Es.NULL:return this._pushObject(null);case Es.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,t=this.resultLength,n=this.resultMethod,i=this.offset,o=0,f=0;f<i;f++)o+=t[f];var u=mt.allocUnsafe(o),d=0,g=0;for(f=0;f<i;f++){switch(g=t[f],n[f]){case 0:e[f].copy(u,d);break;case 1:u.writeUInt8(e[f],d,!0);break;case 2:u.writeUInt16BE(e[f],d,!0);break;case 3:u.writeUInt32BE(e[f],d,!0);break;case 4:u.writeDoubleBE(e[f],d,!0);break;case 5:u.write(e[f],d,g,"utf8");break;default:throw new Error("unkown method")}d+=g}var m=u;return this._reset(),m}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const t=new Mn;if(!t.pushAny(e))throw new Error("Failed to encode input");return t.finalize()}}var Du=Mn;(function(r){r.Diagnose=Iu,r.Decoder=so,r.Encoder=Du,r.Simple=eo,r.Tagged=to,r.decodeAll=r.Decoder.decodeAll,r.decodeFirst=r.Decoder.decodeFirst,r.diagnose=r.Diagnose.diagnose,r.encode=r.Encoder.encode,r.decode=r.Decoder.decode,r.leveldb={decode:r.Decoder.decodeAll,encode:r.Encoder.encode,buffer:!0,name:"cbor"}})(Ja);const ao=Oc(Ja);function ht(...r){const e=new Uint8Array(r.reduce((n,i)=>n+i.byteLength,0));let t=0;for(const n of r)e.set(new Uint8Array(n),t),t+=n.byteLength;return e.buffer}function rt(r){return[...new Uint8Array(r)].map(e=>e.toString(16).padStart(2,"0")).join("")}const ku=new RegExp(/^[0-9a-fA-F]+$/);function Bt(r){if(!ku.test(r))throw new Error("Invalid hexadecimal string.");const e=[...r].reduce((t,n,i)=>(t[i/2|0]=(t[i/2|0]||"")+n,t),[]).map(t=>Number.parseInt(t,16));return new Uint8Array(e).buffer}function oo(r,e){if(r.byteLength!==e.byteLength)return r.byteLength-e.byteLength;const t=new Uint8Array(r),n=new Uint8Array(e);for(let i=0;i<t.length;i++)if(t[i]!==n[i])return t[i]-n[i];return 0}function Qn(r,e){return oo(r,e)===0}function Ur(r){return new DataView(r.buffer,r.byteOffset,r.byteLength).buffer}function ts(r){return r instanceof Uint8Array?Ur(r):r instanceof ArrayBuffer?r:Array.isArray(r)?Ur(new Uint8Array(r)):"buffer"in r?ts(r.buffer):Ur(new Uint8Array(r))}function lt(r){return Ur(Yi.create().update(new Uint8Array(r)).digest())}function ln(r){if(r instanceof ao.Tagged)return ln(r.value);if(typeof r=="string")return co(r);if(typeof r=="number")return lt(Ue(r));if(r instanceof ArrayBuffer||ArrayBuffer.isView(r))return lt(r);if(Array.isArray(r)){const e=r.map(ln);return lt(ht(...e))}else{if(r&&typeof r=="object"&&r._isPrincipal)return lt(r.toUint8Array());if(typeof r=="object"&&r!==null&&typeof r.toHash=="function")return ln(r.toHash());if(typeof r=="object")return Dn(r);if(typeof r=="bigint")return lt(Ue(r))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${r}`),{value:r})}const co=r=>{const e=new TextEncoder().encode(r);return lt(e)};function kr(r){return Dn(r)}function Dn(r){const n=Object.entries(r).filter(([,f])=>f!==void 0).map(([f,u])=>{const d=co(f),g=ln(u);return[d,g]}).sort(([f],[u])=>oo(f,u)),i=ht(...n.map(f=>ht(...f)));return lt(i)}var Cu=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const $u=new TextEncoder().encode(`
ic-request`);class rs{getPrincipal(){return this._principal||(this._principal=ve.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:t}=e,n=Cu(e,["body"]),i=await kr(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(ht($u,i))}})}}class Li{getPrincipal(){return ve.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var et={},vr={},Se={};Object.defineProperty(Se,"__esModule",{value:!0});const qu=9007199254740992;function Nt(r,...e){const t=new Uint8Array(r.byteLength+e.reduce((i,o)=>i+o.byteLength,0));t.set(new Uint8Array(r),0);let n=r.byteLength;for(const i of e)t.set(new Uint8Array(i),n),n+=i.byteLength;return t.buffer}function pt(r,e,t){t=t.replace(/[^0-9a-fA-F]/g,"");const n=2**(e-24);t=t.slice(-n*2).padStart(n*2,"0");const i=[(r<<5)+e].concat(t.match(/../g).map(o=>parseInt(o,16)));return new Uint8Array(i).buffer}function ei(r,e){if(e<24)return new Uint8Array([(r<<5)+e]).buffer;{const t=e<=255?24:e<=65535?25:e<=4294967295?26:27;return pt(r,t,e.toString(16))}}function uo(r){const e=[];for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);n<128?e.push(n):n<2048?e.push(192|n>>6,128|n&63):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|n&63):(t++,n=(n&1023)<<10|r.charCodeAt(t)&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return Nt(new Uint8Array(ei(3,r.length)),new Uint8Array(e))}function Gu(r,e){if(r==14277111)return Nt(new Uint8Array([217,217,247]),e);if(r<24)return Nt(new Uint8Array([192+r]),e);{const t=r<=255?24:r<=65535?25:r<=4294967295?26:27,n=2**(t-24),i=r.toString(16).slice(-n*2).padStart(n*2,"0"),o=[192+t].concat(i.match(/../g).map(f=>parseInt(f,16)));return new Uint8Array(o).buffer}}Se.tagged=Gu;function Vr(r){return new Uint8Array(r).buffer}Se.raw=Vr;function ns(r){if(isNaN(r))throw new RangeError("Invalid number.");r=Math.min(Math.max(0,r),23);const e=[0+r];return new Uint8Array(e).buffer}Se.uSmall=ns;function fo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),255),r=r.toString(16),pt(0,24,r)}Se.u8=fo;function lo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),65535),r=r.toString(16),pt(0,25,r)}Se.u16=lo;function ho(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),4294967295),r=r.toString(16),pt(0,26,r)}Se.u32=ho;function is(r,e){if(typeof r=="string"&&e==16){if(r.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return pt(0,27,r)}if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,r),qu),r=r.toString(16),pt(0,27,r)}Se.u64=is;function po(r){if(isNaN(r))throw new RangeError("Invalid number.");if(r===0)return ns(0);r=Math.min(Math.max(0,-r),24)-1;const e=[32+r];return new Uint8Array(e).buffer}Se.iSmall=po;function yo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),255),r=r.toString(16),pt(1,24,r)}Se.i8=yo;function wo(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),65535),r=r.toString(16),pt(1,25,r)}Se.i16=wo;function go(r,e){if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),4294967295),r=r.toString(16),pt(1,26,r)}Se.i32=go;function bo(r,e){if(typeof r=="string"&&e==16){if(r.startsWith("-")?r=r.slice(1):r="0",r.match(/[^0-9a-fA-F]/)||r.length>16)throw new RangeError("Invalid number.");let t=!1,n=r.split("").reduceRight((i,o)=>{if(t)return o+i;let f=parseInt(o,16)-1;return f>=0?(t=!0,f.toString(16)+i):"f"+i},"");return t?pt(1,27,n):is(0)}if(r=parseInt(""+r,e),isNaN(r))throw new RangeError("Invalid number.");return r=Math.min(Math.max(0,-r-1),9007199254740992),r=r.toString(16),pt(1,27,r)}Se.i64=bo;function Hu(r){return r>=0?r<24?ns(r):r<=255?fo(r):r<=65535?lo(r):r<=4294967295?ho(r):is(r):r>=-24?po(r):r>=-255?yo(r):r>=-65535?wo(r):r>=-4294967295?go(r):bo(r)}Se.number=Hu;function Vu(r){return Nt(ei(2,r.byteLength),r)}Se.bytes=Vu;function Ku(r){return uo(r)}Se.string=Ku;function ju(r){return Nt(ei(4,r.length),...r)}Se.array=ju;function zu(r,e=!1){r instanceof Map||(r=new Map(Object.entries(r)));let t=Array.from(r.entries());return e&&(t=t.sort(([n],[i])=>n.localeCompare(i))),Nt(ei(5,r.size),...t.map(([n,i])=>Nt(uo(n),i)))}Se.map=zu;function Yu(r){const e=new Float32Array([r]);return Nt(new Uint8Array([250]),new Uint8Array(e.buffer))}Se.singleFloat=Yu;function Wu(r){const e=new Float64Array([r]);return Nt(new Uint8Array([251]),new Uint8Array(e.buffer))}Se.doubleFloat=Wu;function Zu(r){return r?mo():_o()}Se.bool=Zu;function mo(){return Vr(new Uint8Array([245]))}Se.true_=mo;function _o(){return Vr(new Uint8Array([244]))}Se.false_=_o;function Xu(){return Vr(new Uint8Array([246]))}Se.null_=Xu;function Ju(){return Vr(new Uint8Array([247]))}Se.undefined_=Ju;var Qu=br&&br.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e};Object.defineProperty(vr,"__esModule",{value:!0});const ct=Qu(Se),ef=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class xo{constructor(e,t=!1){this._serializer=e,this._stable=t,this.name="jsonDefault",this.priority=-100}match(e){return["undefined","boolean","number","string","object"].indexOf(typeof e)!=-1}encode(e){switch(typeof e){case"undefined":return ct.undefined_();case"boolean":return ct.bool(e);case"number":return Math.floor(e)===e?ct.number(e):ct.doubleFloat(e);case"string":return ct.string(e);case"object":if(e===null)return ct.null_();if(Array.isArray(e))return ct.array(e.map(t=>this._serializer.serializeValue(t)));if(ef.find(t=>e instanceof t))return ct.bytes(e.buffer);if(Object.getOwnPropertyNames(e).indexOf("toJSON")!==-1)return this.encode(e.toJSON());if(e instanceof Map){const t=new Map;for(const[n,i]of e.entries())t.set(n,this._serializer.serializeValue(i));return ct.map(t,this._stable)}else{const t=new Map;for(const[n,i]of Object.entries(e))t.set(n,this._serializer.serializeValue(i));return ct.map(t,this._stable)}default:throw new Error("Invalid value.")}}}vr.JsonDefaultCborEncoder=xo;class Eo{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return typeof e=="object"&&typeof e.toCBOR=="function"}encode(e){return e.toCBOR()}}vr.ToCborEncoder=Eo;class vo{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const t=new this;return t.addEncoder(new xo(t,e)),t.addEncoder(new Eo),t}removeEncoder(e){for(const t of this._encoders.values())t.name==e&&this._encoders.delete(t)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let t=null;for(const n of this._encoders)(!t||n.priority>t.priority)&&n.match(e)&&(t=n);if(t===null)throw new Error("Could not find an encoder for value.");return t}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}vr.CborSerializer=vo;class tf extends vo{serialize(e){return ct.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}}vr.SelfDescribeCborSerializer=tf;(function(r){function e(i){for(var o in i)r.hasOwnProperty(o)||(r[o]=i[o])}var t=br&&br.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var f in i)Object.hasOwnProperty.call(i,f)&&(o[f]=i[f]);return o.default=i,o};Object.defineProperty(r,"__esModule",{value:!0}),e(vr);const n=t(Se);r.value=n})(et);class rf{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return et.value.bytes(e.toUint8Array())}}class nf{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return et.value.bytes(new Uint8Array(e))}}class sf{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?et.value.tagged(2,et.value.bytes(Bt(e.toString(16)))):et.value.tagged(3,et.value.bytes(Bt((BigInt("-1")*e).toString(16))))}}const ti=et.SelfDescribeCborSerializer.withDefaultEncoders(!0);ti.addEncoder(new rf);ti.addEncoder(new nf);ti.addEncoder(new sf);var Fi;(function(r){r[r.Uint64LittleEndian=71]="Uint64LittleEndian",r[r.Semantic=55799]="Semantic"})(Fi||(Fi={}));function ui(r){return ti.serialize(r)}function Is(r){const e=r.byteLength;let t=BigInt(0);for(let n=0;n<e;n++)t=t*BigInt(256)+BigInt(r[n]);return t}class af extends ao.Decoder{createByteString(e){return ht(...e)}createByteStringFromHeap(e,t){return e===t?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,t))}}function At(r){const e=new Uint8Array(r),t=new af({size:e.byteLength,tags:{2:n=>Is(n),3:n=>-Is(n),[Fi.Semantic]:n=>n}});try{return t.decodeFirst(e)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${rt(e)}`)}}const Xr=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const r=new Uint32Array(1);return window.crypto.getRandomValues(r),r[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const r=new Uint32Array(1);return crypto.getRandomValues(r),r[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var Mi;(function(r){r.Call="call"})(Mi||(Mi={}));function Di(){const r=new ArrayBuffer(16),e=new DataView(r),t=Xr(),n=Xr(),i=Xr(),o=Xr();return e.setUint32(0,t),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,o),r}const of=BigInt(1e6),cf=60*1e3;class Jr{constructor(e){const o=BigInt(Math.floor(Date.now()+e-cf))*of/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=o}toCBOR(){return et.value.u64(this._value.toString(16),16)}toHash(){return Ue(this._value)}}function Ss(r=Di){return async e=>{const t=e.request.headers;e.request.headers=t,e.endpoint==="call"&&(e.body.nonce=r())}}function dn(r){const e=[];return r.forEach((t,n)=>{e.push([n,t])}),e}class As extends dt{constructor(e,t){super(e),this.response=t,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ss=BigInt(0),as=BigInt(1),uf=BigInt(2);function ri(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function zt(r){if(!ri(r))throw new Error("Uint8Array expected")}function Rr(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const ff=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function sr(r){zt(r);let e="";for(let t=0;t<r.length;t++)e+=ff[r[t]];return e}function Io(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?ss:BigInt("0x"+r)}const vt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ts(r){if(r>=vt._0&&r<=vt._9)return r-vt._0;if(r>=vt.A&&r<=vt.F)return r-(vt.A-10);if(r>=vt.a&&r<=vt.f)return r-(vt.a-10)}function So(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let i=0,o=0;i<t;i++,o+=2){const f=Ts(r.charCodeAt(o)),u=Ts(r.charCodeAt(o+1));if(f===void 0||u===void 0){const d=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}n[i]=f*16+u}return n}function ft(r){return Io(sr(r))}function Pr(r){return zt(r),Io(sr(Uint8Array.from(r).reverse()))}function Ve(r,e){return So(r.toString(16).padStart(e*2,"0"))}function kn(r,e){return Ve(r,e).reverse()}function Xe(r,e,t){let n;if(typeof e=="string")try{n=So(e)}catch(o){throw new Error(r+" must be hex string or Uint8Array, cause: "+o)}else if(ri(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const i=n.length;if(typeof t=="number"&&i!==t)throw new Error(r+" of length "+t+" expected, got "+i);return n}function Fe(...r){let e=0;for(let n=0;n<r.length;n++){const i=r[n];zt(i),e+=i.length}const t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){const o=r[n];t.set(o,i),i+=o.length}return t}function os(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const fi=r=>typeof r=="bigint"&&ss<=r;function Ao(r,e,t){return fi(r)&&fi(e)&&fi(t)&&e<=r&&r<t}function qt(r,e,t,n){if(!Ao(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function Lr(r){let e;for(e=0;r>ss;r>>=as,e+=1);return e}function lf(r,e){return r>>BigInt(e)&as}const hn=r=>(uf<<BigInt(r-1))-as,df={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||ri(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Kr(r,e,t={}){const n=(i,o,f)=>{const u=df[o];if(typeof u!="function")throw new Error("invalid validator function");const d=r[i];if(!(f&&d===void 0)&&!u(d,r))throw new Error("param "+String(i)+" is invalid. Expected "+o+", got "+d)};for(const[i,o]of Object.entries(e))n(i,o,!1);for(const[i,o]of Object.entries(t))n(i,o,!0);return r}const Bs=()=>{throw new Error("not implemented")};function Cr(r){const e=new WeakMap;return(t,...n)=>{const i=e.get(t);if(i!==void 0)return i;const o=r(t,...n);return e.set(t,o),o}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ge=BigInt(0),Be=BigInt(1),Gt=BigInt(2),hf=BigInt(3),ki=BigInt(4),Ns=BigInt(5),Os=BigInt(8);function Oe(r,e){const t=r%e;return t>=Ge?t:e+t}function pf(r,e,t){if(e<Ge)throw new Error("invalid exponent, negatives unsupported");if(t<=Ge)throw new Error("invalid modulus");if(t===Be)return Ge;let n=Be;for(;e>Ge;)e&Be&&(n=n*r%t),r=r*r%t,e>>=Be;return n}function wt(r,e,t){let n=r;for(;e-- >Ge;)n*=n,n%=t;return n}function Us(r,e){if(r===Ge)throw new Error("invert: expected non-zero number");if(e<=Ge)throw new Error("invert: expected positive modulus, got "+e);let t=Oe(r,e),n=e,i=Ge,o=Be;for(;t!==Ge;){const u=n/t,d=n%t,g=i-o*u;n=t,t=d,i=o,o=g}if(n!==Be)throw new Error("invert: does not exist");return Oe(i,e)}function yf(r){const e=(r-Be)/Gt;let t,n,i;for(t=r-Be,n=0;t%Gt===Ge;t/=Gt,n++);for(i=Gt;i<r&&pf(i,e,r)!==r-Be;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const f=(r+Be)/ki;return function(d,g){const m=d.pow(g,f);if(!d.eql(d.sqr(m),g))throw new Error("Cannot find square root");return m}}const o=(t+Be)/Gt;return function(u,d){if(u.pow(d,e)===u.neg(u.ONE))throw new Error("Cannot find square root");let g=n,m=u.pow(u.mul(u.ONE,i),t),v=u.pow(d,o),B=u.pow(d,t);for(;!u.eql(B,u.ONE);){if(u.eql(B,u.ZERO))return u.ZERO;let S=1;for(let L=u.sqr(B);S<g&&!u.eql(L,u.ONE);S++)L=u.sqr(L);const h=u.pow(m,Be<<BigInt(g-S-1));m=u.sqr(h),v=u.mul(v,h),B=u.mul(B,m),g=S}return v}}function wf(r){if(r%ki===hf){const e=(r+Be)/ki;return function(n,i){const o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(r%Os===Ns){const e=(r-Ns)/Os;return function(n,i){const o=n.mul(i,Gt),f=n.pow(o,e),u=n.mul(i,f),d=n.mul(n.mul(u,Gt),f),g=n.mul(u,n.sub(d,n.ONE));if(!n.eql(n.sqr(g),i))throw new Error("Cannot find square root");return g}}return yf(r)}const gf=(r,e)=>(Oe(r,e)&Be)===Be,bf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function To(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=bf.reduce((n,i)=>(n[i]="function",n),e);return Kr(r,t)}function pn(r,e,t){if(t<Ge)throw new Error("invalid exponent, negatives unsupported");if(t===Ge)return r.ONE;if(t===Be)return e;let n=r.ONE,i=e;for(;t>Ge;)t&Be&&(n=r.mul(n,i)),i=r.sqr(i),t>>=Be;return n}function yn(r,e){const t=new Array(e.length),n=e.reduce((o,f,u)=>r.is0(f)?o:(t[u]=o,r.mul(o,f)),r.ONE),i=r.inv(n);return e.reduceRight((o,f,u)=>r.is0(f)?o:(t[u]=r.mul(o,t[u]),r.mul(o,f)),i),t}function mf(r){const e=(r-Be)/Gt;return(t,n)=>t.pow(n,e)}function Bo(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function jr(r,e,t=!1,n={}){if(r<=Ge)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:i,nByteLength:o}=Bo(r,e);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f;const u=Object.freeze({ORDER:r,isLE:t,BITS:i,BYTES:o,MASK:hn(i),ZERO:Ge,ONE:Be,create:d=>Oe(d,r),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return Ge<=d&&d<r},is0:d=>d===Ge,isOdd:d=>(d&Be)===Be,neg:d=>Oe(-d,r),eql:(d,g)=>d===g,sqr:d=>Oe(d*d,r),add:(d,g)=>Oe(d+g,r),sub:(d,g)=>Oe(d-g,r),mul:(d,g)=>Oe(d*g,r),pow:(d,g)=>pn(u,d,g),div:(d,g)=>Oe(d*Us(g,r),r),sqrN:d=>d*d,addN:(d,g)=>d+g,subN:(d,g)=>d-g,mulN:(d,g)=>d*g,inv:d=>Us(d,r),sqrt:n.sqrt||(d=>(f||(f=wf(r)),f(u,d))),invertBatch:d=>yn(u,d),cmov:(d,g,m)=>m?g:d,toBytes:d=>t?kn(d,o):Ve(d,o),fromBytes:d=>{if(d.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+d.length);return t?Pr(d):ft(d)}});return Object.freeze(u)}function No(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function Oo(r){const e=No(r);return e+Math.ceil(e/2)}function _f(r,e,t=!1){const n=r.length,i=No(e),o=Oo(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const f=t?Pr(r):ft(r),u=Oe(f,e-Be)+Be;return t?kn(u,i):Ve(u,i)}const xf=ft;function Dt(r,e){if($r(r),$r(e),r<0||r>=1<<8*e)throw new Error("invalid I2OSP input: "+r);const t=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)t[n]=r&255,r>>>=8;return new Uint8Array(t)}function Ef(r,e){const t=new Uint8Array(r.length);for(let n=0;n<r.length;n++)t[n]=r[n]^e[n];return t}function $r(r){if(!Number.isSafeInteger(r))throw new Error("number expected")}function vf(r,e,t,n){zt(r),zt(e),$r(t),e.length>255&&(e=n(Fe(os("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=n,f=Math.ceil(t/i);if(t>65535||f>255)throw new Error("expand_message_xmd: invalid lenInBytes");const u=Fe(e,Dt(e.length,1)),d=Dt(0,o),g=Dt(t,2),m=new Array(f),v=n(Fe(d,r,g,Dt(0,1),u));m[0]=n(Fe(v,Dt(1,1),u));for(let S=1;S<=f;S++){const h=[Ef(v,m[S-1]),Dt(S+1,1),u];m[S]=n(Fe(...h))}return Fe(...m).slice(0,t)}function If(r,e,t,n,i){if(zt(r),zt(e),$r(t),e.length>255){const o=Math.ceil(2*n/8);e=i.create({dkLen:o}).update(os("H2C-OVERSIZE-DST-")).update(e).digest()}if(t>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:t}).update(r).update(Dt(t,2)).update(e).update(Dt(e.length,1)).digest()}function Rs(r,e,t){Kr(t,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:o,hash:f,expand:u,DST:d}=t;zt(r),$r(e);const g=typeof d=="string"?os(d):d,m=n.toString(2).length,v=Math.ceil((m+i)/8),B=e*o*v;let S;if(u==="xmd")S=vf(r,g,B,f);else if(u==="xof")S=If(r,g,B,i,f);else if(u==="_internal_pass")S=r;else throw new Error('expand must be "xmd" or "xof"');const h=new Array(e);for(let L=0;L<e;L++){const U=new Array(o);for(let C=0;C<o;C++){const $=v*(C+L*o),k=S.subarray($,$+v);U[C]=Oe(xf(k),n)}h[L]=U}return h}function Uo(r,e){const t=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[o,f,u,d]=t.map(g=>g.reduce((m,v)=>r.add(r.mul(m,n),v)));return n=r.div(o,f),i=r.mul(i,r.div(u,d)),{x:n,y:i}}}function Ps(r,e,t){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const o=Rs(n,2,{...t,DST:t.DST,...i}),f=r.fromAffine(e(o[0])),u=r.fromAffine(e(o[1])),d=f.add(u).clearCofactor();return d.assertValidity(),d},encodeToCurve(n,i){const o=Rs(n,1,{...t,DST:t.encodeDST,...i}),f=r.fromAffine(e(o[0])).clearCofactor();return f.assertValidity(),f},mapToCurve(n){if(!Array.isArray(n))throw new Error("mapToCurve: expected array of bigints");for(const o of n)if(typeof o!="bigint")throw new Error("mapToCurve: expected array of bigints");const i=r.fromAffine(e(n)).clearCofactor();return i.assertValidity(),i}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ls=BigInt(0),Qr=BigInt(1);function li(r,e){const t=e.negate();return r?t:e}function Ro(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function di(r,e){Ro(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function Sf(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function Af(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const hi=new WeakMap,Po=new WeakMap;function pi(r){return Po.get(r)||1}function Lo(r,e){return{constTimeNegate:li,hasPrecomputes(t){return pi(t)!==1},unsafeLadder(t,n,i=r.ZERO){let o=t;for(;n>Ls;)n&Qr&&(i=i.add(o)),o=o.double(),n>>=Qr;return i},precomputeWindow(t,n){const{windows:i,windowSize:o}=di(n,e),f=[];let u=t,d=u;for(let g=0;g<i;g++){d=u,f.push(d);for(let m=1;m<o;m++)d=d.add(u),f.push(d);u=d.double()}return f},wNAF(t,n,i){const{windows:o,windowSize:f}=di(t,e);let u=r.ZERO,d=r.BASE;const g=BigInt(2**t-1),m=2**t,v=BigInt(t);for(let B=0;B<o;B++){const S=B*f;let h=Number(i&g);i>>=v,h>f&&(h-=m,i+=Qr);const L=S,U=S+Math.abs(h)-1,C=B%2!==0,$=h<0;h===0?d=d.add(li(C,n[L])):u=u.add(li($,n[U]))}return{p:u,f:d}},wNAFUnsafe(t,n,i,o=r.ZERO){const{windows:f,windowSize:u}=di(t,e),d=BigInt(2**t-1),g=2**t,m=BigInt(t);for(let v=0;v<f;v++){const B=v*u;if(i===Ls)break;let S=Number(i&d);if(i>>=m,S>u&&(S-=g,i+=Qr),S===0)continue;let h=n[B+Math.abs(S)-1];S<0&&(h=h.negate()),o=o.add(h)}return o},getPrecomputes(t,n,i){let o=hi.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&hi.set(n,i(o))),o},wNAFCached(t,n,i){const o=pi(t);return this.wNAF(o,this.getPrecomputes(o,t,i),n)},wNAFCachedUnsafe(t,n,i,o){const f=pi(t);return f===1?this.unsafeLadder(t,n,o):this.wNAFUnsafe(f,this.getPrecomputes(f,t,i),n,o)},setWindowSize(t,n){Ro(n,e),Po.set(t,n),hi.delete(t)}}}function Fo(r,e,t,n){if(Sf(t,r),Af(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=r.ZERO,o=Lr(BigInt(t.length)),f=o>12?o-3:o>4?o-2:o?2:1,u=(1<<f)-1,d=new Array(u+1).fill(i),g=Math.floor((e.BITS-1)/f)*f;let m=i;for(let v=g;v>=0;v-=f){d.fill(i);for(let S=0;S<n.length;S++){const h=n[S],L=Number(h>>BigInt(v)&BigInt(u));d[L]=d[L].add(t[S])}let B=i;for(let S=d.length-1,h=i;S>0;S--)h=h.add(d[S]),B=B.add(h);if(m=m.add(B),v!==0)for(let S=0;S<f;S++)m=m.double()}return m}function Mo(r){return To(r.Fp),Kr(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Bo(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Tf(r){const e=Mo(r);Kr(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:i}=e;if(t){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const er=BigInt(0),Re=BigInt(1),Rt=BigInt(2),Cn=BigInt(3),Fs=BigInt(4);function Ms(r){const e=Tf(r),{Fp:t}=e,n=jr(e.n,e.nBitLength),i=e.toBytes||((L,U,C)=>{const $=U.toAffine();return Fe(Uint8Array.from([4]),t.toBytes($.x),t.toBytes($.y))}),o=e.fromBytes||(L=>{const U=L.subarray(1),C=t.fromBytes(U.subarray(0,t.BYTES)),$=t.fromBytes(U.subarray(t.BYTES,2*t.BYTES));return{x:C,y:$}});function f(L){const{a:U,b:C}=e,$=t.sqr(L),k=t.mul($,L);return t.add(t.add(k,t.mul(L,U)),C)}if(!t.eql(t.sqr(e.Gy),f(e.Gx)))throw new Error("bad generator point: equation left != right");function u(L){return Ao(L,Re,e.n)}function d(L){const{allowedPrivateKeyLengths:U,nByteLength:C,wrapPrivateKey:$,n:k}=e;if(U&&typeof L!="bigint"){if(ri(L)&&(L=sr(L)),typeof L!="string"||!U.includes(L.length))throw new Error("invalid private key");L=L.padStart(C*2,"0")}let J;try{J=typeof L=="bigint"?L:ft(Xe("private key",L,C))}catch{throw new Error("invalid private key, expected hex or "+C+" bytes, got "+typeof L)}return $&&(J=Oe(J,k)),qt("private key",J,Re,k),J}function g(L){if(!(L instanceof B))throw new Error("ProjectivePoint expected")}const m=Cr((L,U)=>{const{px:C,py:$,pz:k}=L;if(t.eql(k,t.ONE))return{x:C,y:$};const J=L.is0();U==null&&(U=J?t.ONE:t.inv(k));const P=t.mul(C,U),H=t.mul($,U),q=t.mul(k,U);if(J)return{x:t.ZERO,y:t.ZERO};if(!t.eql(q,t.ONE))throw new Error("invZ was invalid");return{x:P,y:H}}),v=Cr(L=>{if(L.is0()){if(e.allowInfinityPoint&&!t.is0(L.py))return;throw new Error("bad point: ZERO")}const{x:U,y:C}=L.toAffine();if(!t.isValid(U)||!t.isValid(C))throw new Error("bad point: x or y not FE");const $=t.sqr(C),k=f(U);if(!t.eql($,k))throw new Error("bad point: equation left != right");if(!L.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class B{constructor(U,C,$){if(this.px=U,this.py=C,this.pz=$,U==null||!t.isValid(U))throw new Error("x required");if(C==null||!t.isValid(C))throw new Error("y required");if($==null||!t.isValid($))throw new Error("z required");Object.freeze(this)}static fromAffine(U){const{x:C,y:$}=U||{};if(!U||!t.isValid(C)||!t.isValid($))throw new Error("invalid affine point");if(U instanceof B)throw new Error("projective point not allowed");const k=J=>t.eql(J,t.ZERO);return k(C)&&k($)?B.ZERO:new B(C,$,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(U){const C=t.invertBatch(U.map($=>$.pz));return U.map(($,k)=>$.toAffine(C[k])).map(B.fromAffine)}static fromHex(U){const C=B.fromAffine(o(Xe("pointHex",U)));return C.assertValidity(),C}static fromPrivateKey(U){return B.BASE.multiply(d(U))}static msm(U,C){return Fo(B,n,U,C)}_setWindowSize(U){h.setWindowSize(this,U)}assertValidity(){v(this)}hasEvenY(){const{y:U}=this.toAffine();if(t.isOdd)return!t.isOdd(U);throw new Error("Field doesn't support isOdd")}equals(U){g(U);const{px:C,py:$,pz:k}=this,{px:J,py:P,pz:H}=U,q=t.eql(t.mul(C,H),t.mul(J,k)),j=t.eql(t.mul($,H),t.mul(P,k));return q&&j}negate(){return new B(this.px,t.neg(this.py),this.pz)}double(){const{a:U,b:C}=e,$=t.mul(C,Cn),{px:k,py:J,pz:P}=this;let H=t.ZERO,q=t.ZERO,j=t.ZERO,W=t.mul(k,k),V=t.mul(J,J),ce=t.mul(P,P),re=t.mul(k,J);return re=t.add(re,re),j=t.mul(k,P),j=t.add(j,j),H=t.mul(U,j),q=t.mul($,ce),q=t.add(H,q),H=t.sub(V,q),q=t.add(V,q),q=t.mul(H,q),H=t.mul(re,H),j=t.mul($,j),ce=t.mul(U,ce),re=t.sub(W,ce),re=t.mul(U,re),re=t.add(re,j),j=t.add(W,W),W=t.add(j,W),W=t.add(W,ce),W=t.mul(W,re),q=t.add(q,W),ce=t.mul(J,P),ce=t.add(ce,ce),W=t.mul(ce,re),H=t.sub(H,W),j=t.mul(ce,V),j=t.add(j,j),j=t.add(j,j),new B(H,q,j)}add(U){g(U);const{px:C,py:$,pz:k}=this,{px:J,py:P,pz:H}=U;let q=t.ZERO,j=t.ZERO,W=t.ZERO;const V=e.a,ce=t.mul(e.b,Cn);let re=t.mul(C,J),E=t.mul($,P),T=t.mul(k,H),D=t.add(C,$),M=t.add(J,P);D=t.mul(D,M),M=t.add(re,E),D=t.sub(D,M),M=t.add(C,k);let R=t.add(J,H);return M=t.mul(M,R),R=t.add(re,T),M=t.sub(M,R),R=t.add($,k),q=t.add(P,H),R=t.mul(R,q),q=t.add(E,T),R=t.sub(R,q),W=t.mul(V,M),q=t.mul(ce,T),W=t.add(q,W),q=t.sub(E,W),W=t.add(E,W),j=t.mul(q,W),E=t.add(re,re),E=t.add(E,re),T=t.mul(V,T),M=t.mul(ce,M),E=t.add(E,T),T=t.sub(re,T),T=t.mul(V,T),M=t.add(M,T),re=t.mul(E,M),j=t.add(j,re),re=t.mul(R,M),q=t.mul(D,q),q=t.sub(q,re),re=t.mul(D,E),W=t.mul(R,W),W=t.add(W,re),new B(q,j,W)}subtract(U){return this.add(U.negate())}is0(){return this.equals(B.ZERO)}wNAF(U){return h.wNAFCached(this,U,B.normalizeZ)}multiplyUnsafe(U){const{endo:C,n:$}=e;qt("scalar",U,er,$);const k=B.ZERO;if(U===er)return k;if(this.is0()||U===Re)return this;if(!C||h.hasPrecomputes(this))return h.wNAFCachedUnsafe(this,U,B.normalizeZ);let{k1neg:J,k1:P,k2neg:H,k2:q}=C.splitScalar(U),j=k,W=k,V=this;for(;P>er||q>er;)P&Re&&(j=j.add(V)),q&Re&&(W=W.add(V)),V=V.double(),P>>=Re,q>>=Re;return J&&(j=j.negate()),H&&(W=W.negate()),W=new B(t.mul(W.px,C.beta),W.py,W.pz),j.add(W)}multiply(U){const{endo:C,n:$}=e;qt("scalar",U,Re,$);let k,J;if(C){const{k1neg:P,k1:H,k2neg:q,k2:j}=C.splitScalar(U);let{p:W,f:V}=this.wNAF(H),{p:ce,f:re}=this.wNAF(j);W=h.constTimeNegate(P,W),ce=h.constTimeNegate(q,ce),ce=new B(t.mul(ce.px,C.beta),ce.py,ce.pz),k=W.add(ce),J=V.add(re)}else{const{p:P,f:H}=this.wNAF(U);k=P,J=H}return B.normalizeZ([k,J])[0]}multiplyAndAddUnsafe(U,C,$){const k=B.BASE,J=(H,q)=>q===er||q===Re||!H.equals(k)?H.multiplyUnsafe(q):H.multiply(q),P=J(this,C).add(J(U,$));return P.is0()?void 0:P}toAffine(U){return m(this,U)}isTorsionFree(){const{h:U,isTorsionFree:C}=e;if(U===Re)return!0;if(C)return C(B,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:U,clearCofactor:C}=e;return U===Re?this:C?C(B,this):this.multiplyUnsafe(e.h)}toRawBytes(U=!0){return Rr("isCompressed",U),this.assertValidity(),i(B,this,U)}toHex(U=!0){return Rr("isCompressed",U),sr(this.toRawBytes(U))}}B.BASE=new B(e.Gx,e.Gy,t.ONE),B.ZERO=new B(t.ZERO,t.ONE,t.ZERO);const S=e.nBitLength,h=Lo(B,e.endo?Math.ceil(S/2):S);return{CURVE:e,ProjectivePoint:B,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:u}}function Bf(r,e){const t=r.ORDER;let n=er;for(let h=t-Re;h%Rt===er;h/=Rt)n+=Re;const i=n,o=Rt<<i-Re-Re,f=o*Rt,u=(t-Re)/f,d=(u-Re)/Rt,g=f-Re,m=o,v=r.pow(e,u),B=r.pow(e,(u+Re)/Rt);let S=(h,L)=>{let U=v,C=r.pow(L,g),$=r.sqr(C);$=r.mul($,L);let k=r.mul(h,$);k=r.pow(k,d),k=r.mul(k,C),C=r.mul(k,L),$=r.mul(k,h);let J=r.mul($,C);k=r.pow(J,m);let P=r.eql(k,r.ONE);C=r.mul($,B),k=r.mul(J,U),$=r.cmov(C,$,P),J=r.cmov(k,J,P);for(let H=i;H>Re;H--){let q=H-Rt;q=Rt<<q-Re;let j=r.pow(J,q);const W=r.eql(j,r.ONE);C=r.mul($,U),U=r.mul(U,U),j=r.mul(J,U),$=r.cmov(C,$,W),J=r.cmov(j,J,W)}return{isValid:P,value:$}};if(r.ORDER%Fs===Cn){const h=(r.ORDER-Cn)/Fs,L=r.sqrt(r.neg(e));S=(U,C)=>{let $=r.sqr(C);const k=r.mul(U,C);$=r.mul($,k);let J=r.pow($,h);J=r.mul(J,k);const P=r.mul(J,L),H=r.mul(r.sqr(J),C),q=r.eql(H,U);let j=r.cmov(P,J,q);return{isValid:q,value:j}}}return S}function Do(r,e){if(To(r),!r.isValid(e.A)||!r.isValid(e.B)||!r.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const t=Bf(r,e.Z);if(!r.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,o,f,u,d,g,m,v;i=r.sqr(n),i=r.mul(i,e.Z),o=r.sqr(i),o=r.add(o,i),f=r.add(o,r.ONE),f=r.mul(f,e.B),u=r.cmov(e.Z,r.neg(o),!r.eql(o,r.ZERO)),u=r.mul(u,e.A),o=r.sqr(f),g=r.sqr(u),d=r.mul(g,e.A),o=r.add(o,d),o=r.mul(o,f),g=r.mul(g,u),d=r.mul(g,e.B),o=r.add(o,d),m=r.mul(i,f);const{isValid:B,value:S}=t(o,g);v=r.mul(i,n),v=r.mul(v,S),m=r.cmov(m,f,B),v=r.cmov(v,S,B);const h=r.isOdd(n)===r.isOdd(v);return v=r.cmov(r.neg(v),v,h),m=r.div(m,u),{x:m,y:v}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Nf=BigInt(0),en=BigInt(1),Ds=BigInt(2),wr=BigInt(3);function Of(r){const e=[];for(;r>en;r>>=en)(r&en)===Nf?e.unshift(0):(r&wr)===wr?(e.unshift(-1),r+=en):e.unshift(1);return e}function Uf(r){const{Fp:e,Fr:t,Fp2:n,Fp6:i,Fp12:o}=r.fields,f=r.params.xNegative,u=r.params.twistType,d=Ms({n:t.ORDER,...r.G1}),g=Object.assign(d,Ps(d.ProjectivePoint,r.G1.mapToCurve,{...r.htfDefaults,...r.G1.htfDefaults})),m=Ms({n:t.ORDER,...r.G2}),v=Object.assign(m,Ps(m.ProjectivePoint,r.G2.mapToCurve,{...r.htfDefaults,...r.G2.htfDefaults}));let B;if(u==="multiplicative")B=(K,p,X,te,ie,z)=>o.mul014(te,K,n.mul(p,ie),n.mul(X,z));else if(u==="divisive")B=(K,p,X,te,ie,z)=>o.mul034(te,n.mul(X,z),n.mul(p,ie),K);else throw new Error("bls: unknown twist type");const S=n.div(n.ONE,n.mul(n.ONE,Ds));function h(K,p,X,te){const ie=n.sqr(X),z=n.sqr(te),ee=n.mulByB(n.mul(z,wr)),y=n.mul(ee,wr),b=n.sub(n.sub(n.sqr(n.add(X,te)),z),ie),_=n.sub(ee,ie),N=n.mul(n.sqr(p),wr),A=n.neg(b);return K.push([_,N,A]),p=n.mul(n.mul(n.mul(n.sub(ie,y),p),X),S),X=n.sub(n.sqr(n.mul(n.add(ie,y),S)),n.mul(n.sqr(ee),wr)),te=n.mul(ie,b),{Rx:p,Ry:X,Rz:te}}function L(K,p,X,te,ie,z){const ee=n.sub(X,n.mul(z,te)),y=n.sub(p,n.mul(ie,te)),b=n.sub(n.mul(ee,ie),n.mul(y,z)),_=n.neg(ee),N=y;K.push([b,_,N]);const A=n.sqr(y),O=n.mul(A,y),c=n.mul(A,p),s=n.add(n.sub(O,n.mul(c,Ds)),n.mul(n.sqr(ee),te));return p=n.mul(y,s),X=n.sub(n.mul(n.sub(c,s),ee),n.mul(O,X)),te=n.mul(te,O),{Rx:p,Ry:X,Rz:te}}const U=Of(r.params.ateLoopSize),C=Cr(K=>{const p=K,{x:X,y:te}=p.toAffine(),ie=X,z=te,ee=n.neg(te);let y=ie,b=z,_=n.ONE;const N=[];for(const A of U){const O=[];({Rx:y,Ry:b,Rz:_}=h(O,y,b,_)),A&&({Rx:y,Ry:b,Rz:_}=L(O,y,b,_,ie,A===-1?ee:z)),N.push(O)}if(r.postPrecompute){const A=N[N.length-1];r.postPrecompute(y,b,_,ie,z,L.bind(null,A))}return N});function $(K,p=!1){let X=o.ONE;if(K.length){const te=K[0][0].length;for(let ie=0;ie<te;ie++){X=o.sqr(X);for(const[z,ee,y]of K)for(const[b,_,N]of z[ie])X=B(b,_,N,X,ee,y)}}return f&&(X=o.conjugate(X)),p?o.finalExponentiate(X):X}function k(K,p=!0){const X=[];g.ProjectivePoint.normalizeZ(K.map(({g1:te})=>te)),v.ProjectivePoint.normalizeZ(K.map(({g2:te})=>te));for(const{g1:te,g2:ie}of K){if(te.equals(g.ProjectivePoint.ZERO)||ie.equals(v.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");te.assertValidity(),ie.assertValidity();const z=te.toAffine();X.push([C(ie),z.x,z.y])}return $(X,p)}function J(K,p,X=!0){return k([{g1:K,g2:p}],X)}const P={randomPrivateKey:()=>{const K=Oo(t.ORDER);return _f(r.randomBytes(K),t.ORDER)},calcPairingPrecomputes:C},{ShortSignature:H}=r.G1,{Signature:q}=r.G2;function j(K){return K instanceof g.ProjectivePoint?K:g.ProjectivePoint.fromHex(K)}function W(K,p){return K instanceof g.ProjectivePoint?K:g.hashToCurve(Xe("point",K),p)}function V(K){return K instanceof v.ProjectivePoint?K:q.fromHex(K)}function ce(K,p){return K instanceof v.ProjectivePoint?K:v.hashToCurve(Xe("point",K),p)}function re(K){return g.ProjectivePoint.fromPrivateKey(K).toRawBytes(!0)}function E(K){return v.ProjectivePoint.fromPrivateKey(K).toRawBytes(!0)}function T(K,p,X){const te=ce(K,X);te.assertValidity();const ie=te.multiply(g.normPrivateKeyToScalar(p));return K instanceof v.ProjectivePoint?ie:q.toRawBytes(ie)}function D(K,p,X){const te=W(K,X);te.assertValidity();const ie=te.multiply(g.normPrivateKeyToScalar(p));return K instanceof g.ProjectivePoint?ie:H.toRawBytes(ie)}function M(K,p,X,te){const ie=j(X),z=ce(p,te),ee=g.ProjectivePoint.BASE,y=V(K),b=k([{g1:ie.negate(),g2:z},{g1:ee,g2:y}]);return o.eql(b,o.ONE)}function R(K,p,X,te){const ie=V(X),z=W(p,te),ee=v.ProjectivePoint.BASE,y=j(K),b=k([{g1:z,g2:ie},{g1:y,g2:ee.negate()}]);return o.eql(b,o.ONE)}function G(K){if(!Array.isArray(K)||K.length===0)throw new Error("expected non-empty array")}function Z(K){G(K);const X=K.map(j).reduce((te,ie)=>te.add(ie),g.ProjectivePoint.ZERO);return K[0]instanceof g.ProjectivePoint?(X.assertValidity(),X):X.toRawBytes(!0)}function ue(K){G(K);const X=K.map(V).reduce((te,ie)=>te.add(ie),v.ProjectivePoint.ZERO);return K[0]instanceof v.ProjectivePoint?(X.assertValidity(),X):q.toRawBytes(X)}function ne(K){G(K);const X=K.map(j).reduce((te,ie)=>te.add(ie),g.ProjectivePoint.ZERO);return K[0]instanceof g.ProjectivePoint?(X.assertValidity(),X):H.toRawBytes(X)}function oe(K,p,X,te){if(G(p),X.length!==p.length)throw new Error("amount of public keys and messages should be equal");const ie=V(K),z=p.map(_=>ce(_,te)),ee=X.map(j),y=new Map;for(let _=0;_<ee.length;_++){const N=ee[_],A=z[_];let O=y.get(A);O===void 0&&(O=[],y.set(A,O)),O.push(N)}const b=[];try{for(const[_,N]of y){const A=N.reduce((O,c)=>O.add(c));b.push({g1:A,g2:_})}return b.push({g1:g.ProjectivePoint.BASE.negate(),g2:ie}),o.eql(k(b),o.ONE)}catch{return!1}}return g.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:re,getPublicKeyForShortSignatures:E,sign:T,signShortSignature:D,verify:M,verifyBatch:oe,verifyShortSignature:R,aggregatePublicKeys:Z,aggregateSignatures:ue,aggregateShortSignatures:ne,millerLoopBatch:$,pairing:J,pairingBatch:k,G1:g,G2:v,Signature:q,ShortSignature:H,fields:{Fr:t,Fp:e,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:r.params.ateLoopSize,r:r.params.r,G1b:r.G1.b,G2b:r.G2.b},utils:P}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Rf=BigInt(0),gr=BigInt(1),It=BigInt(2),ks=BigInt(3);function yi(r,e,t,n,i=1,o){const f=BigInt(o===void 0?n:o),u=t**BigInt(n),d=[];for(let g=0;g<i;g++){const m=BigInt(g+1),v=[];for(let B=0,S=gr;B<n;B++){const h=(m*S-m)/f%u;v.push(r.pow(e,h)),S*=t}d.push(v)}return d}function Pf(r,e,t){const n=e.pow(t,(r.ORDER-gr)/ks),i=e.pow(t,(r.ORDER-gr)/It);function o(B,S){const h=e.mul(e.frobeniusMap(B,1),n),L=e.mul(e.frobeniusMap(S,1),i);return[h,L]}const f=e.pow(t,(r.ORDER**It-gr)/ks),u=e.pow(t,(r.ORDER**It-gr)/It);if(!e.eql(u,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function d(B,S){return[e.mul(B,f),e.neg(S)]}const g=B=>(S,h)=>{const L=h.toAffine(),U=B(L.x,L.y);return S.fromAffine({x:U[0],y:U[1]})},m=g(o),v=g(d);return{psi:o,psi2:d,G2psi:m,G2psi2:v,PSI_X:n,PSI_Y:i,PSI2_X:f,PSI2_Y:u}}function Lf(r){const{ORDER:e}=r,t=jr(e),n=t.create(r.NONRESIDUE||BigInt(-1)),i=mf(e),o=t.div(t.ONE,It),f=yi(t,n,t.ORDER,2)[0],u=({c0:E,c1:T},{c0:D,c1:M})=>({c0:t.add(E,D),c1:t.add(T,M)}),d=({c0:E,c1:T},{c0:D,c1:M})=>({c0:t.sub(E,D),c1:t.sub(T,M)}),g=({c0:E,c1:T},D)=>{if(typeof D=="bigint")return{c0:t.mul(E,D),c1:t.mul(T,D)};const{c0:M,c1:R}=D;let G=t.mul(E,M),Z=t.mul(T,R);const ue=t.sub(G,Z),ne=t.sub(t.mul(t.add(E,T),t.add(M,R)),t.add(G,Z));return{c0:ue,c1:ne}},m=({c0:E,c1:T})=>{const D=t.add(E,T),M=t.sub(E,T),R=t.add(E,E);return{c0:t.mul(D,M),c1:t.mul(R,T)}},v=E=>{if(E.length!==2)throw new Error("invalid tuple");const T=E.map(D=>t.create(D));return{c0:T[0],c1:T[1]}},B=e*e,S=v(r.FP2_NONRESIDUE),h={ORDER:B,isLE:t.isLE,NONRESIDUE:S,BITS:Lr(B),BYTES:Math.ceil(Lr(B)/8),MASK:hn(Lr(B)),ZERO:{c0:t.ZERO,c1:t.ZERO},ONE:{c0:t.ONE,c1:t.ZERO},create:E=>E,isValid:({c0:E,c1:T})=>typeof E=="bigint"&&typeof T=="bigint",is0:({c0:E,c1:T})=>t.is0(E)&&t.is0(T),eql:({c0:E,c1:T},{c0:D,c1:M})=>t.eql(E,D)&&t.eql(T,M),neg:({c0:E,c1:T})=>({c0:t.neg(E),c1:t.neg(T)}),pow:(E,T)=>pn(h,E,T),invertBatch:E=>yn(h,E),add:u,sub:d,mul:g,sqr:m,addN:u,subN:d,mulN:g,sqrN:m,div:(E,T)=>h.mul(E,typeof T=="bigint"?t.inv(t.create(T)):h.inv(T)),inv:({c0:E,c1:T})=>{const D=t.inv(t.create(E*E+T*T));return{c0:t.mul(D,t.create(E)),c1:t.mul(D,t.create(-T))}},sqrt:E=>{if(r.Fp2sqrt)return r.Fp2sqrt(E);const{c0:T,c1:D}=E;if(t.is0(D))return t.eql(i(t,T),t.ONE)?h.create({c0:t.sqrt(T),c1:t.ZERO}):h.create({c0:t.ZERO,c1:t.sqrt(t.div(T,n))});const M=t.sqrt(t.sub(t.sqr(T),t.mul(t.sqr(D),n)));let R=t.mul(t.add(M,T),o);const G=i(t,R);!t.is0(G)&&!t.eql(G,t.ONE)&&(R=t.sub(R,M));const Z=t.sqrt(R),ue=h.create({c0:Z,c1:t.div(t.mul(D,o),Z)});if(!h.eql(h.sqr(ue),E))throw new Error("Cannot find square root");const ne=ue,oe=h.neg(ne),{re:K,im:p}=h.reim(ne),{re:X,im:te}=h.reim(oe);return p>te||p===te&&K>X?ne:oe},isOdd:E=>{const{re:T,im:D}=h.reim(E),M=T%It,R=T===Rf,G=D%It;return BigInt(M||R&&G)==gr},fromBytes(E){if(E.length!==h.BYTES)throw new Error("fromBytes invalid length="+E.length);return{c0:t.fromBytes(E.subarray(0,t.BYTES)),c1:t.fromBytes(E.subarray(t.BYTES))}},toBytes:({c0:E,c1:T})=>Fe(t.toBytes(E),t.toBytes(T)),cmov:({c0:E,c1:T},{c0:D,c1:M},R)=>({c0:t.cmov(E,D,R),c1:t.cmov(T,M,R)}),reim:({c0:E,c1:T})=>({re:E,im:T}),mulByNonresidue:({c0:E,c1:T})=>h.mul({c0:E,c1:T},S),mulByB:r.Fp2mulByB,fromBigTuple:v,frobeniusMap:({c0:E,c1:T},D)=>({c0:E,c1:t.mul(T,f[D%2])})},L=({c0:E,c1:T,c2:D},{c0:M,c1:R,c2:G})=>({c0:h.add(E,M),c1:h.add(T,R),c2:h.add(D,G)}),U=({c0:E,c1:T,c2:D},{c0:M,c1:R,c2:G})=>({c0:h.sub(E,M),c1:h.sub(T,R),c2:h.sub(D,G)}),C=({c0:E,c1:T,c2:D},M)=>{if(typeof M=="bigint")return{c0:h.mul(E,M),c1:h.mul(T,M),c2:h.mul(D,M)};const{c0:R,c1:G,c2:Z}=M,ue=h.mul(E,R),ne=h.mul(T,G),oe=h.mul(D,Z);return{c0:h.add(ue,h.mulByNonresidue(h.sub(h.mul(h.add(T,D),h.add(G,Z)),h.add(ne,oe)))),c1:h.add(h.sub(h.mul(h.add(E,T),h.add(R,G)),h.add(ue,ne)),h.mulByNonresidue(oe)),c2:h.sub(h.add(ne,h.mul(h.add(E,D),h.add(R,Z))),h.add(ue,oe))}},$=({c0:E,c1:T,c2:D})=>{let M=h.sqr(E),R=h.mul(h.mul(E,T),It),G=h.mul(h.mul(T,D),It),Z=h.sqr(D);return{c0:h.add(h.mulByNonresidue(G),M),c1:h.add(h.mulByNonresidue(Z),R),c2:h.sub(h.sub(h.add(h.add(R,h.sqr(h.add(h.sub(E,T),D))),G),M),Z)}},[k,J]=yi(h,S,t.ORDER,6,2,3),P={ORDER:h.ORDER,isLE:h.isLE,BITS:3*h.BITS,BYTES:3*h.BYTES,MASK:hn(3*h.BITS),ZERO:{c0:h.ZERO,c1:h.ZERO,c2:h.ZERO},ONE:{c0:h.ONE,c1:h.ZERO,c2:h.ZERO},create:E=>E,isValid:({c0:E,c1:T,c2:D})=>h.isValid(E)&&h.isValid(T)&&h.isValid(D),is0:({c0:E,c1:T,c2:D})=>h.is0(E)&&h.is0(T)&&h.is0(D),neg:({c0:E,c1:T,c2:D})=>({c0:h.neg(E),c1:h.neg(T),c2:h.neg(D)}),eql:({c0:E,c1:T,c2:D},{c0:M,c1:R,c2:G})=>h.eql(E,M)&&h.eql(T,R)&&h.eql(D,G),sqrt:Bs,div:(E,T)=>P.mul(E,typeof T=="bigint"?t.inv(t.create(T)):P.inv(T)),pow:(E,T)=>pn(P,E,T),invertBatch:E=>yn(P,E),add:L,sub:U,mul:C,sqr:$,addN:L,subN:U,mulN:C,sqrN:$,inv:({c0:E,c1:T,c2:D})=>{let M=h.sub(h.sqr(E),h.mulByNonresidue(h.mul(D,T))),R=h.sub(h.mulByNonresidue(h.sqr(D)),h.mul(E,T)),G=h.sub(h.sqr(T),h.mul(E,D)),Z=h.inv(h.add(h.mulByNonresidue(h.add(h.mul(D,R),h.mul(T,G))),h.mul(E,M)));return{c0:h.mul(Z,M),c1:h.mul(Z,R),c2:h.mul(Z,G)}},fromBytes:E=>{if(E.length!==P.BYTES)throw new Error("fromBytes invalid length="+E.length);return{c0:h.fromBytes(E.subarray(0,h.BYTES)),c1:h.fromBytes(E.subarray(h.BYTES,2*h.BYTES)),c2:h.fromBytes(E.subarray(2*h.BYTES))}},toBytes:({c0:E,c1:T,c2:D})=>Fe(h.toBytes(E),h.toBytes(T),h.toBytes(D)),cmov:({c0:E,c1:T,c2:D},{c0:M,c1:R,c2:G},Z)=>({c0:h.cmov(E,M,Z),c1:h.cmov(T,R,Z),c2:h.cmov(D,G,Z)}),fromBigSix:E=>{if(!Array.isArray(E)||E.length!==6)throw new Error("invalid Fp6 usage");return{c0:h.fromBigTuple(E.slice(0,2)),c1:h.fromBigTuple(E.slice(2,4)),c2:h.fromBigTuple(E.slice(4,6))}},frobeniusMap:({c0:E,c1:T,c2:D},M)=>({c0:h.frobeniusMap(E,M),c1:h.mul(h.frobeniusMap(T,M),k[M%6]),c2:h.mul(h.frobeniusMap(D,M),J[M%6])}),mulByFp2:({c0:E,c1:T,c2:D},M)=>({c0:h.mul(E,M),c1:h.mul(T,M),c2:h.mul(D,M)}),mulByNonresidue:({c0:E,c1:T,c2:D})=>({c0:h.mulByNonresidue(D),c1:E,c2:T}),mul1:({c0:E,c1:T,c2:D},M)=>({c0:h.mulByNonresidue(h.mul(D,M)),c1:h.mul(E,M),c2:h.mul(T,M)}),mul01({c0:E,c1:T,c2:D},M,R){let G=h.mul(E,M),Z=h.mul(T,R);return{c0:h.add(h.mulByNonresidue(h.sub(h.mul(h.add(T,D),R),Z)),G),c1:h.sub(h.sub(h.mul(h.add(M,R),h.add(E,T)),G),Z),c2:h.add(h.sub(h.mul(h.add(E,D),M),G),Z)}}},H=yi(h,S,t.ORDER,12,1,6)[0],q=({c0:E,c1:T},{c0:D,c1:M})=>({c0:P.add(E,D),c1:P.add(T,M)}),j=({c0:E,c1:T},{c0:D,c1:M})=>({c0:P.sub(E,D),c1:P.sub(T,M)}),W=({c0:E,c1:T},D)=>{if(typeof D=="bigint")return{c0:P.mul(E,D),c1:P.mul(T,D)};let{c0:M,c1:R}=D,G=P.mul(E,M),Z=P.mul(T,R);return{c0:P.add(G,P.mulByNonresidue(Z)),c1:P.sub(P.mul(P.add(E,T),P.add(M,R)),P.add(G,Z))}},V=({c0:E,c1:T})=>{let D=P.mul(E,T);return{c0:P.sub(P.sub(P.mul(P.add(P.mulByNonresidue(T),E),P.add(E,T)),D),P.mulByNonresidue(D)),c1:P.add(D,D)}};function ce(E,T){const D=h.sqr(E),M=h.sqr(T);return{first:h.add(h.mulByNonresidue(M),D),second:h.sub(h.sub(h.sqr(h.add(E,T)),D),M)}}const re={ORDER:h.ORDER,isLE:P.isLE,BITS:2*h.BITS,BYTES:2*h.BYTES,MASK:hn(2*h.BITS),ZERO:{c0:P.ZERO,c1:P.ZERO},ONE:{c0:P.ONE,c1:P.ZERO},create:E=>E,isValid:({c0:E,c1:T})=>P.isValid(E)&&P.isValid(T),is0:({c0:E,c1:T})=>P.is0(E)&&P.is0(T),neg:({c0:E,c1:T})=>({c0:P.neg(E),c1:P.neg(T)}),eql:({c0:E,c1:T},{c0:D,c1:M})=>P.eql(E,D)&&P.eql(T,M),sqrt:Bs,inv:({c0:E,c1:T})=>{let D=P.inv(P.sub(P.sqr(E),P.mulByNonresidue(P.sqr(T))));return{c0:P.mul(E,D),c1:P.neg(P.mul(T,D))}},div:(E,T)=>re.mul(E,typeof T=="bigint"?t.inv(t.create(T)):re.inv(T)),pow:(E,T)=>pn(re,E,T),invertBatch:E=>yn(re,E),add:q,sub:j,mul:W,sqr:V,addN:q,subN:j,mulN:W,sqrN:V,fromBytes:E=>{if(E.length!==re.BYTES)throw new Error("fromBytes invalid length="+E.length);return{c0:P.fromBytes(E.subarray(0,P.BYTES)),c1:P.fromBytes(E.subarray(P.BYTES))}},toBytes:({c0:E,c1:T})=>Fe(P.toBytes(E),P.toBytes(T)),cmov:({c0:E,c1:T},{c0:D,c1:M},R)=>({c0:P.cmov(E,D,R),c1:P.cmov(T,M,R)}),fromBigTwelve:E=>({c0:P.fromBigSix(E.slice(0,6)),c1:P.fromBigSix(E.slice(6,12))}),frobeniusMap(E,T){const{c0:D,c1:M,c2:R}=P.frobeniusMap(E.c1,T),G=H[T%12];return{c0:P.frobeniusMap(E.c0,T),c1:P.create({c0:h.mul(D,G),c1:h.mul(M,G),c2:h.mul(R,G)})}},mulByFp2:({c0:E,c1:T},D)=>({c0:P.mulByFp2(E,D),c1:P.mulByFp2(T,D)}),conjugate:({c0:E,c1:T})=>({c0:E,c1:P.neg(T)}),mul014:({c0:E,c1:T},D,M,R)=>{let G=P.mul01(E,D,M),Z=P.mul1(T,R);return{c0:P.add(P.mulByNonresidue(Z),G),c1:P.sub(P.sub(P.mul01(P.add(T,E),D,h.add(M,R)),G),Z)}},mul034:({c0:E,c1:T},D,M,R)=>{const G=P.create({c0:h.mul(E.c0,D),c1:h.mul(E.c1,D),c2:h.mul(E.c2,D)}),Z=P.mul01(T,M,R),ue=P.mul01(P.add(E,T),h.add(D,M),R);return{c0:P.add(P.mulByNonresidue(Z),G),c1:P.sub(ue,P.add(G,Z))}},_cyclotomicSquare:r.Fp12cyclotomicSquare,_cyclotomicExp:r.Fp12cyclotomicExp,finalExponentiate:r.Fp12finalExponentiate};return{Fp:t,Fp2:h,Fp6:P,Fp4Square:ce,Fp12:re}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ze=BigInt(0),$n=BigInt(1),qe=BigInt(2),tn=BigInt(3),Fr=BigInt(4),kt=BigInt("0xd201000000010000"),Ff=Lr(kt),{Fp:ae,Fp2:fe,Fp6:Ci,Fp4Square:wi,Fp12:ge}=Lf({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[$n,$n],Fp2mulByB:({c0:r,c1:e})=>{const t=ae.mul(r,Fr),n=ae.mul(e,Fr);return{c0:ae.sub(t,n),c1:ae.add(t,n)}},Fp12cyclotomicSquare:({c0:r,c1:e})=>{const{c0:t,c1:n,c2:i}=r,{c0:o,c1:f,c2:u}=e,{first:d,second:g}=wi(t,f),{first:m,second:v}=wi(o,i),{first:B,second:S}=wi(n,u),h=fe.mulByNonresidue(S);return{c0:Ci.create({c0:fe.add(fe.mul(fe.sub(d,t),qe),d),c1:fe.add(fe.mul(fe.sub(m,n),qe),m),c2:fe.add(fe.mul(fe.sub(B,i),qe),B)}),c1:Ci.create({c0:fe.add(fe.mul(fe.add(h,o),qe),h),c1:fe.add(fe.mul(fe.add(g,f),qe),g),c2:fe.add(fe.mul(fe.add(v,u),qe),v)})}},Fp12cyclotomicExp(r,e){let t=ge.ONE;for(let n=Ff-1;n>=0;n--)t=ge._cyclotomicSquare(t),lf(e,n)&&(t=ge.mul(t,r));return t},Fp12finalExponentiate:r=>{const e=kt,t=ge.div(ge.frobeniusMap(r,6),r),n=ge.mul(ge.frobeniusMap(t,2),t),i=ge.conjugate(ge._cyclotomicExp(n,e)),o=ge.mul(ge.conjugate(ge._cyclotomicSquare(n)),i),f=ge.conjugate(ge._cyclotomicExp(o,e)),u=ge.conjugate(ge._cyclotomicExp(f,e)),d=ge.mul(ge.conjugate(ge._cyclotomicExp(u,e)),ge._cyclotomicSquare(i)),g=ge.conjugate(ge._cyclotomicExp(d,e)),m=ge.frobeniusMap(ge.mul(i,u),2),v=ge.frobeniusMap(ge.mul(f,n),3),B=ge.frobeniusMap(ge.mul(d,ge.conjugate(n)),1),S=ge.mul(ge.mul(g,ge.conjugate(o)),n);return ge.mul(ge.mul(ge.mul(m,v),B),S)}}),Cs=jr(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),Mf=Uo(fe,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(r=>r.map(e=>fe.fromBigTuple(e.map(BigInt))))),Df=Uo(ae,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(r=>r.map(e=>BigInt(e)))),kf=Do(fe,{A:fe.create({c0:ae.create(Ze),c1:ae.create(BigInt(240))}),B:fe.create({c0:ae.create(BigInt(1012)),c1:ae.create(BigInt(1012))}),Z:fe.create({c0:ae.create(BigInt(-2)),c1:ae.create(BigInt(-1))})}),Cf=Do(ae,{A:ae.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:ae.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:ae.create(BigInt(11))}),{G2psi:$s,G2psi2:$f}=Pf(ae,fe,fe.div(fe.ONE,fe.NONRESIDUE)),gi=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:ae.ORDER,m:2,k:128,expand:"xmd",hash:Yi}),qn=qr(ae.toBytes(Ze),{infinity:!0,compressed:!0});function rn(r){r=r.slice();const e=r[0]&224,t=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return r[0]&=31,{compressed:t,infinity:n,sort:i,value:r}}function qr(r,e){if(r[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(r[0]|=128),e.infinity&&(r[0]|=64),e.sort&&(r[0]|=32),r}function qs(r){r.assertValidity();const e=r.equals(nt.G1.ProjectivePoint.ZERO),{x:t,y:n}=r.toAffine();if(e)return qn.slice();const i=ae.ORDER,o=!!(n*qe/i);return qr(Ve(t,ae.BYTES),{compressed:!0,sort:o})}function Gs(r){r.assertValidity();const e=ae.BYTES;if(r.equals(nt.G2.ProjectivePoint.ZERO))return Fe(qn,Ve(Ze,e));const{x:t,y:n}=r.toAffine(),{re:i,im:o}=fe.reim(t),{re:f,im:u}=fe.reim(n),g=!!((u>Ze?u*qe:f*qe)/ae.ORDER&$n),m=i;return Fe(qr(Ve(o,e),{sort:g,compressed:!0}),Ve(m,e))}const nt=Uf({fields:{Fp:ae,Fp2:fe,Fp6:Ci,Fp12:ge,Fr:Cs},G1:{Fp:ae,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:ae.ZERO,b:Fr,htfDefaults:{...gi,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(r,e)=>{const t=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new r(ae.mul(e.px,t),e.py,e.pz);return e.multiplyUnsafe(kt).negate().multiplyUnsafe(kt).equals(n)},clearCofactor:(r,e)=>e.multiplyUnsafe(kt).add(e),mapToCurve:r=>{const{x:e,y:t}=Cf(ae.create(r[0]));return Df(e,t)},fromBytes:r=>{const{compressed:e,infinity:t,sort:n,value:i}=rn(r);if(i.length===48&&e){const o=ae.ORDER,f=ft(i),u=ae.create(f&ae.MASK);if(t){if(u!==Ze)throw new Error("G1: non-empty compressed point at infinity");return{x:Ze,y:Ze}}const d=ae.add(ae.pow(u,tn),ae.create(nt.params.G1b));let g=ae.sqrt(d);if(!g)throw new Error("invalid compressed G1 point");return g*qe/o!==BigInt(n)&&(g=ae.neg(g)),{x:ae.create(u),y:ae.create(g)}}else if(i.length===96&&!e){const o=ft(i.subarray(0,ae.BYTES)),f=ft(i.subarray(ae.BYTES));if(t){if(o!==Ze||f!==Ze)throw new Error("G1: non-empty point at infinity");return nt.G1.ProjectivePoint.ZERO.toAffine()}return{x:ae.create(o),y:ae.create(f)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(r,e,t)=>{const n=e.equals(r.ZERO),{x:i,y:o}=e.toAffine();if(t){if(n)return qn.slice();const f=ae.ORDER,u=!!(o*qe/f);return qr(Ve(i,ae.BYTES),{compressed:!0,sort:u})}else return n?Fe(new Uint8Array([64]),new Uint8Array(2*ae.BYTES-1)):Fe(Ve(i,ae.BYTES),Ve(o,ae.BYTES))},ShortSignature:{fromHex(r){const{infinity:e,sort:t,value:n}=rn(Xe("signatureHex",r,48)),i=ae.ORDER,o=ft(n);if(e)return nt.G1.ProjectivePoint.ZERO;const f=ae.create(o&ae.MASK),u=ae.add(ae.pow(f,tn),ae.create(nt.params.G1b));let d=ae.sqrt(u);if(!d)throw new Error("invalid compressed G1 point");const g=BigInt(t);d*qe/i!==g&&(d=ae.neg(d));const m=nt.G1.ProjectivePoint.fromAffine({x:f,y:d});return m.assertValidity(),m},toRawBytes(r){return qs(r)},toHex(r){return sr(qs(r))}}},G2:{Fp:fe,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:fe.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:fe.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:fe.ZERO,b:fe.fromBigTuple([Fr,Fr]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...gi},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:r=>{const{x:e,y:t}=kf(fe.fromBigTuple(r));return Mf(e,t)},isTorsionFree:(r,e)=>e.multiplyUnsafe(kt).negate().equals($s(r,e)),clearCofactor:(r,e)=>{const t=kt;let n=e.multiplyUnsafe(t).negate(),i=$s(r,e),o=e.double();return o=$f(r,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(t).negate(),o=o.add(i),o=o.subtract(n),o.subtract(e)},fromBytes:r=>{const{compressed:e,infinity:t,sort:n,value:i}=rn(r);if(!e&&!t&&n||!e&&t&&n||n&&t&&e)throw new Error("invalid encoding flag: "+(r[0]&224));const o=ae.BYTES,f=(u,d,g)=>ft(u.slice(d,g));if(i.length===96&&e){const u=nt.params.G2b,d=ae.ORDER;if(t){if(i.reduce((L,U)=>L!==0?U+1:U,0)>0)throw new Error("invalid compressed G2 point");return{x:fe.ZERO,y:fe.ZERO}}const g=f(i,0,o),m=f(i,o,2*o),v=fe.create({c0:ae.create(m),c1:ae.create(g)}),B=fe.add(fe.pow(v,tn),u);let S=fe.sqrt(B);const h=S.c1===Ze?S.c0*qe/d:S.c1*qe/d?$n:Ze;return S=n&&h>0?S:fe.neg(S),{x:v,y:S}}else if(i.length===192&&!e){if(t){if(i.reduce((v,B)=>v!==0?B+1:B,0)>0)throw new Error("invalid uncompressed G2 point");return{x:fe.ZERO,y:fe.ZERO}}const u=f(i,0,o),d=f(i,o,2*o),g=f(i,2*o,3*o),m=f(i,3*o,4*o);return{x:fe.fromBigTuple([d,u]),y:fe.fromBigTuple([m,g])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(r,e,t)=>{const{BYTES:n,ORDER:i}=ae,o=e.equals(r.ZERO),{x:f,y:u}=e.toAffine();if(t){if(o)return Fe(qn,Ve(Ze,n));const d=!!(u.c1===Ze?u.c0*qe/i:u.c1*qe/i);return Fe(qr(Ve(f.c1,n),{compressed:!0,sort:d}),Ve(f.c0,n))}else{if(o)return Fe(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:d,im:g}=fe.reim(f),{re:m,im:v}=fe.reim(u);return Fe(Ve(g,n),Ve(d,n),Ve(v,n),Ve(m,n))}},Signature:{fromHex(r){const{infinity:e,sort:t,value:n}=rn(Xe("signatureHex",r)),i=ae.ORDER,o=n.length/2;if(o!==48&&o!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const f=ft(n.slice(0,o)),u=ft(n.slice(o));if(e)return nt.G2.ProjectivePoint.ZERO;const d=ae.create(f&ae.MASK),g=ae.create(u),m=fe.create({c0:g,c1:d}),v=fe.add(fe.pow(m,tn),nt.params.G2b);let B=fe.sqrt(v);if(!B)throw new Error("Failed to find a square root");const{re:S,im:h}=fe.reim(B),L=BigInt(t),U=h>Ze&&h*qe/i!==L,C=h===Ze&&S*qe/i!==L;(U||C)&&(B=fe.neg(B));const $=nt.G2.ProjectivePoint.fromAffine({x:m,y:B});return $.assertValidity(),$},toRawBytes(r){return Gs(r)},toHex(r){return sr(Gs(r))}}},params:{ateLoopSize:kt,r:Cs.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:gi,hash:Yi,randomBytes:la});function qf(r,e,t){const n=typeof r=="string"?r:rt(r),i=typeof e=="string"?e:rt(e),o=typeof t=="string"?t:rt(t);return nt.verifyShortSignature(i,o,n)}const ko=r=>$e(new Er(r)),cs=r=>{const e=ko(r);return new Date(Number(e)/1e6)};class _t extends dt{constructor(e){super(`Invalid certificate: ${e}`)}}var tt;(function(r){r[r.Empty=0]="Empty",r[r.Fork=1]="Fork",r[r.Labeled=2]="Labeled",r[r.Leaf=3]="Leaf",r[r.Pruned=4]="Pruned"})(tt||(tt={}));function Gf(r,e){const t=new Uint8Array(r),n=new Uint8Array(e);for(let i=0;i<t.length;i++)if(t[i]>n[i])return!0;return!1}class Mr{constructor(e,t,n,i,o=5){this._rootKey=t,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=o,this.cert=At(new Uint8Array(e))}static async create(e){const t=Mr.createUnverified(e);return await t.verify(),t}static createUnverified(e){let t=e.blsVerify;return t||(t=qf),new Mr(e.certificate,e.rootKey,e.canisterId,t,e.maxAgeInMinutes)}lookup(e){return xr(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await wn(this.cert.tree),t=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=Vf(t),o=ht(Br("ic-state-root"),e);let f=!1;const u=$i(this.lookup(["time"]));if(!u)throw new _t("Certificate does not contain a time");const d=5*60*1e3,g=this._maxAgeInMinutes*60*1e3,m=Date.now(),v=m-g,B=m+d,S=cs(u);if(S.getTime()<v)throw new _t(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+S.toISOString()+" Current time: "+new Date(m).toISOString());if(S.getTime()>B)throw new _t("Certificate is signed more than 5 minutes in the future. Certificate time: "+S.toISOString()+" Current time: "+new Date(m).toISOString());try{f=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(o))}catch{f=!1}if(!f)throw new _t("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const t=await Mr.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(t.cert.delegation)throw new _t("Delegation certificates cannot be nested");if(await t.verify(),!Co({canisterId:this._canisterId,subnetId:ve.fromUint8Array(new Uint8Array(e.subnet_id)),tree:t.cert.tree}))throw new _t(`Canister ${this._canisterId} not in range of delegations for subnet 0x${rt(e.subnet_id)}`);const i=$i(t.lookup(["subnet",e.subnet_id,"public_key"]));if(!i)throw new Error(`Could not find subnet key for subnet 0x${rt(e.subnet_id)}`);return i}}const Ar=Bt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),Hf=96;function Vf(r){const e=Ar.byteLength+Hf;if(r.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const t=r.slice(0,Ar.byteLength);if(!Qn(t,Ar))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Ar}, but get ${t}`);return r.slice(Ar.byteLength)}function $i(r){if(r.status===Me.Found){if(r.value instanceof ArrayBuffer)return r.value;if(r.value instanceof Uint8Array)return r.value.buffer}}async function wn(r){switch(r[0]){case tt.Empty:return lt(Br("ic-hashtree-empty"));case tt.Pruned:return r[1];case tt.Leaf:return lt(ht(Br("ic-hashtree-leaf"),r[1]));case tt.Labeled:return lt(ht(Br("ic-hashtree-labeled"),r[1],await wn(r[2])));case tt.Fork:return lt(ht(Br("ic-hashtree-fork"),await wn(r[1]),await wn(r[2])));default:throw new Error("unreachable")}}function Br(r){const e=new Uint8Array([r.length]),t=new TextEncoder().encode(r);return ht(e,t)}var Me;(function(r){r.Unknown="unknown",r.Absent="absent",r.Found="found"})(Me||(Me={}));var St;(function(r){r.Less="less",r.Greater="greater"})(St||(St={}));function xr(r,e){if(r.length===0)switch(e[0]){case tt.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Me.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Me.Found,value:e[1].buffer}:{status:Me.Found,value:e[1]}}default:return{status:Me.Found,value:e}}const t=typeof r[0]=="string"?new TextEncoder().encode(r[0]):r[0],n=gn(t,e);switch(n.status){case Me.Found:return xr(r.slice(1),n.value);case St.Greater:case St.Less:return{status:Me.Absent};default:return n}}function qi(r){switch(r[0]){case tt.Empty:return[];case tt.Fork:return qi(r[1]).concat(qi(r[2]));default:return[r]}}function gn(r,e){switch(e[0]){case tt.Labeled:return Gf(r,e[1])?{status:St.Greater}:Qn(r,e[1])?{status:Me.Found,value:e[2]}:{status:St.Less};case tt.Fork:const t=gn(r,e[1]);switch(t.status){case St.Greater:{const n=gn(r,e[2]);return n.status===St.Less?{status:Me.Absent}:n}case Me.Unknown:{let n=gn(r,e[2]);return n.status===St.Less?{status:Me.Unknown}:n}default:return t}case tt.Pruned:return{status:Me.Unknown};default:return{status:Me.Absent}}}function Co(r){const{canisterId:e,subnetId:t,tree:n}=r,i=xr(["subnet",t.toUint8Array(),"canister_ranges"],n);if(i.status!==Me.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${t}`);return At(i.value).map(d=>[ve.fromUint8Array(d[0]),ve.fromUint8Array(d[1])]).some(d=>d[0].ltEq(e)&&d[1].gtEq(e))}class Kf{constructor(e,t,n){this.key=e,this.path=t,this.decodeStrategy=n}}const $o=async r=>{const{agent:e,paths:t}=r,n=ve.from(r.canisterId),i=[...new Set(t)],o=i.map(d=>Gi(d,n)),f=new Map,u=i.map((d,g)=>(async()=>{var m;try{const v=await e.readState(n,{paths:[o[g]]}),B=await Mr.create({certificate:v.certificate,rootKey:e.rootKey,canisterId:n}),S=(U,C)=>{if(C==="subnet"){const $=qo(v.certificate,n,e.rootKey);return{path:C,data:$}}else return{path:C,data:$i(U.lookup(Gi(C,n)))}},{path:h,data:L}=S(B,i[g]);if(!L)console.warn(`Expected to find result for path ${h}, but instead found nothing.`),typeof h=="string"?f.set(h,null):f.set(h.key,null);else switch(h){case"time":{f.set(h,cs(L));break}case"controllers":{f.set(h,zf(L));break}case"module_hash":{f.set(h,Hs(L));break}case"subnet":{f.set(h,L);break}case"candid":{f.set(h,new TextDecoder().decode(L));break}default:if(typeof h!="string"&&"key"in h&&"path"in h)switch(h.decodeStrategy){case"raw":f.set(h.key,L);break;case"leb128":{f.set(h.key,ko(L));break}case"cbor":{f.set(h.key,Go(L));break}case"hex":{f.set(h.key,Hs(L));break}case"utf-8":f.set(h.key,jf(L))}}}catch(v){if(!((m=v?.message)===null||m===void 0)&&m.includes("Invalid certificate"))throw new dt(v.message);typeof d!="string"&&"key"in d&&"path"in d?f.set(d.key,null):f.set(d,null),console.group(),console.warn(`Expected to find result for path ${d}, but instead found nothing.`),console.warn(v),console.groupEnd()}})());return await Promise.all(u),f},qo=(r,e,t)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=At(new Uint8Array(r)),i=n.tree;let o=n.delegation,f;if(o&&o.subnet_id?f=ve.fromUint8Array(new Uint8Array(o.subnet_id)):!o&&typeof t<"u"?(f=ve.selfAuthenticating(new Uint8Array(t)),o={subnet_id:f.toUint8Array(),certificate:new ArrayBuffer(0)}):(f=ve.selfAuthenticating(ve.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),o={subnet_id:f.toUint8Array(),certificate:new ArrayBuffer(0)}),!Co({canisterId:e,subnetId:f,tree:i}))throw new Error("Canister not in range");const d=xr(["subnet",o.subnet_id,"node"],i);if(d.status!==Me.Found)throw new Error("Node not found");if(d.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const g=qi(d.value),m=new Map;return g.forEach(v=>{const B=ve.from(new Uint8Array(v[1])).toText(),S=xr(["public_key"],v[2]);if(S.status!==Me.Found)throw new Error("Public key not found");const h=S.value;if(h.byteLength!==44)throw new Error("Invalid public key length");m.set(B,h)}),{subnetId:ve.fromUint8Array(new Uint8Array(o.subnet_id)).toText(),nodeKeys:m}},Gi=(r,e)=>{const t=new TextEncoder,n=o=>new DataView(t.encode(o).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(r){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in r&&"path"in r)if(typeof r.path=="string"||r.path instanceof ArrayBuffer){const o=r.path,f=typeof o=="string"?n(o):o;return[n("canister"),i,n("metadata"),f]}else return r.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${r} was formatted correctly.`)},Hs=r=>rt(r),Go=r=>At(r),jf=r=>new TextDecoder().decode(r),zf=r=>Go(r).map(t=>ve.fromUint8Array(new Uint8Array(t))),Yf=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:Kf,encodePath:Gi,fetchNodeKeys:qo,request:$o},Symbol.toStringTag,{value:"Module"})),nn=BigInt(2**32-1),Hi=BigInt(32);function Ho(r,e=!1){return e?{h:Number(r&nn),l:Number(r>>Hi&nn)}:{h:Number(r>>Hi&nn)|0,l:Number(r&nn)|0}}function Wf(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let i=0;i<r.length;i++){const{h:o,l:f}=Ho(r[i],e);[t[i],n[i]]=[o,f]}return[t,n]}const Zf=(r,e)=>BigInt(r>>>0)<<Hi|BigInt(e>>>0),Xf=(r,e,t)=>r>>>t,Jf=(r,e,t)=>r<<32-t|e>>>t,Qf=(r,e,t)=>r>>>t|e<<32-t,e0=(r,e,t)=>r<<32-t|e>>>t,t0=(r,e,t)=>r<<64-t|e>>>t-32,r0=(r,e,t)=>r>>>t-32|e<<64-t,n0=(r,e)=>e,i0=(r,e)=>r,s0=(r,e,t)=>r<<t|e>>>32-t,a0=(r,e,t)=>e<<t|r>>>32-t,o0=(r,e,t)=>e<<t-32|r>>>64-t,c0=(r,e,t)=>r<<t-32|e>>>64-t;function u0(r,e,t,n){const i=(e>>>0)+(n>>>0);return{h:r+t+(i/2**32|0)|0,l:i|0}}const f0=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),l0=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,d0=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),h0=(r,e,t,n,i)=>e+t+n+i+(r/2**32|0)|0,p0=(r,e,t,n,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),y0=(r,e,t,n,i,o)=>e+t+n+i+o+(r/2**32|0)|0,he={fromBig:Ho,split:Wf,toBig:Zf,shrSH:Xf,shrSL:Jf,rotrSH:Qf,rotrSL:e0,rotrBH:t0,rotrBL:r0,rotr32H:n0,rotr32L:i0,rotlSH:s0,rotlSL:a0,rotlBH:o0,rotlBL:c0,add:u0,add3L:f0,add3H:l0,add4L:d0,add4H:h0,add5H:y0,add5L:p0},[w0,g0]=he.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Pt=new Uint32Array(80),Lt=new Uint32Array(80);class b0 extends da{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:i,Ch:o,Cl:f,Dh:u,Dl:d,Eh:g,El:m,Fh:v,Fl:B,Gh:S,Gl:h,Hh:L,Hl:U}=this;return[e,t,n,i,o,f,u,d,g,m,v,B,S,h,L,U]}set(e,t,n,i,o,f,u,d,g,m,v,B,S,h,L,U){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=f|0,this.Dh=u|0,this.Dl=d|0,this.Eh=g|0,this.El=m|0,this.Fh=v|0,this.Fl=B|0,this.Gh=S|0,this.Gl=h|0,this.Hh=L|0,this.Hl=U|0}process(e,t){for(let k=0;k<16;k++,t+=4)Pt[k]=e.getUint32(t),Lt[k]=e.getUint32(t+=4);for(let k=16;k<80;k++){const J=Pt[k-15]|0,P=Lt[k-15]|0,H=he.rotrSH(J,P,1)^he.rotrSH(J,P,8)^he.shrSH(J,P,7),q=he.rotrSL(J,P,1)^he.rotrSL(J,P,8)^he.shrSL(J,P,7),j=Pt[k-2]|0,W=Lt[k-2]|0,V=he.rotrSH(j,W,19)^he.rotrBH(j,W,61)^he.shrSH(j,W,6),ce=he.rotrSL(j,W,19)^he.rotrBL(j,W,61)^he.shrSL(j,W,6),re=he.add4L(q,ce,Lt[k-7],Lt[k-16]),E=he.add4H(re,H,V,Pt[k-7],Pt[k-16]);Pt[k]=E|0,Lt[k]=re|0}let{Ah:n,Al:i,Bh:o,Bl:f,Ch:u,Cl:d,Dh:g,Dl:m,Eh:v,El:B,Fh:S,Fl:h,Gh:L,Gl:U,Hh:C,Hl:$}=this;for(let k=0;k<80;k++){const J=he.rotrSH(v,B,14)^he.rotrSH(v,B,18)^he.rotrBH(v,B,41),P=he.rotrSL(v,B,14)^he.rotrSL(v,B,18)^he.rotrBL(v,B,41),H=v&S^~v&L,q=B&h^~B&U,j=he.add5L($,P,q,g0[k],Lt[k]),W=he.add5H(j,C,J,H,w0[k],Pt[k]),V=j|0,ce=he.rotrSH(n,i,28)^he.rotrBH(n,i,34)^he.rotrBH(n,i,39),re=he.rotrSL(n,i,28)^he.rotrBL(n,i,34)^he.rotrBL(n,i,39),E=n&o^n&u^o&u,T=i&f^i&d^f&d;C=L|0,$=U|0,L=S|0,U=h|0,S=v|0,h=B|0,{h:v,l:B}=he.add(g|0,m|0,W|0,V|0),g=u|0,m=d|0,u=o|0,d=f|0,o=n|0,f=i|0;const D=he.add3L(V,re,T);n=he.add3H(D,W,ce,E),i=D|0}({h:n,l:i}=he.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:f}=he.add(this.Bh|0,this.Bl|0,o|0,f|0),{h:u,l:d}=he.add(this.Ch|0,this.Cl|0,u|0,d|0),{h:g,l:m}=he.add(this.Dh|0,this.Dl|0,g|0,m|0),{h:v,l:B}=he.add(this.Eh|0,this.El|0,v|0,B|0),{h:S,l:h}=he.add(this.Fh|0,this.Fl|0,S|0,h|0),{h:L,l:U}=he.add(this.Gh|0,this.Gl|0,L|0,U|0),{h:C,l:$}=he.add(this.Hh|0,this.Hl|0,C|0,$|0),this.set(n,i,o,f,u,d,g,m,v,B,S,h,L,U,C,$)}roundClean(){Pt.fill(0),Lt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const m0=zi(()=>new b0);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ot=BigInt(0),Qe=BigInt(1),sn=BigInt(2),_0=BigInt(8),x0={zip215:!0};function E0(r){const e=Mo(r);return Kr(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function v0(r){const e=E0(r),{Fp:t,n,prehash:i,hash:o,randomBytes:f,nByteLength:u,h:d}=e,g=sn<<BigInt(u*8)-Qe,m=t.create,v=jr(e.n,e.nBitLength),B=e.uvRatio||((M,R)=>{try{return{isValid:!0,value:t.sqrt(M*t.inv(R))}}catch{return{isValid:!1,value:ot}}}),S=e.adjustScalarBytes||(M=>M),h=e.domain||((M,R,G)=>{if(Rr("phflag",G),R.length||G)throw new Error("Contexts/pre-hash are not supported");return M});function L(M,R){qt("coordinate "+M,R,ot,g)}function U(M){if(!(M instanceof k))throw new Error("ExtendedPoint expected")}const C=Cr((M,R)=>{const{ex:G,ey:Z,ez:ue}=M,ne=M.is0();R==null&&(R=ne?_0:t.inv(ue));const oe=m(G*R),K=m(Z*R),p=m(ue*R);if(ne)return{x:ot,y:Qe};if(p!==Qe)throw new Error("invZ was invalid");return{x:oe,y:K}}),$=Cr(M=>{const{a:R,d:G}=e;if(M.is0())throw new Error("bad point: ZERO");const{ex:Z,ey:ue,ez:ne,et:oe}=M,K=m(Z*Z),p=m(ue*ue),X=m(ne*ne),te=m(X*X),ie=m(K*R),z=m(X*m(ie+p)),ee=m(te+m(G*m(K*p)));if(z!==ee)throw new Error("bad point: equation left != right (1)");const y=m(Z*ue),b=m(ne*oe);if(y!==b)throw new Error("bad point: equation left != right (2)");return!0});class k{constructor(R,G,Z,ue){this.ex=R,this.ey=G,this.ez=Z,this.et=ue,L("x",R),L("y",G),L("z",Z),L("t",ue),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(R){if(R instanceof k)throw new Error("extended point not allowed");const{x:G,y:Z}=R||{};return L("x",G),L("y",Z),new k(G,Z,Qe,m(G*Z))}static normalizeZ(R){const G=t.invertBatch(R.map(Z=>Z.ez));return R.map((Z,ue)=>Z.toAffine(G[ue])).map(k.fromAffine)}static msm(R,G){return Fo(k,v,R,G)}_setWindowSize(R){H.setWindowSize(this,R)}assertValidity(){$(this)}equals(R){U(R);const{ex:G,ey:Z,ez:ue}=this,{ex:ne,ey:oe,ez:K}=R,p=m(G*K),X=m(ne*ue),te=m(Z*K),ie=m(oe*ue);return p===X&&te===ie}is0(){return this.equals(k.ZERO)}negate(){return new k(m(-this.ex),this.ey,this.ez,m(-this.et))}double(){const{a:R}=e,{ex:G,ey:Z,ez:ue}=this,ne=m(G*G),oe=m(Z*Z),K=m(sn*m(ue*ue)),p=m(R*ne),X=G+Z,te=m(m(X*X)-ne-oe),ie=p+oe,z=ie-K,ee=p-oe,y=m(te*z),b=m(ie*ee),_=m(te*ee),N=m(z*ie);return new k(y,b,N,_)}add(R){U(R);const{a:G,d:Z}=e,{ex:ue,ey:ne,ez:oe,et:K}=this,{ex:p,ey:X,ez:te,et:ie}=R;if(G===BigInt(-1)){const w=m((ne-ue)*(X+p)),x=m((ne+ue)*(X-p)),F=m(x-w);if(F===ot)return this.double();const Y=m(oe*sn*ie),se=m(K*sn*te),le=se+Y,de=x+w,Q=se-Y,ye=m(le*F),Ne=m(de*Q),st=m(le*Q),Zt=m(F*de);return new k(ye,Ne,Zt,st)}const z=m(ue*p),ee=m(ne*X),y=m(K*Z*ie),b=m(oe*te),_=m((ue+ne)*(p+X)-z-ee),N=b-y,A=b+y,O=m(ee-G*z),c=m(_*N),s=m(A*O),a=m(_*O),l=m(N*A);return new k(c,s,l,a)}subtract(R){return this.add(R.negate())}wNAF(R){return H.wNAFCached(this,R,k.normalizeZ)}multiply(R){const G=R;qt("scalar",G,Qe,n);const{p:Z,f:ue}=this.wNAF(G);return k.normalizeZ([Z,ue])[0]}multiplyUnsafe(R,G=k.ZERO){const Z=R;return qt("scalar",Z,ot,n),Z===ot?P:this.is0()||Z===Qe?this:H.wNAFCachedUnsafe(this,Z,k.normalizeZ,G)}isSmallOrder(){return this.multiplyUnsafe(d).is0()}isTorsionFree(){return H.unsafeLadder(this,n).is0()}toAffine(R){return C(this,R)}clearCofactor(){const{h:R}=e;return R===Qe?this:this.multiplyUnsafe(R)}static fromHex(R,G=!1){const{d:Z,a:ue}=e,ne=t.BYTES;R=Xe("pointHex",R,ne),Rr("zip215",G);const oe=R.slice(),K=R[ne-1];oe[ne-1]=K&-129;const p=Pr(oe),X=G?g:t.ORDER;qt("pointHex.y",p,ot,X);const te=m(p*p),ie=m(te-Qe),z=m(Z*te-ue);let{isValid:ee,value:y}=B(ie,z);if(!ee)throw new Error("Point.fromHex: invalid y coordinate");const b=(y&Qe)===Qe,_=(K&128)!==0;if(!G&&y===ot&&_)throw new Error("Point.fromHex: x=0 and x_0=1");return _!==b&&(y=m(-y)),k.fromAffine({x:y,y:p})}static fromPrivateKey(R){return W(R).point}toRawBytes(){const{x:R,y:G}=this.toAffine(),Z=kn(G,t.BYTES);return Z[Z.length-1]|=R&Qe?128:0,Z}toHex(){return sr(this.toRawBytes())}}k.BASE=new k(e.Gx,e.Gy,Qe,m(e.Gx*e.Gy)),k.ZERO=new k(ot,Qe,Qe,ot);const{BASE:J,ZERO:P}=k,H=Lo(k,u*8);function q(M){return Oe(M,n)}function j(M){return q(Pr(M))}function W(M){const R=t.BYTES;M=Xe("private key",M,R);const G=Xe("hashed private key",o(M),2*R),Z=S(G.slice(0,R)),ue=G.slice(R,2*R),ne=j(Z),oe=J.multiply(ne),K=oe.toRawBytes();return{head:Z,prefix:ue,scalar:ne,point:oe,pointBytes:K}}function V(M){return W(M).pointBytes}function ce(M=new Uint8Array,...R){const G=Fe(...R);return j(o(h(G,Xe("context",M),!!i)))}function re(M,R,G={}){M=Xe("message",M),i&&(M=i(M));const{prefix:Z,scalar:ue,pointBytes:ne}=W(R),oe=ce(G.context,Z,M),K=J.multiply(oe).toRawBytes(),p=ce(G.context,K,ne,M),X=q(oe+p*ue);qt("signature.s",X,ot,n);const te=Fe(K,kn(X,t.BYTES));return Xe("result",te,t.BYTES*2)}const E=x0;function T(M,R,G,Z=E){const{context:ue,zip215:ne}=Z,oe=t.BYTES;M=Xe("signature",M,2*oe),R=Xe("message",R),G=Xe("publicKey",G,oe),ne!==void 0&&Rr("zip215",ne),i&&(R=i(R));const K=Pr(M.slice(oe,2*oe));let p,X,te;try{p=k.fromHex(G,ne),X=k.fromHex(M.slice(0,oe),ne),te=J.multiplyUnsafe(K)}catch{return!1}if(!ne&&p.isSmallOrder())return!1;const ie=ce(ue,X.toRawBytes(),p.toRawBytes(),R);return X.add(p.multiplyUnsafe(ie)).subtract(te).clearCofactor().equals(k.ZERO)}return J._setWindowSize(8),{CURVE:e,getPublicKey:V,sign:re,verify:T,ExtendedPoint:k,utils:{getExtendedPublicKey:W,randomPrivateKey:()=>f(t.BYTES),precompute(M=8,R=k.BASE){return R._setWindowSize(M),R.multiply(BigInt(3)),R}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const us=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Vs=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const I0=BigInt(1),Ks=BigInt(2);BigInt(3);const S0=BigInt(5),A0=BigInt(8);function T0(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),i=BigInt(80),o=us,u=r*r%o*r%o,d=wt(u,Ks,o)*u%o,g=wt(d,I0,o)*r%o,m=wt(g,S0,o)*g%o,v=wt(m,e,o)*m%o,B=wt(v,t,o)*v%o,S=wt(B,n,o)*B%o,h=wt(S,i,o)*S%o,L=wt(h,i,o)*S%o,U=wt(L,e,o)*m%o;return{pow_p_5_8:wt(U,Ks,o)*r%o,b2:u}}function B0(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function N0(r,e){const t=us,n=Oe(e*e*e,t),i=Oe(n*n*e,t),o=T0(r*i).pow_p_5_8;let f=Oe(r*n*o,t);const u=Oe(e*f*f,t),d=f,g=Oe(f*Vs,t),m=u===r,v=u===Oe(-r,t),B=u===Oe(-r*Vs,t);return m&&(f=d),(v||B)&&(f=g),gf(f,t)&&(f=Oe(-f,t)),{isValid:m||v,value:f}}const O0=jr(us,void 0,!0),U0={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:O0,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:A0,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:m0,randomBytes:la,adjustScalarBytes:B0,uvRatio:N0},fr=v0(U0);var js=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},We=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},je,Nr,Vo,Ko;class R0{constructor(e={}){je.set(this,void 0),Nr.set(this,void 0),this[Vo]=this.entries.bind(this),this[Ko]="ExpirableMap";const{source:t=[],expirationTime:n=10*60*1e3}=e,i=Date.now();js(this,je,new Map([...t].map(([o,f])=>[o,{value:f,timestamp:i}])),"f"),js(this,Nr,n,"f")}prune(){const e=Date.now();for(const[t,n]of We(this,je,"f").entries())e-n.timestamp>We(this,Nr,"f")&&We(this,je,"f").delete(t);return this}set(e,t){this.prune();const n={value:t,timestamp:Date.now()};return We(this,je,"f").set(e,n),this}get(e){const t=We(this,je,"f").get(e);if(t!==void 0){if(Date.now()-t.timestamp>We(this,Nr,"f")){We(this,je,"f").delete(e);return}return t.value}}clear(){We(this,je,"f").clear()}entries(){const e=We(this,je,"f").entries();return function*(){for(const[n,i]of e)yield[n,i.value]}()}values(){const e=We(this,je,"f").values();return function*(){for(const n of e)yield n.value}()}keys(){return We(this,je,"f").keys()}forEach(e,t){for(const[n,i]of We(this,je,"f").entries())e.call(t,i.value,n,this)}has(e){return We(this,je,"f").has(e)}delete(e){return We(this,je,"f").delete(e)}get size(){return We(this,je,"f").size}}je=new WeakMap,Nr=new WeakMap,Vo=Symbol.iterator,Ko=Symbol.toStringTag;const zs=r=>{if(r<=127)return 1;if(r<=255)return 2;if(r<=65535)return 3;if(r<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Ys=(r,e,t)=>{if(t<=127)return r[e]=t,1;if(t<=255)return r[e]=129,r[e+1]=t,2;if(t<=65535)return r[e]=130,r[e+1]=t>>8,r[e+2]=t,3;if(t<=16777215)return r[e]=131,r[e+1]=t>>16,r[e+2]=t>>8,r[e+3]=t,4;throw new Error("Length too long (> 4 bytes)")},Vi=(r,e)=>{if(r[e]<128)return 1;if(r[e]===128)throw new Error("Invalid length 0");if(r[e]===129)return 2;if(r[e]===130)return 3;if(r[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},P0=(r,e)=>{const t=Vi(r,e);if(t===1)return r[e];if(t===2)return r[e+1];if(t===3)return(r[e+1]<<8)+r[e+2];if(t===4)return(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Gn=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function jo(r,e){const t=2+zs(r.byteLength+1),n=e.byteLength+t+r.byteLength;let i=0;const o=new Uint8Array(1+zs(n)+n);return o[i++]=48,i+=Ys(o,i,n),o.set(e,i),i+=e.byteLength,o[i++]=3,i+=Ys(o,i,r.byteLength+1),o[i++]=0,o.set(new Uint8Array(r),i),o}const zo=(r,e)=>{let t=0;const n=(u,d)=>{if(i[t++]!==u)throw new Error("Expected: "+d)},i=new Uint8Array(r);if(n(48,"sequence"),t+=Vi(i,t),!Qn(i.slice(t,t+e.byteLength),e))throw new Error("Not the expected OID.");t+=e.byteLength,n(3,"bit string");const o=P0(i,t)-1;t+=Vi(i,t),n(0,"0 padding");const f=i.slice(t);if(o!==f.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${f.length}`);return f};var Ws=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Zs=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},bn,mn;let Yo=class Or{constructor(e){if(bn.set(this,void 0),mn.set(this,void 0),e.byteLength!==Or.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Ws(this,bn,e,"f"),Ws(this,mn,Or.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new Or(e)}static fromDer(e){return new Or(this.derDecode(e))}static derEncode(e){return jo(e,Gn).buffer}static derDecode(e){const t=zo(e,Gn);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return t}get rawKey(){return Zs(this,bn,"f")}get derKey(){return Zs(this,mn,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};bn=new WeakMap,mn=new WeakMap;Yo.RAW_KEY_LENGTH=32;class L0{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(t=>t!==e)}notify(e,...t){this.observers.forEach(n=>n(e,...t))}}class F0 extends L0{constructor(){super()}print(e,...t){this.notify({message:e,level:"info"},...t)}warn(e,...t){this.notify({message:e,level:"warn"},...t)}error(e,t,...n){this.notify({message:e,level:"error",error:t},...n)}}var gt=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Ke=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},bt,_n,xn,En,vn,In,Sn,An,lr;const Wo=.5,Zo=1.5,Xo=500,Jo=6e4,Qo=9e5,ec=10;class ni{constructor(e=ni.default){bt.set(this,void 0),_n.set(this,void 0),xn.set(this,void 0),En.set(this,void 0),vn.set(this,void 0),In.set(this,void 0),Sn.set(this,void 0),An.set(this,void 0),lr.set(this,0);const{initialInterval:t=Xo,randomizationFactor:n=Wo,multiplier:i=Zo,maxInterval:o=Jo,maxElapsedTime:f=Qo,maxIterations:u=ec,date:d=Date}=e;gt(this,bt,t,"f"),gt(this,_n,n,"f"),gt(this,xn,i,"f"),gt(this,En,o,"f"),gt(this,An,d,"f"),gt(this,vn,d.now(),"f"),gt(this,In,f,"f"),gt(this,Sn,u,"f")}get ellapsedTimeInMsec(){return Ke(this,An,"f").now()-Ke(this,vn,"f")}get currentInterval(){return Ke(this,bt,"f")}get count(){return Ke(this,lr,"f")}get randomValueFromInterval(){const e=Ke(this,_n,"f")*Ke(this,bt,"f"),t=Ke(this,bt,"f")-e,n=Ke(this,bt,"f")+e;return Math.random()*(n-t)+t}incrementCurrentInterval(){var e;return gt(this,bt,Math.min(Ke(this,bt,"f")*Ke(this,xn,"f"),Ke(this,En,"f")),"f"),gt(this,lr,(e=Ke(this,lr,"f"),e++,e),"f"),Ke(this,bt,"f")}next(){return this.ellapsedTimeInMsec>=Ke(this,In,"f")||Ke(this,lr,"f")>=Ke(this,Sn,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}bt=new WeakMap,_n=new WeakMap,xn=new WeakMap,En=new WeakMap,vn=new WeakMap,In=new WeakMap,Sn=new WeakMap,An=new WeakMap,lr=new WeakMap;ni.default={initialInterval:Xo,randomizationFactor:Wo,multiplier:Zo,maxInterval:Jo,maxElapsedTime:Qo,maxIterations:ec,date:Date};var an=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},pe=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Et,ut,Jt,Tn,dr,hr,Qt,tr,tc,Bn,Nn,Xs;(function(r){r.Received="received",r.Processing="processing",r.Replied="replied",r.Rejected="rejected",r.Unknown="unknown",r.Done="done"})(Xs||(Xs={}));const on=5*60*1e3,M0="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",D0="ic0.app",k0=".ic0.app",C0="icp0.io",$0=".icp0.io",q0="icp-api.io",G0=".icp-api.io";class bi extends dt{constructor(e){super(e),this.message=e}}class cn extends dt{constructor(e){super(e),this.message=e}}function H0(){let r;if(typeof window<"u")if(window.fetch)r=window.fetch.bind(window);else throw new bi("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)r=global.fetch.bind(global);else throw new bi("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(r=self.fetch.bind(self));if(r)return r;throw new bi("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}class rc{constructor(e={}){var t;if(Et.add(this),this.rootKey=Bt(M0),this._timeDiffMsecs=0,this._rootKeyFetched=!1,ut.set(this,void 0),Jt.set(this,void 0),this._isAgent=!0,Tn.set(this,0),this.log=new F0,dr.set(this,[]),hr.set(this,[]),Qt.set(this,new R0({expirationTime:5*60*1e3})),tr.set(this,!0),Nn.set(this,(i,o)=>{if(pe(this,tr,"f")===!1)return i;if(!o)throw new _t("Invalid signature from replica signed query: no matching node key found.");const{status:f,signatures:u=[],requestId:d}=i,g=new TextEncoder().encode("\vic-response");for(const m of u){const{timestamp:v,identity:B}=m,S=ve.fromUint8Array(B).toText();let h;if(f==="replied"){const{reply:k}=i;h=Dn({status:f,reply:k,timestamp:BigInt(v),request_id:d})}else if(f==="rejected"){const{reject_code:k,reject_message:J,error_code:P}=i;h=Dn({status:f,reject_code:k,reject_message:J,error_code:P,timestamp:BigInt(v),request_id:d})}else throw new Error(`Unknown status: ${f}`);const L=ht(g,new Uint8Array(h)),U=o?.nodeKeys.get(S);if(!U)throw new _t("Invalid signature from replica signed query: no matching node key found.");const C=Yo.fromDer(U).rawKey;if(fr.verify(m.signature,new Uint8Array(L),new Uint8Array(C)))return i;throw new _t(`Invalid signature from replica ${S} signed query.`)}return i}),e.source){if(!(e.source instanceof rc))throw new Error("An Agent's source can only be another HttpAgent");this._identity=e.source._identity,this._fetch=e.source._fetch,this._host=e.source._host,this._credentials=e.source._credentials}else this._fetch=e.fetch||H0()||fetch.bind(global),this._fetchOptions=e.fetchOptions,this._callOptions=e.callOptions;if(e.host!==void 0)!e.host.match(/^[a-z]+:/)&&typeof window<"u"?this._host=new URL(window.location.protocol+"//"+e.host):this._host=new URL(e.host);else if(e.source!==void 0)this._host=e.source._host;else{const i=typeof window<"u"?window.location:void 0;i||(this._host=new URL("https://icp-api.io"),this.log.warn("Could not infer host from window.location, defaulting to mainnet gateway of https://icp-api.io. Please provide a host to the HttpAgent constructor to avoid this warning."));const o=["ic0.app","icp0.io","127.0.0.1","localhost"],f=[".github.dev",".gitpod.io"],u=i?.hostname;let d;u&&typeof u=="string"&&(f.some(g=>u.endsWith(g))?d=u:d=o.find(g=>u.endsWith(g))),i&&d?this._host=new URL(`${i.protocol}//${d}${i.port?":"+i.port:""}`):(this._host=new URL("https://icp-api.io"),this.log.warn("Could not infer host from window.location, defaulting to mainnet gateway of https://icp-api.io. Please provide a host to the HttpAgent constructor to avoid this warning."))}e.verifyQuerySignatures!==void 0&&an(this,tr,e.verifyQuerySignatures,"f"),an(this,ut,(t=e.retryTimes)!==null&&t!==void 0?t:3,"f");const n=()=>new ni({maxIterations:pe(this,ut,"f")});if(an(this,Jt,e.backoffStrategy||n,"f"),this._host.hostname.endsWith(k0)?this._host.hostname=D0:this._host.hostname.endsWith($0)?this._host.hostname=C0:this._host.hostname.endsWith(G0)&&(this._host.hostname=q0),e.credentials){const{name:i,password:o}=e.credentials;this._credentials=`${i}${o?":"+o:""}`}this._identity=Promise.resolve(e.identity||new Li),this.addTransform("update",Ss(Di)),e.useQueryNonces&&this.addTransform("query",Ss(Di)),e.logToConsole&&this.log.subscribe(i=>{i.level==="error"?console.error(i.message):i.level==="warn"?console.warn(i.message):console.log(i.message)})}get waterMark(){return pe(this,Tn,"f")}isLocal(){const e=this._host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,t,n=t.priority||0){if(e==="update"){const i=pe(this,hr,"f").findIndex(o=>(o.priority||0)<n);pe(this,hr,"f").splice(i>=0?i:pe(this,hr,"f").length,0,Object.assign(t,{priority:n}))}else if(e==="query"){const i=pe(this,dr,"f").findIndex(o=>(o.priority||0)<n);pe(this,dr,"f").splice(i>=0?i:pe(this,dr,"f").length,0,Object.assign(t,{priority:n}))}}async getPrincipal(){if(!this._identity)throw new cn("This identity has expired due this application's security policy. Please refresh your authentication.");return(await this._identity).getPrincipal()}async call(e,t,n){const i=await(n!==void 0?await n:await this._identity);if(!i)throw new cn("This identity has expired due this application's security policy. Please refresh your authentication.");const o=ve.from(e),f=t.effectiveCanisterId?ve.from(t.effectiveCanisterId):o,u=i.getPrincipal()||ve.anonymous();let d=new Jr(on);Math.abs(this._timeDiffMsecs)>1e3*30&&(d=new Jr(on+this._timeDiffMsecs));const g={request_type:Mi.Call,canister_id:o,method_name:t.methodName,arg:t.arg,sender:u,ingress_expiry:d};let m=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},this._credentials?{Authorization:"Basic "+btoa(this._credentials)}:{})},endpoint:"call",body:g});m=await i.transformRequest(m);const v=ui(m.body);this.log.print(`fetching "/api/v2/canister/${f.toText()}/call" with request:`,m);const B=pe(this,Jt,"f").call(this),S=pe(this,Et,"m",Bn).call(this,{request:()=>this._fetch(""+new URL(`/api/v2/canister/${f.toText()}/call`,this._host),Object.assign(Object.assign(Object.assign({},this._callOptions),m.request),{body:v})),backoff:B,tries:0}),[h,L]=await Promise.all([S,kr(g)]),U=await h.arrayBuffer(),C=h.status===200&&U.byteLength>0?At(U):null;return{requestId:L,response:{ok:h.ok,status:h.status,statusText:h.statusText,body:C,headers:dn(h.headers)}}}async query(e,t,n){const i=pe(this,Jt,"f").call(this),o=t.effectiveCanisterId?ve.from(t.effectiveCanisterId):ve.from(e);this.log.print(`ecid ${o.toString()}`),this.log.print(`canisterId ${e.toString()}`);const f=async()=>{const m=await(n!==void 0?await n:await this._identity);if(!m)throw new cn("This identity has expired due this application's security policy. Please refresh your authentication.");const v=ve.from(e),B=m?.getPrincipal()||ve.anonymous(),S={request_type:"query",canister_id:v,method_name:t.methodName,arg:t.arg,sender:B,ingress_expiry:new Jr(on)},h=await kr(S);let L=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},this._credentials?{Authorization:"Basic "+btoa(this._credentials)}:{})},endpoint:"read",body:S});L=await m?.transformRequest(L);const U=ui(L.body),C={canister:v.toText(),ecid:o,transformedRequest:L,body:U,requestId:h,backoff:i,tries:0};return await pe(this,Et,"m",tc).call(this,C)},u=async()=>{if(!pe(this,tr,"f"))return;const m=pe(this,Qt,"f").get(o.toString());return m||(await this.fetchSubnetKeys(o.toString()),pe(this,Qt,"f").get(o.toString()))},[d,g]=await Promise.all([f(),u()]);if(this.log.print("Query response:",d),!pe(this,tr,"f"))return d;try{return pe(this,Nn,"f").call(this,d,g)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),pe(this,Qt,"f").delete(e.toString()),await this.fetchSubnetKeys(o.toString());const v=pe(this,Qt,"f").get(e.toString());if(!v)throw new _t("Invalid signature from replica signed query: no matching node key found.");return pe(this,Nn,"f").call(this,d,v)}}async createReadStateRequest(e,t){const n=await(t!==void 0?await t:await this._identity);if(!n)throw new cn("This identity has expired due this application's security policy. Please refresh your authentication.");const i=n?.getPrincipal()||ve.anonymous(),o=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},this._credentials?{Authorization:"Basic "+btoa(this._credentials)}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:i,ingress_expiry:new Jr(on)}});return n?.transformRequest(o)}async readState(e,t,n,i){const o=typeof e=="string"?ve.fromText(e):e,f=i??await this.createReadStateRequest(t,n),u=ui(f.body);this.log.print(`fetching "/api/v2/canister/${o}/read_state" with request:`,f);const d=pe(this,Jt,"f").call(this),g=await pe(this,Et,"m",Bn).call(this,{request:()=>this._fetch(""+new URL(`/api/v2/canister/${o.toString()}/read_state`,this._host),Object.assign(Object.assign(Object.assign({},this._fetchOptions),f.request),{body:u})),backoff:d,tries:0});if(!g.ok)throw new Error(`Server returned an error:
  Code: ${g.status} (${g.statusText})
  Body: ${await g.text()}
`);const m=At(await g.arrayBuffer());this.log.print("Read state response:",m);const v=await this.parseTimeFromResponse(m);return v>0&&(this.log.print("Read state response time:",v),an(this,Tn,v,"f")),m}async parseTimeFromResponse(e){let t;if(e.certificate){const n=At(e.certificate);if(n&&"tree"in n)t=n.tree;else throw new Error("Could not decode time from response");const i=xr(["time"],t);if(i.status!==Me.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const o=cs(ts(i.value));return this.log.print("Time from response:",o),this.log.print("Time from response in milliseconds:",Number(o)),Number(o)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){const t=await Nc(()=>Promise.resolve().then(()=>Yf),void 0),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const o=(await t.request({canisterId:e??ve.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:this,paths:["time"]})).get("time");o&&(this._timeDiffMsecs=Number(o)-Number(n))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const e=this._credentials?{Authorization:"Basic "+btoa(this._credentials)}:{};this.log.print('fetching "/api/v2/status"');const t=pe(this,Jt,"f").call(this),n=await pe(this,Et,"m",Bn).call(this,{backoff:t,request:()=>this._fetch(""+new URL("/api/v2/status",this._host),Object.assign({headers:e},this._fetchOptions)),tries:0});return At(await n.arrayBuffer())}async fetchRootKey(){return this._rootKeyFetched||(this.rootKey=(await this.status()).root_key,this._rootKeyFetched=!0),this.rootKey}invalidateIdentity(){this._identity=null}replaceIdentity(e){this._identity=Promise.resolve(e)}async fetchSubnetKeys(e){const t=ve.from(e),i=(await $o({canisterId:t,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return pe(this,Qt,"f").set(t.toText(),i),i}_transform(e){let t=Promise.resolve(e);if(e.endpoint==="call")for(const n of pe(this,hr,"f"))t=t.then(i=>n(i).then(o=>o||i));else for(const n of pe(this,dr,"f"))t=t.then(i=>n(i).then(o=>o||i));return t}}ut=new WeakMap,Jt=new WeakMap,Tn=new WeakMap,dr=new WeakMap,hr=new WeakMap,Qt=new WeakMap,tr=new WeakMap,Nn=new WeakMap,Et=new WeakSet,tc=async function r(e){var t,n;const{ecid:i,transformedRequest:o,body:f,requestId:u,backoff:d,tries:g}=e,m=g===0?0:d.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:g,backoff:d,delay:m}),m===null)throw new dt(`Timestamp failed to pass the watermark after retrying the configured ${pe(this,ut,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);m>0&&await new Promise(h=>setTimeout(h,m));let v;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const h=await this._fetch(""+new URL(`/api/v2/canister/${i.toString()}/query`,this._host),Object.assign(Object.assign(Object.assign({},this._fetchOptions),o.request),{body:f}));if(h.status===200){const L=At(await h.arrayBuffer());v=Object.assign(Object.assign({},L),{httpDetails:{ok:h.ok,status:h.status,statusText:h.statusText,headers:dn(h.headers)},requestId:u})}else throw new As(`Gateway returned an error:
  Code: ${h.status} (${h.statusText})
  Body: ${await h.text()}
`,{ok:h.ok,status:h.status,statusText:h.statusText,headers:dn(h.headers)})}catch(h){if(g<pe(this,ut,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${h}
  Retrying query.`),await pe(this,Et,"m",r).call(this,Object.assign(Object.assign({},e),{tries:g+1}));throw h}const B=(n=(t=v.signatures)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.timestamp;if(!pe(this,tr,"f"))return v;if(!B)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const S=Number(BigInt(B)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:S}),Number(this.waterMark)>S){const h=new dt("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",h,{timestamp:B,waterMark:this.waterMark}),g<pe(this,ut,"f"))return await pe(this,Et,"m",r).call(this,Object.assign(Object.assign({},e),{tries:g+1}));throw new dt(`Timestamp failed to pass the watermark after retrying the configured ${pe(this,ut,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return v},Bn=async function r(e){const{request:t,backoff:n,tries:i}=e,o=i===0?0:n.next();if(o===null)throw new dt(`Timestamp failed to pass the watermark after retrying the configured ${pe(this,ut,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);o>0&&await new Promise(g=>setTimeout(g,o));let f;try{f=await t()}catch(g){if(pe(this,ut,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${g}
  Retrying request.`),await pe(this,Et,"m",r).call(this,{request:t,backoff:n,tries:i+1});throw g}if(f.ok)return f;const u=await f.clone().text(),d=`Server returned an error:
  Code: ${f.status} (${f.statusText})
  Body: ${u}
`;if(i<pe(this,ut,"f"))return await pe(this,Et,"m",r).call(this,{request:t,backoff:n,tries:i+1});throw new As(d,{ok:f.ok,status:f.status,statusText:f.statusText,headers:dn(f.headers)})};var Js;(function(r){r.Error="err",r.GetPrincipal="gp",r.GetPrincipalResponse="gpr",r.Query="q",r.QueryResponse="qr",r.Call="c",r.CallResponse="cr",r.ReadState="rs",r.ReadStateResponse="rsr",r.Status="s",r.StatusResponse="sr"})(Js||(Js={}));var Hn=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Ct=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},On,Un,pr,yr;function Qs(r){return r!==null&&typeof r=="object"}class Tt{constructor(e){if(On.set(this,void 0),Un.set(this,void 0),e.byteLength!==Tt.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Hn(this,On,e,"f"),Hn(this,Un,Tt.derEncode(e),"f")}static from(e){if(typeof e=="string"){const t=Bt(e);return this.fromRaw(t)}else if(Qs(e)){const t=e;if(Qs(t)&&Object.hasOwnProperty.call(t,"__derEncodedPublicKey__"))return this.fromDer(t);if(ArrayBuffer.isView(t)){const n=t;return this.fromRaw(ts(n.buffer))}else{if(t instanceof ArrayBuffer)return this.fromRaw(t);if("rawKey"in t)return this.fromRaw(t.rawKey);if("derKey"in t)return this.fromDer(t.derKey);if("toDer"in t)return this.fromDer(t.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new Tt(e)}static fromDer(e){return new Tt(this.derDecode(e))}static derEncode(e){const t=jo(e,Gn).buffer;return t.__derEncodedPublicKey__=void 0,t}static derDecode(e){const t=zo(e,Gn);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return t}get rawKey(){return Ct(this,On,"f")}get derKey(){return Ct(this,Un,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}On=new WeakMap,Un=new WeakMap;Tt.RAW_KEY_LENGTH=32;class Vt extends rs{constructor(e,t){super(),pr.set(this,void 0),yr.set(this,void 0),Hn(this,pr,Tt.from(e),"f"),Hn(this,yr,new Uint8Array(t),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=fr.utils.randomPrivateKey()),Qn(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const t=new Uint8Array(32);for(let i=0;i<32;i++)t[i]=new Uint8Array(e)[i];const n=fr.getPublicKey(t);return Vt.fromKeyPair(n,t)}static fromParsedJson(e){const[t,n]=e;return new Vt(Tt.fromDer(Bt(t)),Bt(n))}static fromJSON(e){const t=JSON.parse(e);if(Array.isArray(t)){if(typeof t[0]=="string"&&typeof t[1]=="string")return this.fromParsedJson([t[0],t[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,t){return new Vt(Tt.fromRaw(e),t)}static fromSecretKey(e){const t=fr.getPublicKey(new Uint8Array(e));return Vt.fromKeyPair(t,e)}toJSON(){return[rt(Ct(this,pr,"f").toDer()),rt(Ct(this,yr,"f"))]}getKeyPair(){return{secretKey:Ct(this,yr,"f"),publicKey:Ct(this,pr,"f")}}getPublicKey(){return Ct(this,pr,"f")}async sign(e){const t=new Uint8Array(e),n=Ur(fr.sign(t,Ct(this,yr,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,t,n){const[i,o,f]=[e,t,n].map(u=>(typeof u=="string"&&(u=Bt(u)),u instanceof Uint8Array&&(u=u.buffer),new Uint8Array(u)));return fr.verify(o,i,f)}}pr=new WeakMap,yr=new WeakMap;class fs extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,fs.prototype)}}function ea(r){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(r)return r;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new fs("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class Vn extends rs{constructor(e,t,n){super(),this._keyPair=e,this._derKey=t,this._subtleCrypto=n}static async generate(e){const{extractable:t=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=e??{},o=ea(i),f=await o.generateKey({name:"ECDSA",namedCurve:"P-256"},t,n),u=await o.exportKey("spki",f.publicKey);return new this(f,u,o)}static async fromKeyPair(e,t){const n=ea(t),i=await n.exportKey("spki",e.publicKey);return new Vn(e,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,t=Object.create(this._keyPair.publicKey);return t.toDer=function(){return e},t}async sign(e){const t={name:"ECDSA",hash:{name:"SHA-256"}};return this._keyPair.privateKey,await this._subtleCrypto.sign(t,this._keyPair.privateKey,e)}}var V0=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},Tr=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Mt;class K0{constructor(e){Mt.set(this,void 0),V0(this,Mt,e,"f")}get rawKey(){return Tr(this,Mt,"f").rawKey}get derKey(){return Tr(this,Mt,"f").derKey}toDer(){return Tr(this,Mt,"f").toDer()}getPublicKey(){return Tr(this,Mt,"f")}getPrincipal(){return ve.from(Tr(this,Mt,"f").rawKey)}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}Mt=new WeakMap;var j0=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},z0=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Y0=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Rn;const W0=new TextEncoder().encode("ic-request-auth-delegation"),Z0=new TextEncoder().encode(`
ic-request`);function mi(r){if(typeof r!="string"||r.length<64)throw new Error("Invalid public key.");return Bt(r)}class ls{constructor(e,t,n){this.pubkey=e,this.expiration=t,this.targets=n}toCBOR(){return et.value.map(Object.assign({pubkey:et.value.bytes(this.pubkey),expiration:et.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:et.value.array(this.targets.map(e=>et.value.bytes(e.toUint8Array())))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:rt(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function X0(r,e,t,n){const i=new ls(e.toDer(),BigInt(+t)*BigInt(1e6),n),o=new Uint8Array([...W0,...new Uint8Array(kr(i))]),f=await r.sign(o);return{delegation:i,signature:f}}class Kn{constructor(e,t){this.delegations=e,this.publicKey=t}static async create(e,t,n=new Date(Date.now()+15*60*1e3),i={}){var o,f;const u=await X0(e,t,n,i.targets);return new Kn([...((o=i.previous)===null||o===void 0?void 0:o.delegations)||[],u],((f=i.previous)===null||f===void 0?void 0:f.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:t,delegations:n}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(o=>{const{delegation:f,signature:u}=o,{pubkey:d,expiration:g,targets:m}=f;if(m!==void 0&&!Array.isArray(m))throw new Error("Invalid targets.");return{delegation:new ls(mi(d),BigInt("0x"+g),m&&m.map(v=>{if(typeof v!="string")throw new Error("Invalid target.");return ve.fromHex(v)})),signature:mi(u)}});return new this(i,mi(t))}static fromDelegations(e,t){return new this(e,t)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:t,signature:n}=e,{targets:i}=t;return{delegation:Object.assign({expiration:t.expiration.toString(16),pubkey:rt(t.pubkey)},i&&{targets:i.map(o=>o.toHex())}),signature:rt(n)}}),publicKey:rt(this.publicKey)}}}class ta extends rs{constructor(e,t){super(),this._inner=e,this._delegation=t}static fromDelegation(e,t){return new this(e,t)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:t}=e,n=Y0(e,["body"]),i=await kr(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_sig:await this.sign(new Uint8Array([...Z0,...new Uint8Array(i)])),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class jn extends K0{constructor(e,t){super(e),Rn.set(this,void 0),j0(this,Rn,t,"f")}get delegation(){return z0(this,Rn,"f")}static fromDelegation(e,t){return new jn(e,t)}}Rn=new WeakMap;function J0(r,e){for(const{delegation:n}of r.delegations)if(+new Date(Number(n.expiration/BigInt(1e6)))<=+Date.now())return!1;const t=[];for(const n of t){const i=n.toText();for(const{delegation:o}of r.delegations){if(o.targets===void 0)continue;let f=!0;for(const u of o.targets)if(u.toText()===i){f=!1;break}if(f)return!1}}return!0}var ra;(function(r){r[r.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(ra||(ra={}));const na=["mousedown","mousemove","keydown","touchstart","wheel"];class ia{constructor(e={}){var t;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const o=this._resetTimer.bind(this);window.addEventListener("load",o,!0),na.forEach(function(u){document.addEventListener(u,o,!0)});const f=(u,d)=>{let g;return(...m)=>{const v=this,B=function(){g=void 0,u.apply(v,m)};clearTimeout(g),g=window.setTimeout(B,d)}};if(e?.captureScroll){const u=f(o,(t=e?.scrollDebounce)!==null&&t!==void 0?t:100);window.addEventListener("scroll",u,!0)}o()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);na.forEach(function(t){document.removeEventListener(t,e,!0)}),this.callbacks.forEach(t=>t())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const Q0=(r,e)=>e.some(t=>r instanceof t);let sa,aa;function el(){return sa||(sa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tl(){return aa||(aa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nc=new WeakMap,Ki=new WeakMap,ic=new WeakMap,_i=new WeakMap,ds=new WeakMap;function rl(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",f)},o=()=>{t(jt(r.result)),i()},f=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",f)});return e.then(t=>{t instanceof IDBCursor&&nc.set(t,r)}).catch(()=>{}),ds.set(e,r),e}function nl(r){if(Ki.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",f),r.removeEventListener("abort",f)},o=()=>{t(),i()},f=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",f),r.addEventListener("abort",f)});Ki.set(r,e)}let ji={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Ki.get(r);if(e==="objectStoreNames")return r.objectStoreNames||ic.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return jt(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function il(r){ji=r(ji)}function sl(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(xi(this),e,...t);return ic.set(n,e.sort?e.sort():[e]),jt(n)}:tl().includes(r)?function(...e){return r.apply(xi(this),e),jt(nc.get(this))}:function(...e){return jt(r.apply(xi(this),e))}}function al(r){return typeof r=="function"?sl(r):(r instanceof IDBTransaction&&nl(r),Q0(r,el())?new Proxy(r,ji):r)}function jt(r){if(r instanceof IDBRequest)return rl(r);if(_i.has(r))return _i.get(r);const e=al(r);return e!==r&&(_i.set(r,e),ds.set(e,r)),e}const xi=r=>ds.get(r);function ol(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const f=indexedDB.open(r,e),u=jt(f);return n&&f.addEventListener("upgradeneeded",d=>{n(jt(f.result),d.oldVersion,d.newVersion,jt(f.transaction),d)}),t&&f.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),i&&d.addEventListener("versionchange",g=>i(g.oldVersion,g.newVersion,g))}).catch(()=>{}),u}const cl=["get","getKey","getAll","getAllKeys","count"],ul=["put","add","delete","clear"],Ei=new Map;function oa(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Ei.get(e))return Ei.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=ul.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||cl.includes(t)))return;const o=async function(f,...u){const d=this.transaction(f,i?"readwrite":"readonly");let g=d.store;return n&&(g=g.index(u.shift())),(await Promise.all([g[t](...u),i&&d.done]))[0]};return Ei.set(e,o),o}il(r=>({...r,get:(e,t,n)=>oa(e,t)||r.get(e,t,n),has:(e,t)=>!!oa(e,t)||r.has(e,t)}));const sc="auth-client-db",ac="ic-keyval",fl=async(r=sc,e=ac,t)=>(oc&&(localStorage!=null&&localStorage.getItem(Ht))&&(localStorage.removeItem(Ht),localStorage.removeItem($t)),await ol(r,t,{upgrade:n=>{n.objectStoreNames,n.objectStoreNames.contains(e)&&n.clear(e),n.createObjectStore(e)}}));async function ll(r,e,t){return await r.get(e,t)}async function dl(r,e,t,n){return await r.put(e,n,t)}async function hl(r,e,t){return await r.delete(e,t)}class hs{constructor(e,t){this._db=e,this._storeName=t}static async create(e){const{dbName:t=sc,storeName:n=ac,version:i=gl}=e??{},o=await fl(t,n,i);return new hs(o,n)}async set(e,t){return await dl(this._db,this._storeName,e,t)}async get(e){var t;return(t=await ll(this._db,this._storeName,e))!==null&&t!==void 0?t:null}async remove(e){return await hl(this._db,this._storeName,e)}}var pl=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},yl=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Pn;const $t="identity",Ht="delegation",wl="iv",gl=1,oc=typeof window<"u";class bl{constructor(e="ic-",t){this.prefix=e,this._localStorage=t}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,t){return this._getLocalStorage().setItem(this.prefix+e,t),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class ml{constructor(e){Pn.set(this,void 0),pl(this,Pn,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}hs.create(yl(this,Pn,"f")).then(t=>{this.initializedDb=t,e(t)})})}async get(e){return await(await this._db).get(e)}async set(e,t){await(await this._db).set(e,t)}async remove(e){await(await this._db).remove(e)}}Pn=new WeakMap;const _l="https://identity.ic0.app",xl="#authorize",vi="ECDSA",Ii="Ed25519",El=500,vl="UserInterrupt";class Ml{constructor(e,t,n,i,o,f,u,d){this._identity=e,this._key=t,this._chain=n,this._storage=i,this.idleManager=o,this._createOptions=f,this._idpWindow=u,this._eventHandler=d,this._registerDefaultIdleCallback()}static async create(e={}){var t,n,i;const o=(t=e.storage)!==null&&t!==void 0?t:new ml,f=(n=e.keyType)!==null&&n!==void 0?n:vi;let u=null;if(e.identity)u=e.identity;else{let v=await o.get($t);if(!v&&oc)try{const B=new bl,S=await B.get(Ht),h=await B.get($t);S&&h&&f===vi&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await o.set(Ht,S),await o.set($t,h),v=S,await B.remove(Ht),await B.remove($t))}catch(B){console.error("error while attempting to recover localstorage: "+B)}if(v)try{typeof v=="object"?f===Ii&&typeof v=="string"?u=await Vt.fromJSON(v):u=await Vn.fromKeyPair(v):typeof v=="string"&&(u=Vt.fromJSON(v))}catch{}}let d=new Li,g=null;if(u)try{const v=await o.get(Ht);if(typeof v=="object"&&v!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?d=e.identity:v&&(g=Kn.fromJSON(v),J0(g)?"toDer"in u?d=jn.fromDelegation(u,g):d=ta.fromDelegation(u,g):(await Si(o),u=null))}catch(v){console.error(v),await Si(o),u=null}let m;return!((i=e.idleOptions)===null||i===void 0)&&i.disableIdle?m=void 0:(g||e.identity)&&(m=ia.create(e.idleOptions)),u||(f===Ii?(u=await Vt.generate(),await o.set($t,JSON.stringify(u.toJSON()))):(e.storage&&f===vi&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${Ii}' as the key type, as it can serialize to a string`),u=await Vn.generate(),await o.set($t,u.getKeyPair()))),new this(d,u,g,o,m,e)}_registerDefaultIdleCallback(){var e,t;const n=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!n?.onIdle&&!n?.disableDefaultIdleCallback&&((t=this.idleManager)===null||t===void 0||t.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,t){var n,i;const o=e.delegations.map(g=>({delegation:new ls(g.delegation.pubkey,g.delegation.expiration,g.delegation.targets),signature:g.signature.buffer})),f=Kn.fromDelegations(o,e.userPublicKey.buffer),u=this._key;if(!u)return;this._chain=f,"toDer"in u?this._identity=jn.fromDelegation(u,this._chain):this._identity=ta.fromDelegation(u,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const d=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!d?.disableIdle&&(this.idleManager=ia.create(d),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Ht,JSON.stringify(this._chain.toJSON())),t?.(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var t,n,i,o;const f=BigInt(8)*BigInt(36e11),u=new URL(((t=e?.identityProvider)===null||t===void 0?void 0:t.toString())||_l);u.hash=xl,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(u,Object.assign({maxTimeToLive:(i=e?.maxTimeToLive)!==null&&i!==void 0?i:f},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(o=window.open(u.toString(),"idpWindow",e?.windowOpenerFeatures))!==null&&o!==void 0?o:void 0;const d=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(vl,e?.onError):setTimeout(d,El))};d()}_getEventHandler(e,t){return async n=>{var i,o,f;if(n.origin!==e.origin){console.warn(`WARNING: expected origin '${e.origin}', got '${n.origin}' (ignoring)`);return}const u=n.data;switch(u.kind){case"authorize-ready":{const d=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:t?.maxTimeToLive,allowPinAuthentication:t?.allowPinAuthentication,derivationOrigin:(o=t?.derivationOrigin)===null||o===void 0?void 0:o.toString()},t?.customValues);(f=this._idpWindow)===null||f===void 0||f.postMessage(d,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(u,t?.onSuccess)}catch(d){this._handleFailure(d.message,t?.onError)}break;case"authorize-client-failure":this._handleFailure(u.text,t?.onError);break}}}_handleFailure(e,t){var n;(n=this._idpWindow)===null||n===void 0||n.close(),t?.(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await Si(this._storage),this._identity=new Li,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function Si(r){await r.remove($t),await r.remove(Ht),await r.remove(wl)}export{Ml as A,Mr as C,rc as H,Ll as I,ve as P,Xs as R,dt as a,ps as b,ru as d,tu as e,$i as l,rt as t};
//# sourceMappingURL=index-Da77hz6-.js.map
