{"version":3,"file":"useAuth-BPIBBZIh.js","sources":["../../src/hooks/useAuth.ts"],"sourcesContent":["import { useCallback, useEffect, useState } from 'react';\nimport { icManager } from '@/ic-init';\n\nexport function useAuth() {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const checkAuth = useCallback(async () => {\n    try {\n      const identity = icManager.getIdentity();\n      const isAnonymous = identity?.getPrincipal().isAnonymous();\n      setIsAuthenticated(!isAnonymous);\n    } catch (err) {\n      console.error('Auth check failed:', err);\n      setError(err instanceof Error ? err.message : 'Authentication check failed');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  const login = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const success = await icManager.login();\n      if (success) {\n        setIsAuthenticated(true);\n        return true;\n      }\n      throw new Error('Login failed');\n    } catch (err) {\n      console.error('Login error:', err);\n      setError(err instanceof Error ? err.message : 'Login failed');\n      return false;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const logout = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      await icManager.logout();\n      setIsAuthenticated(false);\n    } catch (err) {\n      console.error('Logout error:', err);\n      setError(err instanceof Error ? err.message : 'Logout failed');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return {\n    isAuthenticated,\n    isLoading,\n    error,\n    login,\n    logout,\n    checkAuth\n  };\n}\n\nexport default useAuth;"],"names":["useAuth","isAuthenticated","setIsAuthenticated","useState","isLoading","setIsLoading","error","setError","checkAuth","useCallback","isAnonymous","icManager","getIdentity","getPrincipal","err","Error","message","useEffect","login","logout"],"mappings":"gFAGO,SAASA,GAAU,CACxB,KAAM,CAACC,EAAiBC,CAAkB,EAAIC,EAAAA,SAAS,EAAK,EACtD,CAACC,EAAWC,CAAY,EAAIF,EAAAA,SAAS,EAAI,EACzC,CAACG,EAAOC,CAAQ,EAAIJ,EAAAA,SAAwB,IAAI,EAEhDK,EAAYC,EAAAA,YAAY,SAAY,CACpC,GAAA,CAEF,MAAMC,EADWC,EAAUC,YAAY,GACTC,aAAa,EAAEH,YAAY,EACzDR,EAAmB,CAACQ,CAAW,QACxBI,EAAK,CACJR,QAAAA,MAAM,qBAAsBQ,CAAG,EACvCP,EAASO,aAAeC,MAAQD,EAAIE,QAAU,6BAA6B,CAAA,QACnE,CACRX,EAAa,EAAK,CAAA,CAEtB,EAAG,EAAE,EAELY,OAAAA,EAAAA,UAAU,IAAM,CACJT,EAAA,CAAA,EACT,CAACA,CAAS,CAAC,EAmCP,CACLP,gBAAAA,EACAG,UAAAA,EACAE,MAAAA,EACAY,MArCY,SAAY,CACpB,GAAA,CAIF,GAHAb,EAAa,EAAI,EACjBE,EAAS,IAAI,EACG,MAAMI,EAAUO,MAAM,EAEpChB,OAAAA,EAAmB,EAAI,EAChB,GAEH,MAAA,IAAIa,MAAM,cAAc,QACvBD,EAAK,CACJR,eAAAA,MAAM,eAAgBQ,CAAG,EACjCP,EAASO,aAAeC,MAAQD,EAAIE,QAAU,cAAc,EACrD,EAAA,QACC,CACRX,EAAa,EAAK,CAAA,CAEtB,EAqBEc,OAnBa,SAAY,CACrB,GAAA,CACFd,EAAa,EAAI,EACjBE,EAAS,IAAI,EACb,MAAMI,EAAUQ,OAAO,EACvBjB,EAAmB,EAAK,QACjBY,EAAK,CACJR,QAAAA,MAAM,gBAAiBQ,CAAG,EAClCP,EAASO,aAAeC,MAAQD,EAAIE,QAAU,eAAe,CAAA,QACrD,CACRX,EAAa,EAAK,CAAA,CAEtB,EAQEG,UAAAA,CACF,CACF"}