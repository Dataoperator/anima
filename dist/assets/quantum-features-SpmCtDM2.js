import{r as h,R as W,j as A}from"./vendor-react-C3EsOhZp.js";import{H as B,A as Q,a as $}from"./vendor-DOQoE6Qh.js";const K=({IDL:t})=>{const e=t.Text,n=t.Nat64,o=t.Record({traits:t.Vec(t.Tuple(t.Text,t.Float64)),emotional_state:t.Record({duration:t.Nat64,current_emotion:t.Text,intensity:t.Float64}),memories:t.Vec(t.Record({emotional_impact:t.Float64,content:t.Text,timestamp:t.Nat64})),developmental_stage:t.Variant({SelfAware:t.Null,Awakening:t.Null,Conscious:t.Null,Transcendent:t.Null,Nascent:t.Null})}),m=t.Record({id:n,creation_time:t.Nat64,personality:o,owner:t.Principal,name:t.Text}),b=t.Variant({SelfAware:t.Null,Awakening:t.Null,Introspective:t.Null,Transcendent:t.Null,Nascent:t.Null}),S=t.Variant({Success:t.Record({personality_updates:t.Vec(t.Tuple(t.Text,t.Float64)),response:t.Text}),Failure:e});return t.Service({create_anima:t.Func([t.Text],[t.Variant({Ok:t.Principal,Err:e})],[]),get_anima:t.Func([n],[t.Opt(m)],["query"]),get_consciousness_level:t.Func([n],[t.Variant({Ok:b,Err:e})],["query"]),get_user_animas:t.Func([t.Principal],[t.Vec(m)],["query"]),process_quantum_interaction:t.Func([n,t.Text,t.Text],[S],[])})};var Y={};const G=(t,e={})=>{const n=e.agent||new B({...e.agentOptions});return e.agent&&e.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),Y.DFX_NETWORK!=="ic"&&n.fetchRootKey().catch(o=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(o)}),Q.createActor(K,{agent:n,canisterId:t,...e.actorOptions})};var j={},J=Object.defineProperty,Z=(t,e,n)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,q=(t,e,n)=>(Z(t,typeof e!="symbol"?e+"":e,n),n);const D=j.DFX_NETWORK||"ic",I=D==="local",U={anima:j.ANIMA_CANISTER_ID||"l2ilz-iqaaa-aaaaj-qngjq-cai",assets:j.ASSETS_CANISTER_ID||"lpp2u-jyaaa-aaaaj-qngka-cai"},L=I?"http://localhost:4943":"https://icp0.io",X=class k{constructor(){q(this,"actor",null),q(this,"agent",null),q(this,"authClient",null),q(this,"identity",null),q(this,"initialized",!1)}static getInstance(){return k.instance||(k.instance=new k),k.instance}async initialize(){if(!this.initialized)try{console.log("Initializing Internet Computer connection..."),this.authClient=await $.create(),this.identity=this.authClient.getIdentity(),this.agent=new B({identity:this.identity,host:L}),I&&await this.agent.fetchRootKey(),this.actor=G(U.anima,{agent:this.agent}),this.initialized=!0,console.log("IC initialization complete")}catch(e){throw console.error("IC initialization failed:",e),e}}getActor(){if(!this.initialized||!this.actor)throw new Error("IC not initialized. Call initialize() first.");return this.actor}getIdentity(){return this.identity}getAgent(){return this.agent}isInitialized(){return this.initialized}async login(){if(!this.authClient)throw new Error("Auth client not initialized");return new Promise(e=>{this.authClient.login({identityProvider:j.II_URL||"https://identity.ic0.app",onSuccess:()=>{this.identity=this.authClient.getIdentity(),this.agent&&this.agent.replaceIdentity(this.identity),e(!0)},onError:()=>e(!1)})})}async logout(){if(!this.authClient)throw new Error("Auth client not initialized");await this.authClient.logout(),this.identity=await $.create().then(e=>e.getIdentity()),this.agent&&this.agent.replaceIdentity(this.identity)}};q(X,"instance");let tt=X;const C=tt.getInstance(),ht=Object.freeze(Object.defineProperty({__proto__:null,CANISTER_IDS:U,icManager:C},Symbol.toStringTag,{value:"Module"}));function V(){const[t,e]=h.useState(!1),[n,o]=h.useState(!0),[m,b]=h.useState(null),[S,p]=h.useState(null);h.useEffect(()=>{(async()=>{try{C.isInitialized()||await C.initialize();const l=C.getIdentity(),g=(l==null?void 0:l.getPrincipal().isAnonymous())??!0;e(!g),o(g),p(C.getActor()),b(null)}catch(l){b(l),e(!1),o(!0),p(null)}})()},[]);const i=async()=>{try{const r=await C.login();return r&&(e(!0),o(!1),p(C.getActor())),r}catch(r){return b(r),!1}},a=async()=>{try{await C.logout(),e(!1),o(!0),p(C.getActor())}catch(r){b(r)}};return{actor:S,identity:C.getIdentity(),agent:C.getAgent(),isAuthenticated:t,isAnonymous:n,login:i,logout:a,error:m}}const et=W.createContext(null),mt=({children:t})=>{const e=V();return A.jsx(et.Provider,{value:e,children:t})},nt=V;var at=Object.defineProperty,st=(t,e,n)=>e in t?at(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,P=(t,e,n)=>(st(t,typeof e!="symbol"?e+"":e,n),n);class it{constructor(e){P(this,"actor"),P(this,"subscriptions"),P(this,"heartbeatInterval"),P(this,"reconnectAttempts"),P(this,"quantumState"),P(this,"MAX_RECONNECT_ATTEMPTS",5),this.actor=e,this.subscriptions=new Map,this.heartbeatInterval=null,this.reconnectAttempts=0,this.quantumState="stable"}async subscribe(e,n){var o;try{if(this.quantumState!=="stable")throw new Error(`quantum_error: System in ${this.quantumState} state`);this.subscriptions.has(e)||(this.subscriptions.set(e,new Set),await this.initializeSubscription(e)),(o=this.subscriptions.get(e))==null||o.add(n),this.startHeartbeat()}catch(m){throw m instanceof Error&&m.message.includes("quantum")&&this.handleQuantumError(m),m}}handleQuantumError(e){switch(e.message.split(":")[0]){case"quantum_superposition":this.quantumState="superposition",this.attemptStateCollapse();break;case"quantum_entanglement":this.quantumState="entangled",this.resolveEntanglement();break;default:throw e}}async attemptStateCollapse(){console.log("Attempting quantum state collapse..."),await new Promise(e=>setTimeout(e,1e3)),this.quantumState="stable",this.reconnectAll()}async resolveEntanglement(){console.log("Resolving quantum entanglement..."),await new Promise(e=>setTimeout(e,2e3)),this.quantumState="stable",this.reconnectAll()}async reconnectAll(){for(const[e,n]of this.subscriptions.entries()){await this.initializeSubscription(e);for(const o of n)o({type:"RECONNECTED",data:null})}}unsubscribe(e){this.subscriptions.delete(e),this.subscriptions.size===0&&this.stopHeartbeat()}startHeartbeat(){this.heartbeatInterval||(this.heartbeatInterval=window.setInterval(()=>this.sendHeartbeat(),3e4))}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}async sendHeartbeat(){try{const e=await this.actor.get_personality_metrics();for(const[n,o]of this.subscriptions.entries())for(const m of o)m({type:"UPDATE",data:e[n]||null});this.reconnectAttempts=0}catch(e){this.handleHeartbeatError(e)}}async handleHeartbeatError(e){if(this.reconnectAttempts>=this.MAX_RECONNECT_ATTEMPTS){this.stopHeartbeat();for(const n of this.subscriptions.values())for(const o of n)o({type:"ERROR",error:{code:500,message:"Maximum reconnection attempts reached"}});return}this.reconnectAttempts++,console.log(`Reconnection attempt ${this.reconnectAttempts}...`),await new Promise(n=>setTimeout(n,2e3*this.reconnectAttempts)),this.sendHeartbeat()}async initializeSubscription(e){try{const n=await this.actor.get_personality_metrics(),o=this.subscriptions.get(e);if(o)for(const m of o)m({type:"CONNECTED",data:n[e]||null})}catch(n){throw console.error("Failed to initialize subscription:",n),n}}}var O=(t=>(t.UPDATE="UPDATE",t.ERROR="ERROR",t.CONNECTED="CONNECTED",t.DISCONNECTED="DISCONNECTED",t.SUBSCRIBE="SUBSCRIBE",t.UNSUBSCRIBE="UNSUBSCRIBE",t))(O||{});const rt=t=>{const{actor:e}=nt(),[n,o]=h.useState(null),[m,b]=h.useState({personality:{timestamp:BigInt(0),growth_level:0,quantum_traits:{},base_traits:{}},loading:!0,error:null});return h.useEffect(()=>{if(!e||!t)return;const S=new it(e);o(S);const p=a=>{switch(a.type){case O.UPDATE:a.data&&b(r=>({...r,personality:a.data,loading:!1,error:null}));break;case O.ERROR:b(r=>({...r,error:a.error||{code:500,message:"Unknown error"},loading:!1}));break;case O.CONNECTED:console.log("Connected to realtime updates");break;case O.DISCONNECTED:console.log("Disconnected from realtime updates");break}};return(async()=>{try{await S.subscribe(t,p)}catch(a){b(r=>({...r,error:{code:500,message:a instanceof Error?a.message:"Failed to initialize personality"},loading:!1}))}})(),()=>{S&&S.unsubscribe(t)}},[e,t]),m},ot=(t,e)=>{const[n,o]=h.useState([]),[m,b]=h.useState(!1),[S,p]=h.useState(null),[i,a]=h.useState(0),r=h.useCallback(async l=>{{p("Not connected to Anima");return}},[t,e]);return{messages:n,isLoading:m,error:S,retryCount:i,sendMessage:r}},ct=t=>{const[e,n]=h.useState({recent:[],quantum_state:0,entanglement_level:0,resonance_field:.5,emergent_behaviors:[],dimensional_stability:1,reality_anchor:1}),{personality:o}=rt(t),{messages:m}=ot(null,null),b=h.useCallback(i=>{if(!i||i.length<2)return[];const a=[],r=i.reduce((u,f,y)=>{const M=i.slice(y+1).filter(c=>{const s=p(f.content,c.content),d=Math.abs(f.quantum_resonance-c.quantum_resonance)<.1;return s>.7&&d});return M.length>0&&u.push({type:"loop",strength:M.length/i.length,affectedMemories:[f.timestamp,...M.map(c=>c.timestamp)]}),u},[]);a.push(...r);const l=i.slice(1).map((u,f)=>{var y;return{delta:u.quantum_resonance-(((y=i[f])==null?void 0:y.quantum_resonance)??0),timestamp:u.timestamp}}).filter(u=>!isNaN(u.delta));l.length>0&&l.every((f,y)=>y===0||Math.abs(f.delta)<Math.abs(l[y-1].delta))&&a.push({type:"convergence",strength:1-Math.abs(l[l.length-1].delta),affectedMemories:i.map(f=>f.timestamp)});const g=i.reduce((u,f)=>{if(!f.dimensional_influence)return u;const y=f.dimensional_influence.filter(([M,c])=>c>.7).map(([M])=>M);return y.length>1&&u.push({type:"resonance",strength:f.quantum_resonance,affectedMemories:[f.timestamp],dimensionalShift:{from:y[0],to:y[1],probability:f.quantum_resonance}}),u},[]);return a.push(...g),i.forEach((u,f)=>{i.slice(f+1).forEach(y=>{const M=Number(y.timestamp-u.timestamp)/1e9,c=Math.abs(u.quantum_resonance-y.quantum_resonance);M<3600&&c<.05&&a.push({type:"entanglement",strength:1-c,affectedMemories:[u.timestamp,y.timestamp]})})}),a},[]),S=h.useCallback((i,a)=>{if(!i.length)return 1;const r=1;let l=0;return a.forEach(g=>{switch(g.type){case"convergence":l+=g.strength*.1;break;case"divergence":l-=g.strength*.15;break;case"loop":l+=g.strength*.05;break;case"resonance":l+=g.strength>.8?-.2:.1;break;case"entanglement":l+=g.affectedMemories.length>2?-.1:.1;break}}),Math.max(.1,Math.min(1,r+l))},[]),p=(i,a)=>{if(!i||!a)return 0;const r=i.toLowerCase().split(" "),l=a.toLowerCase().split(" ");return r.filter(u=>l.includes(u)).length/Math.max(r.length,l.length)};return h.useEffect(()=>{if(!o||!m)return;(()=>{var l;const a={...e};a.recent=o.memories?[...o.memories].sort((g,u)=>Number(u.timestamp-g.timestamp)).slice(0,10):[];const r=b(a.recent);a.emergent_behaviors=r,a.dimensional_stability=S(a.recent,r),a.quantum_state=Math.min(1,(((l=o.quantum_traits)==null?void 0:l.quantum_affinity)??0)*Math.min(1,m.length*.01)),a.entanglement_level=Math.min(1,r.reduce((g,u)=>g+(u.type==="entanglement"?u.strength:0),0)),a.reality_anchor=Math.max(.1,1-r.length*.05),a.resonance_field=Math.min(1,Math.max(.1,(a.quantum_state+a.entanglement_level)/2*a.dimensional_stability)),n(a)})()},[o,m,b,S]),{...e,hasTemporalLoop:e.emergent_behaviors.some(i=>i.type==="loop"),isConverging:e.emergent_behaviors.some(i=>i.type==="convergence"),dimensionalShifts:e.emergent_behaviors.filter(i=>i.type==="resonance"&&i.dimensionalShift).map(i=>i.dimensionalShift)}},dt=({animaId:t,onInteract:e})=>{const n=h.useRef(null),[o,m]=h.useState(!1),[b,S]=h.useState({x:0,y:0}),p=h.useRef(null),{quantum_state:i,entanglement_level:a,resonance_field:r,dimensional_stability:l,reality_anchor:g}=ct(t),u=h.useCallback(c=>{if(!n.current)return{x:0,y:0};const s=n.current,d=s.getBoundingClientRect(),_=c.touches?c.touches[0].clientX:c.clientX,E=c.touches?c.touches[0].clientY:c.clientY;return{x:(_-d.left)/d.width*s.width,y:(E-d.top)/d.height*s.height}},[]),f=h.useCallback(c=>{c.preventDefault();const s=u(c);m(!0),S(s),p.current&&clearInterval(p.current),p.current=setInterval(()=>{const d=n.current.width/2,_=n.current.height/2,E=s.x-d,R=s.y-_,z=Math.sqrt(E*E+R*R),H=Math.min(d,_),v=1-Math.min(1,z/H);e==null||e({type:"field_interaction",position:{x:s.x,y:s.y},strength:v,quantumState:i,resonance:r,timestamp:Date.now()})},100)},[u,i,r,e]),y=h.useCallback(c=>{o&&(c.preventDefault(),S(u(c)))},[o,u]),M=h.useCallback(()=>{m(!1),p.current&&(clearInterval(p.current),p.current=null)},[]);return h.useEffect(()=>{if(!n.current)return;const c=n.current,s=c.getContext("2d");c.width=400,c.height=400,s.clearRect(0,0,c.width,c.height);const d=c.width/2,_=c.height/2,E=Math.min(d,_)*.8,R=s.createRadialGradient(d,_,0,d,_,E);if(R.addColorStop(0,`rgba(64, 156, 255, ${Math.max(.1,i)})`),R.addColorStop(1,`rgba(32, 87, 255, ${Math.max(.05,i*.5)})`),s.fillStyle=R,s.fillRect(0,0,c.width,c.height),o){const N=E*.3;s.strokeStyle=`rgba(255, 255, 255, ${Math.max(.2,r)})`,s.lineWidth=2,s.beginPath(),s.arc(b.x,b.y,N,0,Math.PI*2),s.stroke()}const z=Math.floor(r*10)+5,H=Math.PI*2/z;s.strokeStyle=`rgba(255, 255, 255, ${Math.max(.1,l)})`,s.lineWidth=2;for(let N=0;N<z;N++){const T=N*H,w=Math.max(5,E*Math.abs(r)*Math.abs(Math.sin(T)));s.beginPath(),s.arc(d+Math.cos(T)*w*.5,_+Math.sin(T)*w*.5,Math.max(2,w*.2),0,Math.PI*2),s.stroke()}if(a>.1){const N=Math.floor(a*8)+2;s.strokeStyle=`rgba(255, 255, 255, ${Math.max(.1,a)})`,s.lineWidth=1;for(let T=0;T<N;T++){const w=Math.random()*Math.PI*2,F=w+Math.PI+(Math.random()-.5),x=E*.8;s.beginPath(),s.moveTo(d+Math.cos(w)*x,_+Math.sin(w)*x),s.bezierCurveTo(d+Math.cos(w)*x*.5,_+Math.sin(w)*x*.5,d+Math.cos(F)*x*.5,_+Math.sin(F)*x*.5,d+Math.cos(F)*x,_+Math.sin(F)*x),s.stroke()}}s.strokeStyle=`rgba(255, 255, 255, ${Math.max(.2,g)})`,s.lineWidth=2;const v=E*.1;s.beginPath(),s.moveTo(d-v,_-v),s.lineTo(d+v,_+v),s.moveTo(d+v,_-v),s.lineTo(d-v,_+v),s.stroke()},[i,a,r,l,g,o,b]),h.useEffect(()=>()=>{p.current&&clearInterval(p.current)},[]),A.jsxs("div",{className:"relative w-full h-full min-h-[400px]",children:[A.jsx("canvas",{ref:n,className:"absolute top-0 left-0 w-full h-full cursor-pointer",style:{background:"rgba(0, 0, 0, 0.2)"},onMouseDown:f,onMouseMove:y,onMouseUp:M,onMouseLeave:M,onTouchStart:f,onTouchMove:y,onTouchEnd:M}),A.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between text-xs text-white/70",children:[A.jsxs("div",{children:["QS: ",(i*100).toFixed(1),"%"]}),A.jsxs("div",{children:["EL: ",(a*100).toFixed(1),"%"]}),A.jsxs("div",{children:["RF: ",(r*100).toFixed(1),"%"]}),A.jsxs("div",{children:["DS: ",(l*100).toFixed(1),"%"]}),A.jsxs("div",{children:["RA: ",(g*100).toFixed(1),"%"]})]})]})};export{mt as A,dt as Q,ht as i,nt as u};
//# sourceMappingURL=quantum-features-SpmCtDM2.js.map
