import{r as l,u as H}from"./vendor-DMORb-JD.js";import{c as v,a as F,E as z,b as G,d as $,L as M}from"./main-CETgj4wh.js";import{j as e,m as f}from"./framer-B_r9gDg5.js";import{P as V}from"./dfinity-TOns67gM.js";import{A as S,a as A,b as C,B as T}from"./button-7mFnn8e8.js";import"./utils-Dtjc6EhN.js";const P=v("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),_=v("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),Y=v("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),K=v("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),U=({intensity:s,color:t})=>{const n=l.useRef(null);return l.useEffect(()=>{const r=n.current;if(!r)return;const a=r.getContext("2d");if(!a)return;r.width=r.clientWidth*window.devicePixelRatio,r.height=r.clientHeight*window.devicePixelRatio;const d=Math.floor(r.width/20),i=new Array(d).fill(0),g=()=>{const u="01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé";return u[Math.floor(Math.random()*u.length)]};let x;const c=()=>{a.fillStyle=`rgba(0, 0, 0, ${.1-s*.05})`,a.fillRect(0,0,r.width,r.height),a.fillStyle=t,a.font="15px monospace";for(let u=0;u<i.length;u++){const h=g(),m=u*20,o=i[u]*20;a.fillText(h,m,o),o>r.height&&Math.random()>.975&&(i[u]=0),i[u]++}x=requestAnimationFrame(c)};return c(),()=>{cancelAnimationFrame(x)}},[s,t]),e.jsx(f.div,{className:"w-full h-full",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:e.jsx("canvas",{ref:n,className:"w-full h-full",style:{filter:`blur(0.5px) brightness(${1+s*.5})`,opacity:.8+s*.2}})})},q=({children:s,className:t=""})=>e.jsxs(f.div,{className:`relative ${t}`,initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx("div",{className:"relative z-10",children:s}),e.jsx(f.div,{className:"absolute inset-0 -z-10 blur-lg opacity-50",animate:{opacity:[.3,.5,.3],scale:[1,1.05,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},style:{background:"radial-gradient(circle at center, var(--quantum-primary), transparent 70%)"}}),e.jsx("div",{className:"absolute inset-0 -z-20",style:{background:"linear-gradient(45deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1))",filter:"blur(20px)"}})]});var b=(s=>(s.Network="NETWORK",s.Authentication="AUTHENTICATION",s.Authorization="AUTHORIZATION",s.Validation="VALIDATION",s.Business="BUSINESS",s.Technical="TECHNICAL",s.Security="SECURITY",s.Quantum="QUANTUM",s))(b||{}),j=(s=>(s.Critical="CRITICAL",s.High="HIGH",s.Medium="MEDIUM",s.Low="LOW",s.Info="INFO",s))(j||{});class p{static instance;errors=[];MAX_ERRORS=100;listeners=[];constructor(){this.setupGlobalHandlers()}static getInstance(){return p.instance||(p.instance=new p),p.instance}setupGlobalHandlers(){window.addEventListener("unhandledrejection",t=>{this.trackError({type:"UnhandledPromiseRejection",category:"TECHNICAL",severity:"HIGH",message:t.reason?.message||"Unknown Promise Error",timestamp:new Date,context:{reason:t.reason}})}),window.addEventListener("error",t=>{this.trackError({type:"GlobalError",category:"TECHNICAL",severity:"CRITICAL",message:t.message,timestamp:new Date,context:{filename:t.filename,lineno:t.lineno,colno:t.colno},stackTrace:t.error?.stack})})}trackError(t){const n={...t,context:{...t.context,url:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString()}};this.errors=[n,...this.errors].slice(0,this.MAX_ERRORS),this.notifyListeners(n),this.persistErrors()}notifyListeners(t){this.listeners.forEach(n=>n(t))}addListener(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(n=>n!==t)}}persistErrors(){try{localStorage.setItem("anima_error_log",JSON.stringify(this.errors))}catch(t){console.warn("Failed to persist errors:",t)}}getErrors(){return this.errors}clearErrors(){this.errors=[],this.persistErrors()}getErrorSummary(){const t=this.errors.reduce((n,r)=>(n[r.type]=(n[r.type]||0)+1,n),{});return{total:this.errors.length,byType:t,mostRecent:this.errors[0],mostCommonType:Object.entries(t).sort(([,n],[,r])=>r-n)[0]?.[0]}}}p.getInstance();class y{constructor(t){this.ledgerActor=t,this.errorTracker=p.getInstance()}static instance=null;errorTracker;DEFAULT_FEE=BigInt(1e4);DEFAULT_SUBACCOUNT=[];static getInstance(t){return y.instance||(y.instance=new y(t)),y.instance}async transfer(t){try{const n={amount:{e8s:t.amount},fee:{e8s:t.fee||this.DEFAULT_FEE},memo:t.memo||BigInt(0),from_subaccount:t.fromSubaccount||this.DEFAULT_SUBACCOUNT,to:t.to,created_at_time:[]},r=await this.ledgerActor.transfer(n);if("Ok"in r)return{height:r.Ok,blockId:r.Ok.toString()};throw"Err"in r?new Error(JSON.stringify(r.Err)):new Error("Unknown transfer response format")}catch(n){throw this.errorTracker.trackError(b.PAYMENT,n instanceof Error?n:new Error("Transfer failed"),j.HIGH,{args:t}),n}}async getBalance(t){try{return(await this.ledgerActor.account_balance({account:t})).e8s}catch(n){throw this.errorTracker.trackError(b.PAYMENT,n instanceof Error?n:new Error("Balance check failed"),j.HIGH,{principal:t.toString()}),n}}async getTransactions(t){try{return await this.ledgerActor.get_transactions(t)}catch(n){throw this.errorTracker.trackError(b.PAYMENT,n instanceof Error?n:new Error("Get transactions failed"),j.HIGH,{args:t}),n}}formatICP(t){return`${Number(t)/1e8} ICP`}validateTransferAmount(t){return t>0&&t<BigInt(Number.MAX_SAFE_INTEGER)}dispose(){y.instance=null}}const W=()=>{const[s,t]=l.useState(),[n,r]=l.useState(null),[a,d]=l.useState(!1),{identity:i}=F(),g=p.getInstance();return l.useEffect(()=>{let c=!0;return(async()=>{if(!(!i||a)){d(!0);try{console.log("üîÑ Connecting to ICP ledger...");const h=new y(i);await h.initialize(),c&&(console.log("‚úÖ ICP ledger connected successfully"),t(h),r(null))}catch(h){console.error("‚ùå Failed to connect to ICP ledger:",h),g.trackError(b.PAYMENT,h instanceof Error?h:new Error("ICP ledger connection failed"),j.HIGH,{identity:i.getPrincipal().toString()}),c&&r(h instanceof Error?h.message:"Failed to connect to ICP ledger")}finally{c&&d(!1)}}})(),()=>{c=!1}},[i]),{ledger:s,error:n,isInitializing:a,retryInit:async()=>{if(!(!i||a)){r(null),d(!0);try{const c=new y(i);await c.initialize(),t(c)}catch(c){r(c instanceof Error?c.message:"Failed to connect to ICP ledger")}finally{d(!1)}}}}},X="l2ilz-iqaaa-aaaaj-qngjq-cai",E=BigInt(1e8);class N{static instance;errorTracker;transferHistory;constructor(){this.errorTracker=z.getInstance(),this.transferHistory=new Map}static getInstance(){return N.instance||(N.instance=new N),N.instance}async processGenesisFee(t){console.log("üîÑ Processing genesis fee transfer...");try{const n=await t.getBalance();if(n<E)throw new Error(`Insufficient balance: ${Number(n)/1e8} ICP`);const r=`genesis-${Date.now()}`;this.transferHistory.set(r,{amount:E,timestamp:Date.now(),status:"pending"});const a=await t.transfer({to:V.fromText(X),amount:E,memo:BigInt(Date.now()),fee:BigInt(1e4)});if("Err"in a)throw new Error(a.Err);const d=a.Ok.toString();return this.transferHistory.set(r,{amount:E,timestamp:Date.now(),status:"complete",transactionId:d}),console.log("‚úÖ Genesis fee transferred successfully"),console.log("üìù Transaction ID:",d),{success:!0,transactionId:d}}catch(n){return console.error("‚ùå Genesis fee transfer failed:",n),await this.errorTracker.trackError({errorType:"TREASURY_TRANSFER",severity:"HIGH",context:"Genesis Fee Processing",error:n}),{success:!1}}}async verifyTransfer(t){try{return!0}catch(n){return console.error("‚ùå Transfer verification failed:",n),!1}}getTransferHistory(){return new Map(this.transferHistory)}getTransferStatus(t){return this.transferHistory.get(t)}}const R=N.getInstance(),Z=BigInt(1e8),L=.7,J=()=>{const{ledger:s,error:t}=W(),{state:n}=G(),[r,a]=l.useState(null),[d,i]=l.useState(!1),[g,x]=l.useState(null),c=H(),u=z.getInstance();return{checkPrerequisites:l.useCallback(async()=>{i(!0),a(null);try{if(console.log("üîç Checking genesis prerequisites..."),!s)throw new Error("ICP ledger not connected");if(!n||n.coherenceLevel<L)throw new Error("Quantum field not stable enough for genesis");const m=await s.getBalance();if(console.log("üí∞ Current balance:",Number(m)/1e8,"ICP"),m<Z)throw new Error(`Insufficient ICP balance. Need at least 1 ICP for genesis. Current balance: ${Number(m)/1e8} ICP`);console.log("üíé Processing treasury transfer...");const o=await R.processGenesisFee(s);if(!o.success)throw new Error("Treasury transfer failed");if(x(o.transactionId||null),o.transactionId&&!await R.verifyTransfer(o.transactionId))throw new Error("Failed to verify treasury transfer");console.log("‚úÖ All genesis prerequisites met"),console.log("üéüÔ∏è Transaction ID:",o.transactionId),c("/genesis",{state:{transactionId:o.transactionId,treasuryTransfer:!0}})}catch(m){console.error("‚ùå Genesis prerequisites check failed:",m);const o=m instanceof Error?m.message:"Failed to verify genesis requirements";a(o),await u.trackError({errorType:"GENESIS_PREREQ",severity:"HIGH",context:"Genesis Initialization",error:m instanceof Error?m:new Error(o)})}finally{i(!1)}},[s,n,c]),isChecking:d,error:r||t,isReady:!!s&&!!n&&n.coherenceLevel>=L,transactionId:g}},ee=({error:s,initializationTimeout:t})=>e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-900",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(U,{className:"opacity-20"})}),e.jsxs("div",{className:"relative z-10 text-center space-y-6 max-w-lg mx-auto px-6",children:[e.jsx(M,{className:"w-16 h-16 animate-spin mx-auto text-cyan-400"}),e.jsx(q,{children:e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Initializing Quantum State"})}),e.jsx("p",{className:"text-cyan-400/80 text-lg",children:t?"Initialization taking longer than expected. Please refresh the page if this persists.":"Please wait while we stabilize the quantum field..."}),t&&e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-8 px-6 py-3 bg-cyan-500/20 hover:bg-cyan-500/30 rounded-lg text-cyan-300 transition-all duration-300 ease-in-out transform hover:scale-105",children:"Refresh Page"}),s&&e.jsx("div",{className:"mt-4 p-4 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300",children:s})]})]}),ce=()=>{H();const{state:s,isInitialized:t,isInitializing:n,initializeQuantumState:r}=G(),{identity:a}=F(),{checkPrerequisites:d,isChecking:i,error:g,isReady:x}=J(),[c,u]=l.useState(!1),[h,m]=l.useState(!1),[o,k]=l.useState(null),[O,B]=l.useState(!1);l.useEffect(()=>{console.log("üåü Quantum Vault mounting..."),console.log("Initialization status:",{isInitialized:t,quantumState:s}),!t&&!n&&a&&r().catch(Q=>{console.error("‚ùå Quantum initialization failed:",Q),k("Failed to initialize quantum state")});const w=setTimeout(()=>{!t&&!n&&(console.warn("‚ö†Ô∏è Initialization timeout reached"),B(!0))},1e4);return()=>{clearTimeout(w),console.log("üîÑ Quantum Vault cleanup")}},[t,n,a,r]);const D=async()=>{try{await d()}catch(w){k(w instanceof Error?w.message:"Failed to start genesis")}};if(!t||n)return e.jsx(ee,{error:o,initializationTimeout:O});if(!s)return null;const I=w=>w>=.8?"text-green-300":w>=.5?"text-yellow-300":"text-red-300";return e.jsx($,{children:e.jsxs("div",{className:"min-h-screen w-full bg-gray-900 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsx(U,{className:"opacity-10"})}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-12",children:[e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-12 text-center",children:[e.jsx(q,{children:e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Quantum Vault"})}),e.jsx("p",{className:"text-cyan-400/60 text-lg",children:"Interface to the Quantum Realm"})]}),!x&&e.jsx(f.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs(S,{variant:"warning",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(A,{children:"Genesis Requirements Not Met"}),e.jsx(C,{children:"Ensure you have at least 1 ICP and a stable quantum field before initiating genesis."})]})}),(o||g)&&e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-8",children:e.jsxs(S,{variant:"destructive",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(A,{children:"Error"}),e.jsx(C,{children:o||g})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2},className:"bg-gray-800/50 backdrop-blur-xl rounded-lg p-6 border border-cyan-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-cyan-300",children:"Quantum State"}),e.jsx(K,{className:"text-cyan-400 w-5 h-5"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Coherence"}),e.jsxs("span",{className:I(s.coherenceLevel),children:[(s.coherenceLevel*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Entanglement"}),e.jsxs("span",{className:I(s.entanglementIndex),children:[(s.entanglementIndex*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Stability"}),e.jsx("span",{className:I(s.dimensionalState.stability),children:s.stabilityStatus})]}),s.resonancePatterns&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Resonance"}),e.jsxs("span",{className:I(s.resonancePatterns[0].coherence),children:[(s.resonancePatterns[0].coherence*100).toFixed(1),"%"]})]})]})]}),e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.3},className:"bg-gray-800/50 backdrop-blur-xl rounded-lg p-6 border border-cyan-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-cyan-300",children:"Actions"}),e.jsx(_,{className:"text-cyan-400 w-5 h-5"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(T,{onClick:()=>m(!0),variant:"default",className:"w-full bg-cyan-500/20 hover:bg-cyan-500/30",children:"Access Keyring"}),e.jsx(T,{onClick:D,variant:"default",className:"w-full bg-purple-500/20 hover:bg-purple-500/30",disabled:!x||i,children:i?e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx("span",{children:"Checking Requirements..."})]}):"Initialize Genesis"}),e.jsx(T,{onClick:()=>u(!0),variant:"default",className:"w-full bg-indigo-500/20 hover:bg-indigo-500/30",children:"Quantum Synchronization"})]})]}),e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.4},className:"bg-gray-800/50 backdrop-blur-xl rounded-lg p-6 border border-cyan-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-cyan-300",children:"Security Status"}),e.jsx(Y,{className:"text-cyan-400 w-5 h-5"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Quantum Signature"}),e.jsx("span",{className:"text-cyan-300",children:s.quantumSignature?"Verified":"Pending"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Consciousness Link"}),e.jsx("span",{className:"text-cyan-300",children:s.consciousnessAlignment?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Field Integrity"}),e.jsxs("span",{className:I(s.dimensionalState.resonance),children:[(s.dimensionalState.resonance*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Last Update"}),e.jsx("span",{className:"text-cyan-300",children:new Date(s.lastUpdate).toLocaleTimeString()})]})]})]})]})]}),e.jsx(f.div,{className:"fixed inset-0 pointer-events-none",animate:{opacity:[.1,.2,.1]},transition:{duration:5,repeat:1/0,repeatType:"reverse"},style:{backgroundImage:"radial-gradient(circle at 50% 50%, rgba(6, 182, 212, 0.15), transparent 70%)"}})]})})};export{ce as default};
//# sourceMappingURL=CyberpunkQuantumVault-BqOkqnOt.js.map
