"use strict";var Ie=Object.create;var X=Object.defineProperty;var Le=Object.getOwnPropertyDescriptor;var De=Object.getOwnPropertyNames;var et=Object.getPrototypeOf,tt=Object.prototype.hasOwnProperty;var rt=(e,t)=>{for(var r in t)X(e,r,{get:t[r],enumerable:!0})},qe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of De(t))!tt.call(e,o)&&o!==r&&X(e,o,{get:()=>t[o],enumerable:!(n=Le(t,o))||n.enumerable});return e};var nt=(e,t,r)=>(r=e!=null?Ie(et(e)):{},qe(t||!e||!e.__esModule?X(r,"default",{value:e,enumerable:!0}):r,e)),ct=e=>qe(X({},"__esModule",{value:!0}),e);var ht={};rt(ht,{AccountIdentifier:()=>v,BadFeeError:()=>G,IndexCanister:()=>te,InsufficientFundsError:()=>U,InvalidAccountIDError:()=>C,InvalidSenderError:()=>I,LedgerCanister:()=>re,SubAccount:()=>$,TransferError:()=>b,TxCreatedInFutureError:()=>q,TxDuplicateError:()=>H,TxTooOldError:()=>S,accountIdentifierFromBytes:()=>mt,accountIdentifierToBytes:()=>ft,checkAccountId:()=>xt,mapIcrc1TransferError:()=>Ve,mapTransferError:()=>Ee,mapTransferProtoError:()=>Pe,principalToAccountIdentifier:()=>_t});module.exports=ct(ht);var N=require("@dfinity/utils");function ot(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Oe(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function He(e,t){ot(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var at=e=>e instanceof Uint8Array;var K=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),y=(e,t)=>e<<32-t|e>>>t,it=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!it)throw new Error("Non little-endian hardware is not supported");function st(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Fe(e){if(typeof e=="string"&&(e=st(e)),!at(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var J=class{clone(){return this._cloneInto()}},gt={}.toString;function Me(e){let t=n=>e().update(Fe(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function ut(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),c=BigInt(4294967295),a=Number(r>>o&c),s=Number(r&c),u=n?4:0,m=n?0:4;e.setUint32(t+u,a,n),e.setUint32(t+m,s,n)}var Z=class extends J{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=K(this.buffer)}update(t){Oe(this);let{view:r,buffer:n,blockLen:o}=this;t=Fe(t);let c=t.length;for(let a=0;a<c;){let s=Math.min(o-this.pos,c-a);if(s===o){let u=K(t);for(;o<=c-a;a+=o)this.process(u,a);continue}n.set(t.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Oe(this),He(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:c}=this,{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>o-a&&(this.process(n,0),a=0);for(let i=a;i<o;i++)r[i]=0;ut(n,o-8,BigInt(this.length*8),c),this.process(n,0);let s=K(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let m=u/4,h=this.get();if(m>h.length)throw new Error("_sha2: outputLen bigger than state");for(let i=0;i<m;i++)s.setUint32(4*i,h[i],c)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:c,destroyed:a,pos:s}=this;return t.length=o,t.pos=s,t.finished=c,t.destroyed=a,o%r&&t.buffer.set(n),t}};var dt=(e,t,r)=>e&t^~e&r,pt=(e,t,r)=>e&t^e&r^t&r,lt=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),w=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),R=new Uint32Array(64),Be=class extends Z{constructor(){super(64,32,8,!1),this.A=w[0]|0,this.B=w[1]|0,this.C=w[2]|0,this.D=w[3]|0,this.E=w[4]|0,this.F=w[5]|0,this.G=w[6]|0,this.H=w[7]|0}get(){let{A:t,B:r,C:n,D:o,E:c,F:a,G:s,H:u}=this;return[t,r,n,o,c,a,s,u]}set(t,r,n,o,c,a,s,u){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=c|0,this.F=a|0,this.G=s|0,this.H=u|0}process(t,r){for(let i=0;i<16;i++,r+=4)R[i]=t.getUint32(r,!1);for(let i=16;i<64;i++){let l=R[i-15],x=R[i-2],p=y(l,7)^y(l,18)^l>>>3,d=y(x,17)^y(x,19)^x>>>10;R[i]=d+R[i-7]+p+R[i-16]|0}let{A:n,B:o,C:c,D:a,E:s,F:u,G:m,H:h}=this;for(let i=0;i<64;i++){let l=y(s,6)^y(s,11)^y(s,25),x=h+l+dt(s,u,m)+lt[i]+R[i]|0,d=(y(n,2)^y(n,13)^y(n,22))+pt(n,o,c)|0;h=m,m=u,u=s,s=a+x|0,a=c,c=o,o=n,n=x+d|0}n=n+this.A|0,o=o+this.B|0,c=c+this.C|0,a=a+this.D|0,s=s+this.E|0,u=u+this.F|0,m=m+this.G|0,h=h+this.H|0,this.set(n,o,c,a,s,u,m,h)}roundClean(){R.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},ve=class extends Be{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};var Y=Me(()=>new ve);var ke=require("@dfinity/agent"),T=()=>import("@dfinity/nns-proto"),$e=async({agent:e,canisterId:t,methodName:r,arg:n})=>{let o=await e.call(t,{methodName:r,arg:n,effectiveCanisterId:t});if(!o.response.ok)throw new Error(["Call failed:",`  Method: ${r}`,`  Canister ID: ${t}`,`  Request ID: ${o.requestId}`,`  HTTP status code: ${o.response.status}`,`  HTTP status text: ${o.response.statusText}`].join(`
`));let c=await ke.polling.pollForResponse(e,t,o.requestId,ke.polling.defaultStrategy());return new Uint8Array(c)},Ge=async({agent:e,canisterId:t,methodName:r,arg:n})=>{let o=await e.query(t,{methodName:r,arg:n});if(o.status=="rejected")throw new Error(["Call failed:",`  Method: ${r}`,`  Canister ID: ${t}`,`  HTTP status code: ${o.reject_code}`,`  HTTP status text: ${o.reject_message}`].join(`
`));return new Uint8Array(o.reply.arg)};var v=class e{constructor(t){this.bytes=t}static fromHex(t){return new e(Uint8Array.from(Buffer.from(t,"hex")))}static fromPrincipal({principal:t,subAccount:r=$.ZERO}){let n=(0,N.asciiStringToByteArray)(`
account-id`),o=Y.create();o.update((0,N.arrayOfNumberToUint8Array)([...n,...t.toUint8Array(),...r.toUint8Array()]));let c=o.digest(),a=(0,N.bigEndianCrc32)(c),s=new Uint8Array([...a,...c]);return new e(s)}async toProto(){let{AccountIdentifier:t}=await T(),r=new t;return r.setHash(this.bytes),r}toHex(){return(0,N.uint8ArrayToHexString)(this.bytes)}toUint8Array(){return this.bytes}toNumbers(){return Array.from(this.bytes)}toAccountIdentifierHash(){return{hash:this.toUint8Array()}}},B=class B{constructor(t){this.bytes=t}static fromBytes(t){return t.length!=32?Error("Subaccount length must be 32-bytes"):new B(t)}static fromPrincipal(t){let r=new Uint8Array(32).fill(0),n=t.toUint8Array();r[0]=n.length;for(let o=0;o<n.length;o++)r[1+o]=n[o];return new B(r)}static fromID(t){if(t<0||t>255)throw"Subaccount ID must be >= 0 and <= 255";let r=new Uint8Array(32).fill(0);return r[31]=t,new B(r)}toUint8Array(){return this.bytes}};B.ZERO=B.fromID(0);var $=B;var ze=require("@dfinity/utils"),b=class extends Error{},I=class extends b{},C=class extends Error{},U=class extends b{constructor(r){super();this.balance=r}},S=class extends b{constructor(r){super();this.allowed_window_secs=r}},q=class extends b{},H=class extends b{constructor(r){super();this.duplicateOf=r}},G=class extends b{constructor(r){super();this.expectedFee=r}},Ee=e=>"TxDuplicate"in e?new H(e.TxDuplicate.duplicate_of):"InsufficientFunds"in e?new U(e.InsufficientFunds.balance.e8s):"TxCreatedInFuture"in e?new q:"TxTooOld"in e?new S(Number(e.TxTooOld.allowed_window_nanos)):"BadFee"in e?new G(e.BadFee.expected_fee.e8s):new b(`Unknown error type ${JSON.stringify(e)}`),Ve=e=>"Duplicate"in e?new H(e.Duplicate.duplicate_of):"InsufficientFunds"in e?new U(e.InsufficientFunds.balance):"CreatedInFuture"in e?new q:"TooOld"in e?new S:"BadFee"in e?new G(e.BadFee.expected_fee):new b(`Unknown error type ${JSON.stringify(e)}`),Pe=e=>{let{message:t}=e;if(t.includes("Reject code: 5")){if(t.match(/Sending from (.*) is not allowed/))return new I;{let r=t.match(/transaction.*duplicate.* in block (\d+)/);if(r&&r.length>1)return new H(BigInt(r[1]))}{let r=t.match(/debit account.*, current balance: (\d*(\.\d*)?)/);if(r&&r.length>1){let n=(0,ze.convertStringToE8s)(r[1]);if(typeof n=="bigint")return new U(n)}}if(t.includes("is in future"))return new q;{let r=t.match(/older than (\d+)/);if(r&&r.length>1)return new S(Number.parseInt(r[1]))}}throw e};var M=require("@dfinity/utils");var L=({IDL:e})=>{let t=e.Vec(e.Nat8),r=e.Record({owner:e.Principal,subaccount:e.Opt(t)}),n=e.Record({icrc2:e.Bool}),o=e.Record({maximum_number_of_accounts:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),feature_flags:e.Opt(n)}),c=e.Record({e8s:e.Nat64}),a=e.Text,s=e.Record({secs:e.Nat64,nanos:e.Nat32}),u=e.Record({num_blocks_to_archive:e.Nat64,trigger_threshold:e.Nat64,max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Principal}),m=e.Record({send_whitelist:e.Vec(e.Principal),token_symbol:e.Opt(e.Text),transfer_fee:e.Opt(c),minting_account:a,maximum_number_of_accounts:e.Opt(e.Nat64),accounts_overflow_trim_quantity:e.Opt(e.Nat64),transaction_window:e.Opt(s),max_message_size_bytes:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),archive_options:e.Opt(u),initial_values:e.Vec(e.Tuple(a,c)),token_name:e.Opt(e.Text),feature_flags:e.Opt(n)}),h=e.Variant({Upgrade:e.Opt(o),Init:m}),i=e.Nat64,l=e.Record({start:i,length:e.Nat64}),x=e.Nat64,p=e.Vec(e.Nat8),d=e.Record({timestamp_nanos:e.Nat64}),_=e.Variant({Approve:e.Record({fee:c,from:p,allowance_e8s:e.Int,allowance:c,expires_at:e.Opt(d),spender:p}),Burn:e.Record({from:p,amount:c,spender:e.Opt(p)}),Mint:e.Record({to:p,amount:c}),Transfer:e.Record({to:p,fee:c,from:p,amount:c}),TransferFrom:e.Record({to:p,fee:c,from:p,amount:c,spender:p})}),ne=e.Record({memo:x,icrc1_memo:e.Opt(e.Vec(e.Nat8)),operation:e.Opt(_),created_at_time:d}),W=e.Record({transaction:ne,timestamp:d,parent_hash:e.Opt(e.Vec(e.Nat8))}),ce=e.Record({blocks:e.Vec(W)}),F=e.Variant({BadFirstBlockIndex:e.Record({requested_index:i,first_valid_index:i}),Other:e.Record({error_message:e.Text,error_code:e.Nat64})}),oe=e.Variant({Ok:ce,Err:F}),ae=e.Func([l],[oe],[]),ie=e.Record({callback:ae,start:i,length:e.Nat64}),g=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(W),chain_length:e.Nat64,first_block_index:i,archived_blocks:e.Vec(ie)}),se=e.Record({callback:e.Func([l],[e.Variant({Ok:e.Vec(e.Vec(e.Nat8)),Err:F})],[]),start:e.Nat64,length:e.Nat64}),ue=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(e.Vec(e.Nat8)),chain_length:e.Nat64,first_block_index:e.Nat64,archived_blocks:e.Vec(se)}),de=e.Record({account:p}),pe=e.Record({account:a}),A=e.Record({canister_id:e.Principal}),V=e.Record({archives:e.Vec(A)}),f=e.Nat,le=e.Variant({Int:e.Int,Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text}),fe=e.Nat64,j=e.Record({to:r,fee:e.Opt(f),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(fe),amount:f}),P=e.Nat,Q=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,BadBurn:e.Record({min_burn_amount:f}),Duplicate:e.Record({duplicate_of:P}),BadFee:e.Record({expected_fee:f}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,InsufficientFunds:e.Record({balance:f})}),me=e.Variant({Ok:P,Err:Q}),_e=e.Record({account:r,spender:r}),xe=e.Record({allowance:f,expires_at:e.Opt(d)}),he=e.Record({fee:e.Opt(f),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(d),amount:f,expected_allowance:e.Opt(f),expires_at:e.Opt(d),spender:r}),ye=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,Duplicate:e.Record({duplicate_of:P}),BadFee:e.Record({expected_fee:f}),AllowanceChanged:e.Record({current_allowance:f}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,Expired:e.Record({ledger_time:e.Nat64}),InsufficientFunds:e.Record({balance:f})}),be=e.Variant({Ok:P,Err:ye}),ge=e.Record({to:a,fee:c,memo:x,from_subaccount:e.Opt(t),created_at_time:e.Opt(d),amount:c}),Ae=e.Record({to:p,fee:c,memo:x,from_subaccount:e.Opt(t),created_at_time:e.Opt(d),amount:c}),we=e.Variant({TxTooOld:e.Record({allowed_window_nanos:e.Nat64}),BadFee:e.Record({expected_fee:c}),TxDuplicate:e.Record({duplicate_of:i}),TxCreatedInFuture:e.Null,InsufficientFunds:e.Record({balance:c})}),Re=e.Variant({Ok:i,Err:we}),Te=e.Record({}),Ne=e.Record({transfer_fee:c});return e.Service({_blocks:e.Func([l],[g],[]),_encoded_blocks:e.Func([l],[ue],[]),account_balance:e.Func([de],[c],[]),account_balance_dfx:e.Func([pe],[c],[]),account_identifier:e.Func([r],[p],[]),archives:e.Func([],[V],[]),decimals:e.Func([],[e.Record({decimals:e.Nat32})],[]),icrc1_balance_of:e.Func([r],[f],[]),icrc1_decimals:e.Func([],[e.Nat8],[]),icrc1_fee:e.Func([],[f],[]),icrc1_metadata:e.Func([],[e.Vec(e.Tuple(e.Text,le))],[]),icrc1_minting_account:e.Func([],[e.Opt(r)],[]),icrc1_name:e.Func([],[e.Text],[]),icrc1_supported_standards:e.Func([],[e.Vec(e.Record({url:e.Text,name:e.Text}))],[]),icrc1_symbol:e.Func([],[e.Text],[]),icrc1_total_supply:e.Func([],[f],[]),icrc1_transfer:e.Func([j],[me],[]),icrc2_allowance:e.Func([_e],[xe],[]),icrc2_approve:e.Func([he],[be],[]),name:e.Func([],[e.Record({name:e.Text})],[]),send_dfx:e.Func([ge],[i],[]),symbol:e.Func([],[e.Record({symbol:e.Text})],[]),transfer:e.Func([Ae],[Re],[]),transfer_fee:e.Func([Te],[Ne],[])})};var D=({IDL:e})=>{let t=e.Vec(e.Nat8),r=e.Record({owner:e.Principal,subaccount:e.Opt(t)}),n=e.Record({icrc2:e.Bool}),o=e.Record({maximum_number_of_accounts:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),feature_flags:e.Opt(n)}),c=e.Record({e8s:e.Nat64}),a=e.Text,s=e.Record({secs:e.Nat64,nanos:e.Nat32}),u=e.Record({num_blocks_to_archive:e.Nat64,trigger_threshold:e.Nat64,max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Principal}),m=e.Record({send_whitelist:e.Vec(e.Principal),token_symbol:e.Opt(e.Text),transfer_fee:e.Opt(c),minting_account:a,maximum_number_of_accounts:e.Opt(e.Nat64),accounts_overflow_trim_quantity:e.Opt(e.Nat64),transaction_window:e.Opt(s),max_message_size_bytes:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),archive_options:e.Opt(u),initial_values:e.Vec(e.Tuple(a,c)),token_name:e.Opt(e.Text),feature_flags:e.Opt(n)}),h=e.Variant({Upgrade:e.Opt(o),Init:m}),i=e.Vec(e.Nat8),l=e.Record({account:i}),x=e.Record({account:a}),p=e.Record({canister_id:e.Principal}),d=e.Record({archives:e.Vec(p)}),_=e.Nat,ne=e.Variant({Int:e.Int,Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text}),W=e.Nat64,ce=e.Record({to:r,fee:e.Opt(_),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(W),amount:_}),F=e.Nat,oe=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,BadBurn:e.Record({min_burn_amount:_}),Duplicate:e.Record({duplicate_of:F}),BadFee:e.Record({expected_fee:_}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,InsufficientFunds:e.Record({balance:_})}),ae=e.Variant({Ok:F,Err:oe}),ie=e.Record({account:r,spender:r}),g=e.Record({timestamp_nanos:e.Nat64}),se=e.Record({allowance:_,expires_at:e.Opt(g)}),ue=e.Record({fee:e.Opt(_),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(g),amount:_,expected_allowance:e.Opt(_),expires_at:e.Opt(g),spender:r}),de=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,Duplicate:e.Record({duplicate_of:F}),BadFee:e.Record({expected_fee:_}),AllowanceChanged:e.Record({current_allowance:_}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,Expired:e.Record({ledger_time:e.Nat64}),InsufficientFunds:e.Record({balance:_})}),pe=e.Variant({Ok:F,Err:de}),A=e.Nat64,V=e.Record({start:A,length:e.Nat64}),f=e.Nat64,le=e.Variant({Approve:e.Record({fee:c,from:i,allowance_e8s:e.Int,allowance:c,expires_at:e.Opt(g),spender:i}),Burn:e.Record({from:i,amount:c,spender:e.Opt(i)}),Mint:e.Record({to:i,amount:c}),Transfer:e.Record({to:i,fee:c,from:i,amount:c}),TransferFrom:e.Record({to:i,fee:c,from:i,amount:c,spender:i})}),fe=e.Record({memo:f,icrc1_memo:e.Opt(e.Vec(e.Nat8)),operation:e.Opt(le),created_at_time:g}),j=e.Record({transaction:fe,timestamp:g,parent_hash:e.Opt(e.Vec(e.Nat8))}),P=e.Record({blocks:e.Vec(j)}),Q=e.Variant({BadFirstBlockIndex:e.Record({requested_index:A,first_valid_index:A}),Other:e.Record({error_message:e.Text,error_code:e.Nat64})}),me=e.Variant({Ok:P,Err:Q}),_e=e.Func([V],[me],["query"]),xe=e.Record({callback:_e,start:A,length:e.Nat64}),he=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(j),chain_length:e.Nat64,first_block_index:A,archived_blocks:e.Vec(xe)}),ye=e.Record({callback:e.Func([V],[e.Variant({Ok:e.Vec(e.Vec(e.Nat8)),Err:Q})],["query"]),start:e.Nat64,length:e.Nat64}),be=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(e.Vec(e.Nat8)),chain_length:e.Nat64,first_block_index:e.Nat64,archived_blocks:e.Vec(ye)}),ge=e.Record({to:a,fee:c,memo:f,from_subaccount:e.Opt(t),created_at_time:e.Opt(g),amount:c}),Ae=e.Record({to:i,fee:c,memo:f,from_subaccount:e.Opt(t),created_at_time:e.Opt(g),amount:c}),we=e.Variant({TxTooOld:e.Record({allowed_window_nanos:e.Nat64}),BadFee:e.Record({expected_fee:c}),TxDuplicate:e.Record({duplicate_of:A}),TxCreatedInFuture:e.Null,InsufficientFunds:e.Record({balance:c})}),Re=e.Variant({Ok:A,Err:we}),Te=e.Record({}),Ne=e.Record({transfer_fee:c});return e.Service({account_balance:e.Func([l],[c],["query"]),account_balance_dfx:e.Func([x],[c],["query"]),account_identifier:e.Func([r],[i],["query"]),archives:e.Func([],[d],["query"]),decimals:e.Func([],[e.Record({decimals:e.Nat32})],["query"]),icrc1_balance_of:e.Func([r],[_],["query"]),icrc1_decimals:e.Func([],[e.Nat8],["query"]),icrc1_fee:e.Func([],[_],["query"]),icrc1_metadata:e.Func([],[e.Vec(e.Tuple(e.Text,ne))],["query"]),icrc1_minting_account:e.Func([],[e.Opt(r)],["query"]),icrc1_name:e.Func([],[e.Text],["query"]),icrc1_supported_standards:e.Func([],[e.Vec(e.Record({url:e.Text,name:e.Text}))],["query"]),icrc1_symbol:e.Func([],[e.Text],["query"]),icrc1_total_supply:e.Func([],[_],["query"]),icrc1_transfer:e.Func([ce],[ae],[]),icrc2_allowance:e.Func([ie],[se],["query"]),icrc2_approve:e.Func([ue],[pe],[]),name:e.Func([],[e.Record({name:e.Text})],["query"]),query_blocks:e.Func([V],[he],["query"]),query_encoded_blocks:e.Func([V],[be],["query"]),send_dfx:e.Func([ge],[A],[]),symbol:e.Func([],[e.Record({symbol:e.Text})],["query"]),transfer:e.Func([Ae],[Re],[]),transfer_fee:e.Func([Te],[Ne],["query"])})};var Ce=require("@dfinity/principal"),We=Ce.Principal.fromText("ryjl3-tyaaa-aaaaa-aaaba-cai"),je=Ce.Principal.fromText("qhbym-qaaaa-aaaaa-aaafq-cai");var ee=class extends Error{};var z=e=>e instanceof v?e:v.fromHex(e);var te=class e extends M.Canister{constructor(){super(...arguments);this.accountBalance=({certified:r,accountIdentifier:n})=>this.caller({certified:r}).get_account_identifier_balance(z(n).toHex());this.getTransactions=async({certified:r,accountIdentifier:n,start:o,maxResults:c})=>{let a=await this.caller({certified:r}).get_account_identifier_transactions({account_identifier:z(n).toHex(),start:(0,M.toNullable)(o),max_results:c});if("Err"in a)throw new ee(a.Err.message);return a.Ok}}static create({canisterId:r,...n}){let{service:o,certifiedService:c,canisterId:a}=(0,M.createServices)({options:{...n,canisterId:r??je},idlFactory:D,certifiedIdlFactory:L});return new e(a,o,c)}};var Ze=require("@dfinity/utils");var E=require("@dfinity/utils");var Qt=BigInt(1095062083),Xt=BigInt(1347768404),k=BigInt(1e4),Jt=BigInt(1e8);var Xe=async e=>{let t=new Uint8Array(e).buffer,{Subaccount:r}=await T(),n=new r;return n.setSubAccount(new Uint8Array(t)),n},Ue=async e=>{let{ICPTs:t}=await T(),r=new t;return r.setE8s(e.toString(10)),r},Qe=e=>({e8s:e}),Je=({to:e,amount:t,memo:r,fee:n,fromSubAccount:o,createdAt:c})=>({to:e.toUint8Array(),fee:Qe(n??k),amount:Qe(t),memo:r??BigInt(0),created_at_time:c!==void 0?[{timestamp_nanos:c}]:[],from_subaccount:o===void 0?[]:[(0,E.arrayOfNumberToUint8Array)(o)]}),Ke=({fromSubAccount:e,to:t,amount:r,fee:n,icrc1Memo:o,createdAt:c})=>({to:t,fee:(0,E.toNullable)(n??k),amount:r,memo:(0,E.toNullable)(o),created_at_time:(0,E.toNullable)(c),from_subaccount:(0,E.toNullable)(e)});var re=class e{constructor(t,r,n,o,c,a,s=!1){this.agent=t;this.canisterId=r;this.service=n;this.certifiedService=o;this.updateFetcher=c;this.queryFetcher=a;this.hardwareWallet=s;this.accountBalance=async({accountIdentifier:t,certified:r=!0})=>{let n=z(t);return this.hardwareWallet?this.accountBalanceHardwareWallet({accountIdentifier:n,certified:r}):(await(r?this.certifiedService:this.service).account_balance({account:n.toUint8Array()})).e8s};this.transactionFee=async()=>{let{transfer_fee:{e8s:t}}=await this.service.transfer_fee({});return t};this.transfer=async t=>{if(this.hardwareWallet)return this.transferHardwareWallet(t);t.fee===void 0&&(t.fee=this.hardwareWallet?k:await this.transactionFee());let r=Je(t),n=await this.certifiedService.transfer(r);if("Err"in n)throw Ee(n.Err);return n.Ok};this.icrc1Transfer=async t=>{t.fee===void 0&&(t.fee=this.hardwareWallet?k:await this.transactionFee());let r=Ke(t),n=await this.certifiedService.icrc1_transfer(r);if("Err"in n)throw Ve(n.Err);return n.Ok};this.accountBalanceHardwareWallet=async({accountIdentifier:t,certified:r=!0})=>{let n=r?this.updateFetcher:this.queryFetcher,{AccountBalanceRequest:o,ICPTs:c}=await T(),a=new o;a.setAccount(await t.toProto());let s=await n({agent:this.agent,canisterId:this.canisterId,methodName:"account_balance_pb",arg:a.serializeBinary()});return BigInt(c.deserializeBinary(new Uint8Array(s)).getE8s())};this.transferHardwareWallet=async({to:t,amount:r,memo:n,fee:o,fromSubAccount:c,createdAt:a})=>{let{SendRequest:s,Payment:u,Memo:m,TimeStamp:h,BlockHeight:i}=await T(),l=new s;l.setTo(await t.toProto());let x=new u;x.setReceiverGets(await Ue(r)),l.setPayment(x),l.setMaxFee(await Ue(o??k));let p=new m;if(p.setMemo((n??BigInt(0)).toString()),l.setMemo(p),a!==void 0){let d=new h;d.setTimestampNanos(a.toString()),l.setCreatedAtTime(d)}c!==void 0&&l.setFromSubaccount(await Xe(c));try{let d=await this.updateFetcher({agent:this.agent,canisterId:this.canisterId,methodName:"send_pb",arg:l.serializeBinary()});return BigInt(i.deserializeBinary(d).getHeight())}catch(d){throw d instanceof Error?Pe(d):d}}}static create(t={}){let r=t.canisterId??We,{service:n,certifiedService:o,agent:c}=(0,Ze.createServices)({options:{...t,canisterId:r},idlFactory:D,certifiedIdlFactory:L});return new e(c,r,n,o,t.updateCallOverride??$e,t.queryCallOverride??Ge,t.hardwareWallet)}};var O=require("@dfinity/utils");var Se=require("buffer"),ft=e=>Uint8Array.from(Se.Buffer.from(e,"hex")).subarray(4),mt=e=>Se.Buffer.from(e).toString("hex"),_t=(e,t)=>{let r=(0,O.asciiStringToByteArray)(`
account-id`),n=Y.create();n.update((0,O.arrayOfNumberToUint8Array)([...r,...e.toUint8Array(),...t??Array(32).fill(0)]));let o=n.digest(),c=(0,O.bigEndianCrc32)(o),a=new Uint8Array([...c,...o]);return(0,O.uint8ArrayToHexString)(a)};var Ye=require("@dfinity/utils");var xt=e=>{if(e.length!=64)throw new C(`Invalid account identifier ${e}. The account identifier must be 64 chars in length.`);let t=Buffer.from(e,"hex"),r=t.slice(0,4),n=Buffer.from((0,Ye.bigEndianCrc32)(t.slice(4)));if(!n.equals(r))throw new C(`Account identifier ${e} has an invalid checksum. Are you sure the account identifier is correct?

Expected checksum: ${n.toString("hex")}
Found checksum: ${r.toString("hex")}`)};0&&(module.exports={AccountIdentifier,BadFeeError,IndexCanister,InsufficientFundsError,InvalidAccountIDError,InvalidSenderError,LedgerCanister,SubAccount,TransferError,TxCreatedInFutureError,TxDuplicateError,TxTooOldError,accountIdentifierFromBytes,accountIdentifierToBytes,checkAccountId,mapIcrc1TransferError,mapTransferError,mapTransferProtoError,principalToAccountIdentifier});
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=index.cjs.js.map
